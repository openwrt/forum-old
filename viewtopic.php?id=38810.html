<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WA901ND how to configure it as &#039;Repeater&#039; mode using Luci?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 7 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p175446">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						21 Aug 2012, 17:34					</div>
				</div>
				<div class="post-content content">
					<p>I managed to flash openwrt and set it up as access point following dumbap guide and tips in topic <a href="https://forum.openwrt.org/viewtopic.php?id=36021">https://forum.openwrt.org/viewtopic.php?id=36021</a></p><p>Now I can access Luci web UI.</p><p>It is being setup with default SSID &#039;OpenWrt&#039; which my devices are able to connect to it to surf the internet. However I&#039;m a little lost on what to do next to set it up as a wireless repeater instead (so that I don&#039;t need to plug the LAN cable to it)</p><p>I&#039;m looking at Luci&#039;s Network -&gt; Interface overview and my LAN settings are here<br />under Luci&#039;s Network -&gt; Wifi overview the OpenWrt SSID with mode: master can be seen</p><p>How do I make it so it can connect to my wifi router wirelessly and still allow other devices to connect to it using SSID &#039;OpenWrt&#039; and surf the internet?</p><p>Thanks in advance!</p>											<p class="post-edited">(Last edited by <strong>iori57</strong> on 21 Aug 2012, 17:35)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175535">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						22 Aug 2012, 20:26					</div>
				</div>
				<div class="post-content content">
					<p>Under Network -&gt; Wifi<br />I click Scan (&#039;Find and join network&#039;) and click &#039;Join network&#039; to add my existing wifi connection and created a new interface called &#039;wwan&#039;</p><p>After that under Network -&gt; Wifi again<br />I click Add (&#039;Provide new network&#039;) and under Interface Configuration there I choose the network the same as the above, which is &#039;wwan&#039;</p><p>But this doesn&#039;t seem to work.. it&#039;s so hard to make sense of all these.</p><p>Help!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175539">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">johan666</div>
					<div class="post-datetime">
						22 Aug 2012, 20:43					</div>
				</div>
				<div class="post-content content">
					<p>Did you ever try to read openwrt wiki ?<br /><a href="http://wiki.openwrt.org/doc/recipes/bridgedap">http://wiki.openwrt.org/doc/recipes/bridgedap</a><br /><a href="http://wiki.openwrt.org/doc/recipes/routedap">http://wiki.openwrt.org/doc/recipes/routedap</a><br /><a href="http://wiki.openwrt.org/doc/howto/clientmode">http://wiki.openwrt.org/doc/howto/clientmode</a><br /><a href="http://wiki.openwrt.org/doc/recipes/routedclient">http://wiki.openwrt.org/doc/recipes/routedclient</a><br /><a href="http://wiki.openwrt.org/doc/recipes/atheroswds">http://wiki.openwrt.org/doc/recipes/atheroswds</a></p><p>If you just follow the dummy guide without understanding, you will face another problems.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175556">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">inte</div>
					<div class="post-datetime">
						23 Aug 2012, 00:43					</div>
				</div>
				<div class="post-content content">
					<p>I also tried that following 5+ pages of the OpenWRT Wiki but never succeeded - it is somehow confusing and misleading.<br />However, I was lucky enough to find this straight forward guide: <a href="http://vogelzucht-ostenland.de/?page_id=41">http://vogelzucht-ostenland.de/?page_id=41</a><br />It&#039;s in German, but you can probably understand it with Google translate and it contains the full configuration-files.<br />You have to use the br-2.4 release (which is gone in the current trunk).<br />I have no clue if repeater mode is also possible with the current open drivers nor did I find any documentation on that, but since br24 works for me I&#039;m fine.<br />HTH<br />Chris</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175558">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						23 Aug 2012, 02:25					</div>
				</div>
				<div class="post-content content">
					<p>Thanks johan, I did read through some of them, but they are too technical for non network average day user like me.. after reading all of them I&#039;m still not sure which is the one suitable for my case.</p><p>Thanks inte, I&#039;ll have a look at your link <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175570">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						23 Aug 2012, 05:09					</div>
				</div>
				<div class="post-content content">
					<p>I followed the guide here <a href="https://forum.openwrt.org/viewtopic.php?pid=151609#p151609">https://forum.openwrt.org/viewtopic.php … 09#p151609</a><br />Restarted my WA901ND and it seems bricked now.<br />The wifi led is now off, I tried connecting the LAN cable to it, but I couldn&#039;t telnet/ssh to 192.168.3.1 nor 192.168.0.1<br />Anyway to save this? O_O</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175644">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						23 Aug 2012, 18:39					</div>
				</div>
				<div class="post-content content">
					<p>managed to reset using openwrt failsafe method..</p><p>After that, I follow the same guide again, this time carefully change some of the settings to match with my current network settings: (192.168.2.1 is my internet router&#039;s IP address, and I access my WA901ND via 192.168.2.254 (luci too))</p><p>network<br /></p><div class="quotebox"><blockquote><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0 eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.2.254&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.2.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dns &#039;8.8.8.8&#039;</p><p>config interface &#039;wwan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config interface &#039;stabridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;relay&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;lan wwan&#039;</p></blockquote></div><p>wireless<br /></p><div class="quotebox"><blockquote><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;OpenWrt<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; secretkey</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; wwan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;sta<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;MyRouterSSID<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; secretkey</p></blockquote></div><p>dhcp<br /></p><div class="quotebox"><blockquote><p>config dhcp &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option start &#039;100&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option limit &#039;150&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option leasetime &#039;12h&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p><p>config dhcp &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p></blockquote></div><p>firewall off</p><p>I think I&#039;m getting close... I unplugged the network cable, after that my PC is able to connect to OpenWrt and telnet to the device (however cannot access Luci which I don&#039;t know why), I&#039;m able to surf the internet for a while (my ip address is 192.168.2.102), until the connection got lost again after 1 minute or so (the ip address changes to some weird number 169.254.35.131) and can&#039;t surf the net anymore, then I have to reconnect to make it work.</p><p>Need a final push from someone!! Thanks in advance!</p>											<p class="post-edited">(Last edited by <strong>iori57</strong> on 23 Aug 2012, 19:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p175726">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						24 Aug 2012, 20:31					</div>
				</div>
				<div class="post-content content">
					<p>Help please..</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176070">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						28 Aug 2012, 12:36					</div>
				</div>
				<div class="post-content content">
					<p>Check my configs: (they are not the full configs, just the parts you must add or modify)</p><br /><p>network:<br /></p><div class="codebox"><pre><code>config interface &#039;lan&#039;
    option ifname &#039;eth0&#039;
    option type &#039;bridge&#039;
    option proto &#039;static&#039;
    option netmask &#039;255.255.255.0&#039;
    option ipaddr &#039;192.168.11.1&#039;    # to access from LAN if you lose dhcp from main router, force your ip to 192.168.11.x

config interface &#039;wan&#039;
    option ifname &#039;eth1&#039;
    option proto &#039;none&#039;

config interface &#039;stabridge&#039;
    option proto &#039;relay&#039;
    option network &#039;lan wlanAP wlanSTA&#039;                            
    option ipaddr &#039;192.168.2.254&#039;    # MATCH THIS IP WITH wlanSTA !!

config interface &#039;wlanSTA&#039;
    option proto &#039;static&#039;
                                    # by default is for a main router using 192.168.2.1. for your main router
                                    # It is set to 254 to be the last one and make all the IP range available for clients.
    option ipaddr &#039;192.168.2.254&#039;    # change to 192.168.0.254 , 192.168.1.254 ,  etc
    option netmask &#039;255.255.255.0&#039;    # to match the your main router&#039;s subnet
                            
    option gateway &#039;192.168.2.1&#039;    # set your main router&#039;s IP both in gateway and dns
    option dns  &#039;192.168.2.1&#039;
    
config interface &#039;wlanAP&#039;
    option proto &#039;static&#039;
    option ipaddr &#039;192.168.10.1&#039;    # to access from WLAN if you lose dhcp from main router, force your ip to 192.168.10.x
    option netmask &#039;255.255.255.0&#039;</code></pre></div><p>wireless<br /></p><div class="codebox"><pre><code>config &#039;wifi-device&#039; &#039;radio0&#039;
    option &#039;type&#039; &#039;mac80211&#039;
    option &#039;macaddr&#039; &#039;40:50:xx:xx:xx:xx&#039;
    option &#039;hwmode&#039; &#039;11ng&#039;
    list &#039;ht_capab&#039; &#039;SHORT-GI-20&#039;
    list &#039;ht_capab&#039; &#039;SHORT-GI-40&#039;
    list &#039;ht_capab&#039; &#039;RX-STBC1&#039;
    list &#039;ht_capab&#039; &#039;DSSS_CCK-40&#039;
    option &#039;txpower&#039; &#039;30&#039;
    option &#039;disabled&#039; &#039;0&#039;
    option &#039;channel&#039; &#039;1&#039;                           #&lt;--ONLY CHANGE THIS OPTION ON YOUR WIFI-DEVICE! SET THE WIFI CHANNEL WHERE YOUR MAIN ROUTER IS ON.
    option &#039;country&#039; &#039;US&#039;
    option &#039;htmode&#039; &#039;HT20&#039;

config &#039;wifi-iface&#039;
    option &#039;device&#039; &#039;radio0&#039;            # PUT THE SAME DEVICE NAME THAT IS SET BY DEFAULT ON YOUR OPENWRT !!
    option &#039;mode&#039; &#039;sta&#039;                # CLIENT MODE
    option &#039;network&#039; &#039;wlanSTA&#039;            #
    option &#039;ssid&#039; &#039;MainRouterSSID&#039;        # SET THE WIRELESS NAME OF YOUR MAIN WIRELESS NETWORK

    option &#039;encryption&#039; &#039;psk2&#039;            # UNCOMMENT THE SECURITY YOU WANT TO USE. 
    #option &#039;encryption&#039; &#039;psk&#039;            # ONLY ON CAN BE UNCOMMENTED!! (UNCOMMENT = REMOVE #)
    #option &#039;encryption&#039; &#039;wep&#039;
    option &#039;key&#039; &#039;MainRouterPassword&#039;    # SET THE WIRELESS PASSWORD

config &#039;wifi-iface&#039;
    option &#039;device&#039; &#039;radio0&#039;            # PUT THE SAME DEVICE NAME THAT IS SET BY DEFAULT ON YOUR OPENWRT !!
    option &#039;mode&#039; &#039;sta&#039;                # ACCESS POINT MODE
    option &#039;network&#039; &#039;wlanAP&#039;            #
    option &#039;ssid&#039; &#039;MyRepeater&#039;            # SET THE WIRELESS NAME YOU WANT

    option &#039;encryption&#039; &#039;psk2&#039;            # UNCOMMENT THE SECURITY YOU WANT TO USE. 
    #option &#039;encryption&#039; &#039;psk&#039;            # ONLY ON CAN BE UNCOMMENTED!! (UNCOMMENT = REMOVE #)
    #option &#039;encryption&#039; &#039;wep&#039;
    option &#039;key&#039; &#039;MyRepeaterPassword&#039;    # SET THE WIRELESS PASSWORD YOU WANT, CAN BE DIFFERENT FROM THE wlanSTA KEY</code></pre></div><p>firewall<br /></p><div class="codebox"><pre><code>config defaults
    option syn_flood &#039;1&#039;
    option input &#039;ACCEPT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;ACCEPT&#039;
    option drop_invalid &#039;1&#039;

config zone
    option name &#039;lan&#039;
    option input &#039;ACCEPT&#039;
    option output &#039;ACCEPT&#039;
    option forward &#039;ACCEPT&#039;
    option network &#039;lan wlanAP wlanSTA&#039;

config zone
    option name &#039;wan&#039;
    option input &#039;REJECT&#039;
    option output &#039;ACCEPT&#039;
    option masq &#039;1&#039;
    option mtu_fix &#039;1&#039;
    option forward &#039;REJECT&#039;
    option network &#039;wan&#039;

config forwarding
    option src &#039;lan&#039;
    option dest &#039;wan&#039;

config rule
    option &#039;src&#039; &#039;wan&#039;
    option &#039;proto&#039; &#039;udp&#039;
    option &#039;dest_port&#039; &#039;68&#039;
    option &#039;target&#039; &#039;ACCEPT&#039;
    option &#039;family&#039; &#039;ipv4&#039;
                    
config include
    option path &#039;/etc/firewall.user&#039;</code></pre></div><p>dhcp<br /></p><div class="codebox"><pre><code>config dnsmasq
    option domainneeded &#039;1&#039;
    option boguspriv &#039;1&#039;
    option filterwin2k &#039;0&#039;
    option localise_queries &#039;1&#039;
    option rebind_protection &#039;1&#039;
    option rebind_localhost &#039;1&#039;
    option local &#039;/lan/&#039;
    option domain &#039;lan&#039;
    option expandhosts &#039;1&#039;
    option nonegcache &#039;0&#039;
    option authoritative &#039;1&#039;
    option readethers &#039;1&#039;
    option leasefile &#039;/tmp/dhcp.leases&#039;
    option resolvfile &#039;/tmp/resolv.conf.auto&#039;

config dhcp &#039;lan&#039;
    option interface &#039;lan&#039;
    option ignore &#039;1&#039;

config dhcp &#039;wan&#039;
    option interface &#039;wan&#039;
    option ignore &#039;1&#039;

config dhcp &#039;wlanAP&#039;
    option interface &#039;wlanAP&#039;
    option ignore &#039;1&#039;</code></pre></div><p>By putting this configs on the router and rebooting, the only thing you will need to install is &quot;relayd&quot;. All Luci etc is optional.</p><p>The easiest is to start over again.<br />Always connect with Ethernet until its finished.<br />Erase the router config by doing &quot;mtd -r erase rootfs_data&quot;. It will erase all settings and reboot.<br />Set yor IP manually to 192.168.1.11 for example.<br />Connect by telnet to it,(192.168.1.1) and modify the configs as shown, but adapting it to the main router&#039;s IP and wireless security settings, of both networks, and its channel.<br />Check this <a href="https://forum.openwrt.org/viewtopic.php?id=35953">https://forum.openwrt.org/viewtopic.php?id=35953</a> to see how to modify them with vi editor.<br />You can also edit manually the config files in windows, matching your router wireless device .<br />And then upload them to the router directly by running a http server. It is explained there too.</p><p>When finished, re-check the config twice. If correct, set the router where it can connect to the wireless network. Reboot it.<br />Change your ip to the new lan range, ex. 192.168.11.11.<br />Telnet again the router, this time 192.168.11.1.<br />Check that the router has connected to the wireless network and has internet, by doing &quot;ping google.es&quot; on the telnet shell.<br />If you got response, break it doing control+c and continue. If not, something is wrong, break it, and check all the configs, wireless settings....<br />At this point, only the router will have internet, as the DHCP still doesn&#039;t work. You need &quot;relayd&quot; to send the DHCP requests from the repeater clients to the main router.<br />Do &quot;opkg update&quot; and then &quot;opkg install relayd&quot;.<br />Do &quot;/etc/initd.d/relayd enable&quot;<br />&quot;/etc/initd.d/relayd start&quot;</p><p>(optional, just for the nice HTTP WebGUI )<br />If you want LuCi, do this:<br />&quot;opkg install luci luci-proto-relay&quot;<br />&quot;/etc/initd.d/uhttpd enable&quot;<br />&quot;/etc/initd.d/uhttpd start&quot;</p><p>FINISHED!!</p><p>Reboot. Set your LAN IP to auto or DHCP, disconnect and reconnect the LAN cable to make sure it renews.<br />Now you should get and IP address from the main router by either wireless or lan, also should have internet and be able to access both the main router and openwrt&#039;s.<br />To access the openwrt&#039;s router by HTTP go to 192.168.x.254. You should have previously configured it on your &quot;network&quot; config.<br />By telnet is the same address.<br />If the repeater looses connectivity with the main router, you will loose all conectivity with both routers as the DHCP depends on the main router.<br />In this case, to access openwrt&#039;s router, manually assign IP addresss of 192.168.10.xx if connected with LAN or 192.168.11.xx with wifi.</p><p>I have been using this config for months. Very stable and fast, running for months without rebooting on a cheap TP-Link WR740n v4.<br />It was just 14euro, about 18$ USD. A great value for the money.</p><p>I also was new at&nbsp; OpenWRT 6 months ago...completely lost. I understand how you might be feeling. OMG I thought it was going to be easier!<br />It is!! But there are so much options and looots of info that is very easy lo get lost.</p><p>Good luck, let me know if you achieve it!</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 28 Aug 2012, 20:26)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176115">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						28 Aug 2012, 17:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi thanks for the reply!</p><p>I followed your guide exactly up till the point to &#039;ping google.es&#039; I&#039;m able to access the internet, download relayd package and reboot.</p><p>But after rebooted and set my LAN to auto obtain IP, I get a weird IP 169.254.142.142 when i do ipconfig. Can&#039;t access the internet, and all of my devices with wifi cannot see the repeater&#039;s ssid at all although the WLAN led is lit (blinks once in a while and sometimes solid color).</p><p>What am I missing? Let me post all my configs below:</p><div class="quotebox"><blockquote><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.11.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>config interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;none&#039;</p><p>config interface &#039;stabridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;relay&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;lan wlanAP wlanSTA&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.2.254&#039;</p><p>config interface &#039;wlanSTA&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.2.254&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.2.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dns &#039;192.168.2.1&#039;</p><p>config interface &#039;wlanAP&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.10.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p></blockquote></div><div class="quotebox"><blockquote><p>config wifi-device&nbsp; radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;mac80211<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 11<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr&nbsp; 64:70:02:7f:29:9a<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode&nbsp; &nbsp;11ng<br />&nbsp; &nbsp; &nbsp; &nbsp; option htmode&nbsp; &nbsp;HT20<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;SHORT-GI-40<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;DSSS_CCK-40</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;sta<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; wlanSTA<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;myrouterssid<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; mypassword</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; wlanAP<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;OpenWrt<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; mypassword</p></blockquote></div><div class="quotebox"><blockquote><p>config defaults<br />&nbsp; &nbsp; &nbsp; &nbsp; option syn_flood&nbsp; &nbsp; &nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option drop_invalid&nbsp; &nbsp; &nbsp;1<br /># Uncomment this line to disable ipv6 rules<br />#&nbsp; &nbsp; &nbsp; &nbsp;option disable_ipv6&nbsp; &nbsp; &nbsp;1</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;lan wlanAP wlanSTA&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br />&nbsp; &nbsp; &nbsp; &nbsp; option masq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu_fix&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</p><p>config forwarding<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan</p><p># We need to accept udp packets on port 68,<br /># see <a href="https://dev.openwrt.org/ticket/4108">https://dev.openwrt.org/ticket/4108</a><br />config rule<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Allow-DHCP-Renew<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; udp<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest_port&nbsp; &nbsp; &nbsp; &nbsp; 68<br />&nbsp; &nbsp; &nbsp; &nbsp; option target&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option family&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ipv4</p></blockquote></div><div class="quotebox"><blockquote><p>config dnsmasq<br />&nbsp; &nbsp; &nbsp; &nbsp; option domainneeded&nbsp; &nbsp; &nbsp;1<br />&nbsp; &nbsp; &nbsp; &nbsp; option boguspriv&nbsp; &nbsp; &nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option filterwin2k&nbsp; &nbsp; &nbsp; 0&nbsp; # enable for dial on demand<br />&nbsp; &nbsp; &nbsp; &nbsp; option localise_queries 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option rebind_protection 1&nbsp; # disable if upstream must serve RFC1918 addresses<br />&nbsp; &nbsp; &nbsp; &nbsp; option rebind_localhost 1&nbsp; # enable for RBL checking and similar services<br />&nbsp; &nbsp; &nbsp; &nbsp; #list rebind_domain example.lan&nbsp; # whitelist RFC1918 responses for domains<br />&nbsp; &nbsp; &nbsp; &nbsp; option local&nbsp; &nbsp; &#039;/lan/&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option domain&nbsp; &nbsp;&#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option expandhosts&nbsp; &nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option nonegcache&nbsp; &nbsp; &nbsp; &nbsp;0<br />&nbsp; &nbsp; &nbsp; &nbsp; option authoritative&nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option readethers&nbsp; &nbsp; &nbsp; &nbsp;1<br />&nbsp; &nbsp; &nbsp; &nbsp; option leasefile&nbsp; &nbsp; &nbsp; &nbsp; &#039;/tmp/dhcp.leases&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option resolvfile&nbsp; &nbsp; &nbsp; &nbsp;&#039;/tmp/resolv.conf.auto&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; #list server&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;/mycompany.local/1.2.3.4&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; #option nonwildcard&nbsp; &nbsp; &nbsp;1<br />&nbsp; &nbsp; &nbsp; &nbsp; #list interface&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;br-lan<br />&nbsp; &nbsp; &nbsp; &nbsp; #list notinterface&nbsp; &nbsp; &nbsp; lo<br />&nbsp; &nbsp; &nbsp; &nbsp; #list bogusnxdomain&nbsp; &nbsp; &nbsp;&#039;64.94.110.11&#039;</p><p>config dhcp lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface&nbsp; &nbsp; &nbsp; &nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore&nbsp; &nbsp;1</p><p>config dhcp wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface&nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore&nbsp; &nbsp;1</p><p>config dhcp wlanAP<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface&nbsp; &nbsp; &nbsp; &nbsp; wlanAP<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore&nbsp; &nbsp;1</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176137">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						28 Aug 2012, 20:12					</div>
				</div>
				<div class="post-content content">
					<p>wireless<br /></p><div class="codebox"><pre><code>config wifi-iface
        option device   radio0
        option mode     sta
        option network  wlanSTA
        option ssid     myrouterssid
        option encryption psk2
        option key      mypassword

config wifi-iface
        option device   radio0
        option mode     ap
        option network  wlanAP
        option ssid     OpenWrt
        option encryption psk2
        option key      mypassword</code></pre></div><p>Did you put the real ssid, password and encryption type on your own config, but changed it just to show here, right? I hope so...</p><p>If the router can ping google, then the connection to the main router is OK. But it seems the router is not running relayd.<br />Force your ip to enter luci (192.168.11.x) and check under &quot;services&quot; tab that Relayd is running.<br />If its not running, you may have forgotten to do this on telnet:<br /></p><div class="codebox"><pre><code>/etc/initd.d/relayd enable
/etc/initd.d/relayd start</code></pre></div><p>Anyway, test again the ping to ensure its having internet after installing relayd, also do &quot;iwconfig&quot; and paste the result here, it may help.<br />If the ping works, ping 192.168.2.1 to check also that openwrt can access the main router.<br />Are you running the latest snapshot from the trunk?</p><p>And also try forcing your IP config as:</p><p>IP: 192.168.2.200<br />Subnet 255.255.255.255<br />Gateway: 192.168.2.1<br />DNS: 192.168.2.1</p><br /><p>and check if you have internet, and if you can ping your repeater and the main router.</p><p>Also, some routers just won&#039;t give DHCP trough a repeater. This happened to me with Hitron routers, my repeater works with any router, encryption ... but never, with Hitron stuff, unless I give static IP manually on each computer, like I&#039;ve just told you 3 lines ago.</p><p>Your WA901 can work as repeater with the original firmware, have you tested it before going to openwrt?<br />Maybe the problem is not in openwrt.<br />Regards</p>											<p class="post-edited">(Last edited by <strong>dabyd64</strong> on 28 Aug 2012, 20:34)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176415">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						30 Aug 2012, 17:39					</div>
				</div>
				<div class="post-content content">
					<p>iwconfig<br /></p><div class="quotebox"><blockquote><p>root@OpenWrt:~# iwconfig<br />lo&nbsp; &nbsp; &nbsp; &nbsp; no wireless extensions.</p><p>wlan0-1&nbsp; &nbsp;IEEE 802.11bgn&nbsp; ESSID:&quot;cymok-new&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mode:Managed&nbsp; Frequency:2.457 GHz&nbsp; Access Point: F8:D1:11:44:77:C2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Bit Rate=121.5 Mb/s&nbsp; &nbsp;Tx-Power=23 dBm<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RTS thr:off&nbsp; &nbsp;Fragment thr:off<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Encryption key:off<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Power Management:off<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Link Quality=61/70&nbsp; Signal level=-49 dBm<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Rx invalid nwid:0&nbsp; Rx invalid crypt:0&nbsp; Rx invalid frag:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Tx excessive retries:1&nbsp; Invalid misc:30&nbsp; &nbsp;Missed beacon:0</p><p>wlan0&nbsp; &nbsp; &nbsp;IEEE 802.11bgn&nbsp; Mode:Master&nbsp; Tx-Power=23 dBm<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RTS thr:off&nbsp; &nbsp;Fragment thr:off<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Power Management:on</p><p>eth0&nbsp; &nbsp; &nbsp; no wireless extensions.</p><p>br-lan&nbsp; &nbsp; no wireless extensions.</p></blockquote></div><p>relayd is running fine, ping to 192.168.2.1 works.</p><p>I tried setting 192.168.2.200 as my PC ip and connect to it via LAN cable, and it can surf the internet and can ping your repeater and the main router!</p><p>However with this ip set, I then try to connect to it via wifi ssid OpenWrt but it failed. This is the last step before I can use it as repeater!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176517">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						31 Aug 2012, 13:58					</div>
				</div>
				<div class="post-content content">
					<p>Thanks everyone!</p><p>I finally finally finally finally got it to function as a repeater by following the config in post 17 here: <a href="https://forum.openwrt.org/viewtopic.php?pid=173069#p173069">https://forum.openwrt.org/viewtopic.php … 69#p173069</a></p><p>surprisingly, that config doesn&#039;t even need &#039;relayd&#039;!! I&#039;m not sure whether it&#039;s one of the points below that are important to make my device&#039;s dhcp to work:<br />EITHER option _orig_ifname &#039;eth0 wlan0&#039;<br />OR config interface &#039;wwan&#039; WITH option proto &#039;dhcp&#039;<br />OR IS IT config dhcp &#039;lan&#039; WITH option force &#039;1&#039;</p><p>Here I will post the exact config that I used to enable my WA901ND to function as a wireless repeater, hope it will help someone someday!!</p><p>/etc/config/network<br /></p><div class="quotebox"><blockquote><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.99.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.99.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dns &#039;192.168.99.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth0 wlan0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;true&#039;</p><p>config interface &#039;wwan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p></blockquote></div><p>/etc/config/wireless<br /></p><div class="quotebox"><blockquote><p>config wifi-device&nbsp; radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;mac80211<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 10<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr&nbsp; 64:70:02:7f:29:9a<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode&nbsp; &nbsp;11ng<br />&nbsp; &nbsp; &nbsp; &nbsp; option htmode&nbsp; &nbsp;HT20<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;SHORT-GI-40<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;DSSS_CCK-40</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;sta<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; wwan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;mainrouterSSID<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; secretpassword</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;OpenWrt<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; secretpassword</p></blockquote></div><p>/etc/config/firewall<br /></p><div class="quotebox"><blockquote><p>config defaults<br />&nbsp; &nbsp; &nbsp; &nbsp; option syn_flood&nbsp; &nbsp; &nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option drop_invalid&nbsp; &nbsp; &nbsp;1<br /># Uncomment this line to disable ipv6 rules<br />#&nbsp; &nbsp; &nbsp; &nbsp;option disable_ipv6&nbsp; &nbsp; &nbsp;1</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;wan wwan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br />&nbsp; &nbsp; &nbsp; &nbsp; option masq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu_fix&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</p><p>config forwarding<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan</p></blockquote></div><p>/etc/config/dhcp<br /></p><div class="quotebox"><blockquote><p>config dhcp lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface&nbsp; &nbsp; &nbsp; &nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option force&nbsp; &nbsp; 1</p><p>config dhcp wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface&nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore&nbsp; &nbsp;1</p></blockquote></div><p>HOPE THIS WILL HELP SOMEONE SOMEDAY!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176535">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						31 Aug 2012, 18:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>iori57 wrote:</cite><blockquote><p>Thanks everyone!</p><p>I finally finally finally finally got it to function as a repeater by following the config in post 17 here: <a href="https://forum.openwrt.org/viewtopic.php?pid=173069#p173069">https://forum.openwrt.org/viewtopic.php … 69#p173069</a></p><p>surprisingly, that config doesn&#039;t even need &#039;relayd&#039;!!</p></blockquote></div><p>yes but that&#039;s routed client + ap, not bridged (or pseudobridge) client + ap, right??? final question is, clients behind repeater are in the same network of those connected to the MAIN router or not??</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176541">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">iori57</div>
					<div class="post-datetime">
						31 Aug 2012, 20:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><div class="quotebox"><cite>iori57 wrote:</cite><blockquote><p>Thanks everyone!</p><p>I finally finally finally finally got it to function as a repeater by following the config in post 17 here: <a href="https://forum.openwrt.org/viewtopic.php?pid=173069#p173069">https://forum.openwrt.org/viewtopic.php … 69#p173069</a></p><p>surprisingly, that config doesn&#039;t even need &#039;relayd&#039;!!</p></blockquote></div><p>yes but that&#039;s routed client + ap, not bridged (or pseudobridge) client + ap, right??? final question is, clients behind repeater are in the same network of those connected to the MAIN router or not??</p></blockquote></div><p>You are right, they are on different network. But for me I just need to be able to go online <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>Anyway I&#039;m left with no choice, I can&#039;t get relayd to work and I&#039;m not sure what did I do wrong.</p>											<p class="post-edited">(Last edited by <strong>iori57</strong> on 31 Aug 2012, 20:31)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176716">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						3 Sep 2012, 01:27					</div>
				</div>
				<div class="post-content content">
					<p>Yes, I relayd will bridge both networks, and without relay its just a different network.<br />But, internet will work fine in both ways.<br />Nice you suceed ! <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p176719">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">dabyd64</div>
					<div class="post-datetime">
						3 Sep 2012, 02:12					</div>
				</div>
				<div class="post-content content">
					<p>I made a new topic with both repeater configurations here: <a href="https://forum.openwrt.org/viewtopic.php?pid=176718#p176718">https://forum.openwrt.org/viewtopic.php … 18#p176718</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p178565">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">ahmed88</div>
					<div class="post-datetime">
						18 Sep 2012, 05:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi,</p><p>I was just wondering, I&#039;ve spent last few days configuring my wa901nd v.2 as repeater. I finally managed to do so, can access the net from the repeater and such, but dhcp doesnt work and broadcast on 192.168.1.0 network doesnt work either. I revert back to original firmware and use the universal repeater mode and works like a charm. </p><p>My question is anyone knows how tp-link implement their repeater mode? Their steps only takes few clicks and off you go whilst in it is abit challenging to do it in openwrt. Do they have like proprietary driver or something else?</p><p>br//</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p185319">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">nixospu1</div>
					<div class="post-datetime">
						5 Dec 2012, 19:52					</div>
				</div>
				<div class="post-content content">
					<p>Hello I don&#039;t know how it works, but it works, even little better as repeater.</p><p>This way of install:</p><p>uci set wireless.@wifi-device[0].disabled=0; uci commit wireless; wifi&nbsp; &nbsp; &nbsp; </p><p>Then I connect through WiFi</p><p>cat &gt; /etc/resolv.conf &lt;&lt;EOF<br />nameserver 192.168.1.5<br />EOF<br />route add default gw 192.168.1.5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&gt;&gt;&gt;&gt; Router IP, must connect to Router now with Lan cord</p><p>opkg update<br />opkg install luci</p><p>/etc/init.d/uhttpd enable<br />/etc/init.d/uhttpd start</p><p>/etc/init.d/network reload&nbsp; </p><br /><p>Just erase all settings if need:<br />mount_root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />killall dropbear uhttpd; sleep 1; mtd -r erase rootfs_data&nbsp; &nbsp; &nbsp; &nbsp; </p><br /><p>In Luci I just create additional interface that will connect to the router with password, no specify settings. That&#039;s all.<br />It looks like that:<br /><a href="http://postimage.org/image/aeqxcltqz/"><span class="postimg"><img src="http://s17.postimage.org/aeqxcltqz/1111.jpg" alt="http://s17.postimage.org/aeqxcltqz/1111.jpg" /></span></a></p><p>Now I have choice where can connect through wifi - to the old weak signal router or to the new from repeater. </p><p>Actually it&#039;s hard to understand such complicated thing for me, maybe it can be solved easier way. But hopeful I help&nbsp; someone)<br />Sorry for English.</p>											<p class="post-edited">(Last edited by <strong>nixospu1</strong> on 5 Dec 2012, 19:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p233985">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">manthinking</div>
					<div class="post-datetime">
						20 May 2014, 16:58					</div>
				</div>
				<div class="post-content content">
					<p>I was able to get the TL-WDR3500 to function as a repeater using your config. Thanks!</p><div class="quotebox"><cite>iori57 wrote:</cite><blockquote><p>Thanks everyone!</p><p>I finally finally finally finally got it to function as a repeater by following the config in post 17 here: <a href="https://forum.openwrt.org/viewtopic.php?pid=173069#p173069">https://forum.openwrt.org/viewtopic.php … 69#p173069</a></p><p>surprisingly, that config doesn&#039;t even need &#039;relayd&#039;!! I&#039;m not sure whether it&#039;s one of the points below that are important to make my device&#039;s dhcp to work:<br />EITHER option _orig_ifname &#039;eth0 wlan0&#039;<br />OR config interface &#039;wwan&#039; WITH option proto &#039;dhcp&#039;<br />OR IS IT config dhcp &#039;lan&#039; WITH option force &#039;1&#039;</p><p>Here I will post the exact config that I used to enable my WA901ND to function as a wireless repeater, hope it will help someone someday!!</p><p>/etc/config/network<br /></p><div class="quotebox"><blockquote><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.99.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.99.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dns &#039;192.168.99.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_ifname &#039;eth0 wlan0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option _orig_bridge &#039;true&#039;</p><p>config interface &#039;wwan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p></blockquote></div><p>/etc/config/wireless<br /></p><div class="quotebox"><blockquote><p>config wifi-device&nbsp; radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;mac80211<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 10<br />&nbsp; &nbsp; &nbsp; &nbsp; option macaddr&nbsp; 64:70:02:7f:29:9a<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode&nbsp; &nbsp;11ng<br />&nbsp; &nbsp; &nbsp; &nbsp; option htmode&nbsp; &nbsp;HT20<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;SHORT-GI-40<br />&nbsp; &nbsp; &nbsp; &nbsp; list ht_capab&nbsp; &nbsp;DSSS_CCK-40</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;sta<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; wwan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;mainrouterSSID<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; secretpassword</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;OpenWrt<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; secretpassword</p></blockquote></div><p>/etc/config/firewall<br /></p><div class="quotebox"><blockquote><p>config defaults<br />&nbsp; &nbsp; &nbsp; &nbsp; option syn_flood&nbsp; &nbsp; &nbsp; &nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option drop_invalid&nbsp; &nbsp; &nbsp;1<br /># Uncomment this line to disable ipv6 rules<br />#&nbsp; &nbsp; &nbsp; &nbsp;option disable_ipv6&nbsp; &nbsp; &nbsp;1</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT</p><p>config zone<br />&nbsp; &nbsp; &nbsp; &nbsp; option name&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#039;wan wwan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option input&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br />&nbsp; &nbsp; &nbsp; &nbsp; option output&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;ACCEPT<br />&nbsp; &nbsp; &nbsp; &nbsp; option forward&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REJECT<br />&nbsp; &nbsp; &nbsp; &nbsp; option masq&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu_fix&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1</p><p>config forwarding<br />&nbsp; &nbsp; &nbsp; &nbsp; option src&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option dest&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;wan</p></blockquote></div><p>/etc/config/dhcp<br /></p><div class="quotebox"><blockquote><p>config dhcp lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface&nbsp; &nbsp; &nbsp; &nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option force&nbsp; &nbsp; 1</p><p>config dhcp wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface&nbsp; &nbsp; &nbsp; &nbsp; wan<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore&nbsp; &nbsp;1</p></blockquote></div><p>HOPE THIS WILL HELP SOMEONE SOMEDAY!</p></blockquote></div>											<p class="post-edited">(Last edited by <strong>manthinking</strong> on 20 May 2014, 21:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p244403">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">pauloavilaneto</div>
					<div class="post-datetime">
						20 Aug 2014, 20:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>iori57 wrote:</cite><blockquote><p>managed to reset using openwrt failsafe method..</p><p>After that, I follow the same guide again, this time carefully change some of the settings to match with my current network settings: (192.168.2.1 is my internet router&#039;s IP address, and I access my WA901ND via 192.168.2.254 (luci too))</p><p>network<br /></p><div class="quotebox"><blockquote><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0 eth1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;192.168.2.254&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option gateway &#039;192.168.2.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option dns &#039;8.8.8.8&#039;</p><p>config interface &#039;wwan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;dhcp&#039;</p><p>config interface &#039;stabridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;relay&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;lan wwan&#039;</p></blockquote></div><p>wireless<br /></p><div class="quotebox"><blockquote><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;OpenWrt<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; secretkey</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; wwan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;sta<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;MyRouterSSID<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption psk2<br />&nbsp; &nbsp; &nbsp; &nbsp; option key&nbsp; &nbsp; &nbsp; secretkey</p></blockquote></div><p>dhcp<br /></p><div class="quotebox"><blockquote><p>config dhcp &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option start &#039;100&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option limit &#039;150&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option leasetime &#039;12h&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p><p>config dhcp &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;wan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ignore &#039;1&#039;</p></blockquote></div><p>firewall off</p><p>I think I&#039;m getting close... I unplugged the network cable, after that my PC is able to connect to OpenWrt and telnet to the device (however cannot access Luci which I don&#039;t know why), I&#039;m able to surf the internet for a while (my ip address is 192.168.2.102), until the connection got lost again after 1 minute or so (the ip address changes to some weird number 169.254.35.131) and can&#039;t surf the net anymore, then I have to reconnect to make it work.</p><p>Need a final push from someone!! Thanks in advance!</p></blockquote></div><br /><p>SAME Trouble here. Same device, and I tried to use vi editor, But I am more inexperienced then you. My device bricked and I am tired of getting into Failsafe mode... I use macOSX Mavericks. Can&#039;t we just config it using Luci web interface?</p>											<p class="post-edited">(Last edited by <strong>pauloavilaneto</strong> on 20 Aug 2014, 20:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p248317">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">jorslb</div>
					<div class="post-datetime">
						27 Sep 2014, 23:11					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pauloavilaneto wrote:</cite><blockquote><p>SAME Trouble here. Same device, and I tried to use vi editor, But I am more inexperienced then you. My device bricked and I am tired of getting into Failsafe mode... I use macOSX Mavericks. Can&#039;t we just config it using Luci web interface?</p></blockquote></div><p>Now we can do it using Luci interface. Realy easy! Already tried with success.</p><p><a href="https://www.youtube.com/watch?v=3rbsh2zxPnk">https://www.youtube.com/watch?v=3rbsh2zxPnk</a></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>