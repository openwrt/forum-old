<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Reading SR04 ultrasonic sensor connected to GPIO pins</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 14 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p307109">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">davidgo</div>
					<div class="post-datetime">
						11 Jan 2016, 07:40					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m looking for a low power, inexpensive system to read an SR04 ultrasonic sensor and have the output available on a built-in web server on a WIFI connection.&nbsp; &nbsp; I am hoping to do this using a system running OpenWRT.</p><p>I&#039;ve come across a GL-AR150 board (based on the Atheros 9331) which claims to have 5 GPIO pins, and I&#039;m hoping I can wire an SR04 compatible sensor up to these, although if there are other more suitable boards I&#039;m certainly happy to use a different one if it meets my needs.</p><p>The issue I have is that timing is quite critical - the SR04 sends a pulse and measures how many microseconds it takes to return, from which distance can be calculated.&nbsp; I would thus assume that scripting something in BASH is not a viable option.&nbsp; &nbsp;Does anyone know of a library or way I can send a trigger and then read the output of one of these sensors?&nbsp; </p><p>I&#039;ve found a couple of hints how this could be achieved on a Raspberry Pi - <a href="http://ananddrs.com/2014/03/11/raspberry-pi-ultrasonic/">http://ananddrs.com/2014/03/11/raspberry-pi-ultrasonic/</a> and <a href="https://github.com/wdalmut/libultrasonic/blob/master/src/hc_sr04/hc_sr04.c">https://github.com/wdalmut/libultrasoni … /hc_sr04.c</a> but both of these seem to call or relate to &quot;bcm&quot; - is there an equivalent way I can do this with on a basic OpenWRT based board with built in WIFI ?</p><p>Thanks,<br />David</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307150">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						11 Jan 2016, 15:33					</div>
				</div>
				<div class="post-content content">
					<p>R U talkinga bout thir <a href="http://www.aliexpress.com/item/1pcs-Ultrasonic-Module-HC-SR04-Distance-Measuring-Transducer-Sensor-for-Arduino-HC-SR04-HCSR04/32404944249.html">HC-SR04 Ultrasonic Wave Detector</a>?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307151">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						11 Jan 2016, 15:37					</div>
				</div>
				<div class="post-content content">
					<p>For board, perhaps this <a href="http://www.aliexpress.com/item/Orange-Pi-PC-ubuntu-linux-and-android-mini-PC-Beyond-and-Compatible-with-Raspberry-Pi-2/32448079125.html">Orange Pi PC</a> will be a better buy than an RPi.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307217">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">davidgo</div>
					<div class="post-datetime">
						11 Jan 2016, 22:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mazilo wrote:</cite><blockquote><p>For board, perhaps this <a href="http://www.aliexpress.com/item/Orange-Pi-PC-ubuntu-linux-and-android-mini-PC-Beyond-and-Compatible-with-Raspberry-Pi-2/32448079125.html">Orange Pi PC</a> will be a better buy than an RPi.</p></blockquote></div><p>Thanks for the suggestion and question.&nbsp; </p><p>I am planning on using a sensor like <a href="http://www.ebay.com/itm/Ultrasonic-Module-Distance-Measuring-Transducer-Sensor-Perfect-Waterproof-/321714364470">this one</a> - its pin-for-pin compatible with the SR04 (I&#039;ve used them before an an Arduino board) and, of-course, its waterproof.</p><p>The Orange PI PC certainly looks interesting and cheap, however I&#039;m looking for something as low power as I can manage (bearing in mind my&nbsp; limited programming skills and lack of IoT knowledge).&nbsp; &nbsp;I was looking at&nbsp; a <a href="http://www.aliexpress.com/item/GL-iNet-GL-AR150-150Mbps-WiFi-Router-OPENWRT-ENGLISH-Firmware-Wi-Fi-Repeater-Wifi-Signal-Booster/32518790497.html?spm=2114.01020208.3.10.2XL1I9&amp;ws_ab_test=searchweb201556_1,searchweb201644_4_10001_10002_9985_10005_10006_10003_10004_62,searchweb201560_8,searchweb1451318400_6148">GL-AR150</a>&nbsp; because its&nbsp; power requirement is 1 watt (as opposed to 3 watts for an RPi Orange), and because it has WIFI with decent antenna&nbsp; - which the RPi&#039;s don&#039;t seem to have -&nbsp; I need to keep the power consumption low because the unit needs to be solar powered.&nbsp; &nbsp;(And having a decent size antenna for &lt; $1 is a valuable bonus)</p><br /><p>The reason I posted in this forum is because the board runs OpenWRT.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307251">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						12 Jan 2016, 01:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>davidgo wrote:</cite><blockquote><p>I&#039;m looking for a low power, inexpensive system to read an SR04 ultrasonic sensor and have the output available on a built-in web server on a WIFI connection.</p></blockquote></div><p>Not sure about this: ESP8266<br />Inexpensive, low power, Wifi, webserver.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307254">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">davidgo</div>
					<div class="post-datetime">
						12 Jan 2016, 01:57					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for this.&nbsp; From what I&#039;ve researched the ESP8266 is not powerful enough to use directly as it does not expose 2 GPIO pins and (as far as I can see) does not provide the required functionality (particularly timer) for an SR04.&nbsp; &nbsp;It is pretty cool though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307354">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">tomrev</div>
					<div class="post-datetime">
						12 Jan 2016, 20:07					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>mazilo wrote:</cite><blockquote><p>For board, perhaps this <a href="http://www.aliexpress.com/item/Orange-Pi-PC-ubuntu-linux-and-android-mini-PC-Beyond-and-Compatible-with-Raspberry-Pi-2/32448079125.html">Orange Pi PC</a> will be a better buy than an RPi.</p></blockquote></div><p>Orange Pi&#039;s hardware is good spec but software is bad, almost no official support, closed source, rarely official update and unusable for Openwrt. It&#039;s a piece of junk.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307362">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">mazilo</div>
					<div class="post-datetime">
						12 Jan 2016, 20:39					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>tomrev wrote:</cite><blockquote><div class="quotebox"><cite>mazilo wrote:</cite><blockquote><p>For board, perhaps this <a href="http://www.aliexpress.com/item/Orange-Pi-PC-ubuntu-linux-and-android-mini-PC-Beyond-and-Compatible-with-Raspberry-Pi-2/32448079125.html">Orange Pi PC</a> will be a better buy than an RPi.</p></blockquote></div><p>Orange Pi&#039;s hardware is good spec but software is bad, almost no official support, closed source, rarely official update and unusable for Openwrt. It&#039;s a piece of junk.</p></blockquote></div><p>Please kindly provide any link to support what you said above for posterity shake.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p307462">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">tomrev</div>
					<div class="post-datetime">
						13 Jan 2016, 11:20					</div>
				</div>
				<div class="post-content content">
					<p>Sorry, davidgo for off topic.<br /></p><div class="quotebox"><cite>mazilo wrote:</cite><blockquote><div class="quotebox"><cite>tomrev wrote:</cite><blockquote><div class="quotebox"><cite>mazilo wrote:</cite><blockquote><p>For board, perhaps this <a href="http://www.aliexpress.com/item/Orange-Pi-PC-ubuntu-linux-and-android-mini-PC-Beyond-and-Compatible-with-Raspberry-Pi-2/32448079125.html">Orange Pi PC</a> will be a better buy than an RPi.</p></blockquote></div><p>Orange Pi&#039;s hardware is good spec but software is bad, almost no official support, closed source, rarely official update and unusable for Openwrt. It&#039;s a piece of junk.</p></blockquote></div><p>Please kindly provide any link to support what you said above for posterity shake.</p></blockquote></div><br /><br /><p>- &quot;almost no official support&quot; -</p><p>Because Orange Pi use Allwinner CPU, closed source and violated GPL - <a href="http://linux-sunxi.org/GPL_Violations">http://linux-sunxi.org/GPL_Violations</a> , full of blob, code modification for developer is a bad dream. It is only usable level because of video hardware acceleration on Android but Linux is almost a garbage because no HW accel code FOSS or blob.&nbsp; It is very limit to modify code for any platforms, so it a kind of dead board.</p><p>- &quot;unusable for Openwrt&quot; -<br />Some people still hopelessly wait for openwrt - <a href="http://www.orangepi.org/orangepibbsen/forum.php?mod=viewthread&amp;tid=133&amp;extra=&amp;page=2">http://www.orangepi.org/orangepibbsen/f … amp;page=2</a> . </p><p>I almost bought Orange Pi because of price and spec but after studied it a bad choice compare to competitors.</p>											<p class="post-edited">(Last edited by <strong>tomrev</strong> on 13 Jan 2016, 11:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p320752">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Jodaille</div>
					<div class="post-datetime">
						22 Apr 2016, 01:15					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>if your sensor works well on arduino, maybe you can plug it to a router like TL-WR703N<br />and read datas over serial connection ?</p><p>I am working with college students on a project to be able to send datas from a beehive to the web.</p><p>I have just managed to make the process working, maybe the sources can help you <a href="https://github.com/Jodaille/LyceeDesAndaines/tree/master/ArduinoToLinux">https://github.com/Jodaille/LyceeDesAnd … inoToLinux</a></p>											<p class="post-edited">(Last edited by <strong>Jodaille</strong> on 22 Apr 2016, 01:16)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>