<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Debrick - TP-LINK WR841ND 7.2 via serial console - only garbage</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 26 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p268280">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						10 Mar 2015, 21:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />one of my router TP-LINK WR841ND 7.2 do not boot after remote firmware upgrade (OpenWRT trunk) - it react to connected LAN port, but I&#039;m not able to enter failsafe, so I&#039;m trying serial console for the 1st time. The system LED is even all the time off - never blink or similar. Following <a href="http://wiki.openwrt.org/toh/tp-link/tl-wr841nd#serial.console.">http://wiki.openwrt.org/toh/tp-link/tl- … l.console.</a></p><p>The problem which I have, I&#039;m trying to get it boot via console, but I&#039;m just seeing garbage (somehow I see it&#039;s probably booting). I have tried to add also 10kOhm (actually 10.11 kOhm, not sure whether this is a problem) between TX and VCC<br />Is it due to the used DELOCK USB-RS232 (61018) ? Seeing that everyone is using Nokia DKU-5 TTL or CA-42...</p><p>Thank you for your help.</p><p><span class="postimg"><img src="http://s30.postimg.org/pp53jvwlt/2015_03_10_20_07_58_Pu_TTY_Configuration.png" alt="Putty" /></span><br /><span class="postimg"><img src="http://s12.postimg.org/jmp1zusyl/2015_03_10_20_08_25_COM22_Pu_TTY.png" alt="Garbage" /></span></p>											<p class="post-edited">(Last edited by <strong>sharkys</strong> on 10 Mar 2015, 21:42)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p268284">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						10 Mar 2015, 23:08					</div>
				</div>
				<div class="post-content content">
					<p>you cannot use an RS232 adapter, it uses +/- 12V and can easilly fry your board.</p><p>use only TTL (3.3v) adapters.</p><p>never connect the VCC pin to anything <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p268288">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						10 Mar 2015, 23:17					</div>
				</div>
				<div class="post-content content">
					<p>So if I got you correctly, the only solution is to get&nbsp; Nokia DKU-5 TTL or CA-42 ?</p><p>VCC - I have never connected it to anything yet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p268289">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						10 Mar 2015, 23:27					</div>
				</div>
				<div class="post-content content">
					<p>Any USB to serial adapter with a 3.3 volt &quot;TTL&quot; interface will work.&nbsp; Or you can build a circuit to convert from RS-232 to TTL, but that is unnecessarily complicated compared to just getting TTL from the adapter to begin with.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p268408">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						11 Mar 2015, 16:43					</div>
				</div>
				<div class="post-content content">
					<p>try other speeds as:&nbsp; 75, 110, 300, 1200, 2400, 4800, 9600, 19200, 38400, 57600 and 115200 bit/s<br /><a href="http://en.wikipedia.org/wiki/Serial_port">http://en.wikipedia.org/wiki/Serial_port</a><br />also ttl-serial(3.3v) 8N1 no flow control</p>											<p class="post-edited">(Last edited by <strong>makarel</strong> on 11 Mar 2015, 16:46)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p268660">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						13 Mar 2015, 21:28					</div>
				</div>
				<div class="post-content content">
					<p>OK, thank you for all your comments, so it was finally successful with Nokia DKU-5 TTL . But now I have got another problem. Following the guide on <a href="https://forum.openwrt.org/viewtopic.php?id=33906,">https://forum.openwrt.org/viewtopic.php?id=33906,</a> I uploaded the firmware, everything is fine, router boot first - but the second reboot get stuck always and I can again bring it to life only via serial and only first boot is fine.</p><p>Anyone get any idea what is wrong please ?</p><div class="codebox"><pre><code>U-Boot 1.1.4 (Sep  3 2010 - 12:35:51)

AP99 (ar7241 - Virian) U-boot
DRAM:
sri
ar7240_ddr_initial_config(133): virian ddr1 init
#### TAP VALUE 1 = 0xf, 2 = 0x10 [0x0: 0x1f]
32 MB
id read 0x100000ff
sector count = 64
Flash:  4 MB
Using default environment

In:    serial
Out:   serial
Err:   serial
Net:   ag7240_enet_initialize...
No valid address in Flash. Using fixed address
No valid address in Flash. Using fixed address
Virian MDC CFG Value ==&gt; 4
: cfg1 0xf cfg2 0x7014
eth0: 00:03:7f:09:0b:ad
eth0 up
Virian MDC CFG Value ==&gt; 4
: cfg1 0xf cfg2 0x7214
eth1: 00:03:7f:09:0b:ad
ATHRS26: resetting s26
ATHRS26: s26 reset done
eth1 up
eth0, eth1
Autobooting in 1 seconds
## Booting image at 9f020000 ...
   Uncompressing Kernel Image ... OK

Starting kernel ...
[    0.000000] Linux version 3.18.8 (someone@debian) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r44597) ) #3 Thu Mar 5 13:21:11 CST 2015
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 00019374 (MIPS 24Kc)
[    0.000000] SoC: Atheros AR7241 rev 1
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 02000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x01ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x01ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x01ffffff]
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
[    0.000000] Kernel command line:  board=TL-WR841N-v7 console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
[    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] Writing ErrCtl register=00000000
[    0.000000] Readback ErrCtl register=00000000
[    0.000000] Memory: 28456K/32768K available (2480K kernel code, 120K rwdata, 528K rodata, 252K init, 188K bss, 4312K reserved)
[    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:5.000MHz
[    0.000000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.080000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.090000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.100000] NET: Registered protocol family 16
[    0.100000] MIPS: machine is TP-LINK TL-WR841N/ND v7
[    0.550000] registering PCI controller with io_map_base unset
[    0.560000] PCI host bridge to bus 0000:00
[    0.570000] pci_bus 0000:00: root bus resource [mem 0x10000000-0x13ffffff]
[    0.570000] pci_bus 0000:00: root bus resource [io  0x0000]
[    0.580000] pci_bus 0000:00: No busn resource found for root bus, will use [bus 00-ff]
[    0.580000] pci 0000:00:00.0: fixup device configuration
[    0.590000] pci 0000:00:00.0: BAR 0: assigned [mem 0x10000000-0x1000ffff 64bit]
[    0.590000] pci 0000:00:00.0: using irq 40 for pin 1
[    0.600000] Switched to clocksource MIPS
[    0.600000] NET: Registered protocol family 2
[    0.610000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.610000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.620000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.630000] TCP: reno registered
[    0.630000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.640000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.640000] NET: Registered protocol family 1
[    0.650000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.660000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.670000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.680000] msgmni has been set to 55
[    0.700000] io scheduler noop registered
[    0.700000] io scheduler deadline registered (default)
[    0.710000] Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled
[    0.710000] console [ttyS0] disabled</code></pre></div>											<p class="post-edited">(Last edited by <strong>sharkys</strong> on 13 Mar 2015, 21:29)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p268664">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">sharkys</div>
					<div class="post-datetime">
						13 Mar 2015, 21:52					</div>
				</div>
				<div class="post-content content">
					<p>OK, so I replaced my own compiled firmware (OpenWrt Chaos Calmer r44597 ) with the latest trunk one... <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/generic/openwrt-ar71xx-generic-tl-wr841nd-v7-squashfs-factory.bin">http://downloads.openwrt.org/snapshots/ … actory.bin</a></p><p>What I don&#039;t get, I&#039;m using currently the same version (r44597) on several other routers - TP-Link TL-WR841N/ND v8, TP-Link TL-WA850RE v1, TP-Link TL-WR841N/ND v8,TP-Link TL-WR842N/ND v1 but only on TL-WR841ND v7 it&#039;s not booting ?</p><p>I don&#039;t get it, all of them got the same size, I&#039;m building it using &quot;env switch&quot;... is it possible that just r44597&nbsp; got broken for TL-WR841ND v7 ?</p>											<p class="post-edited">(Last edited by <strong>sharkys</strong> on 13 Mar 2015, 21:53)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>