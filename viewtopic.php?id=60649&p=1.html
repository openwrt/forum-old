<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Installation Method for Linksys EA4500</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 28 Mar 2018 and 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=60649&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p298094">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">semirauthsala</div>
					<div class="post-datetime">
						31 Oct 2015, 10:32					</div>
				</div>
				<div class="post-content content">
					<p>I bought linksys ea4500 router days ago which advertised as a supported router in openwrt device list. I also read ea4500 is the best value router for openwrt. Anyway after bought I tried to install openwrt using image provided by candyhouse project. But that image have some problems and WiFi throughput is horrible </p><p>I saw since chaos calmer release this router officially supported by openwrt. But in the download page there is only files that suitable for serial flashing. To do this I have to open the case and solder the Serial cable. I little bit upset with this method (even though I have USB to TTL cable and necessary stuff)</p><p>Image provided by the candyhouse project can be flash directly through the OEM firmware and I re-flash OEM successfully without issues. Is official openwrt provide .bin file for direct flashing this router ? or I have to build image using openwrt build system ? I don&#039;t have any experience with building oprnwrt.</p><p>can someone please help me in this ? I really want to flash stable openwrt CC in my linksys ea4500. what is the most suitable way to do this ?</p><p>thanks !!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298144">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">joni</div>
					<div class="post-datetime">
						31 Oct 2015, 20:05					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m kind of on the same boat as you, but my problem is that Candyhouse project sends me to Claudio&#039;s GitHub repository and there it tells me to build the image. You appear to have already the &quot;image provided by candyhouse&quot; project. </p><p>Can you tell me where did you get this ready to install image?. </p><p>Regarding your problem, on the OpenWRT page dedicated to Linksys EA4500 / E4200 v2 (<a href="http://wiki.openwrt.org/toh/linksys/ea4500">http://wiki.openwrt.org/toh/linksys/ea4500</a>) they explain to install the candyhouse image.... then......put the chaos files in a usb stick and run some procedure to install it...no serial needed. see it and let me know.</p><p>regards<br />Joni</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298148">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">semirauthsala</div>
					<div class="post-datetime">
						31 Oct 2015, 20:21					</div>
				</div>
				<div class="post-content content">
					<p>I download it from candyhouse project page. This is the link <a href="https://mega.nz/#!bNAhDI6S!PZQTb8X4XxOfBAuV61L8t5RqBNAdgnr0jtSSk6za9uc">https://mega.nz/#!bNAhDI6S!PZQTb8X4XxOf … tSSk6za9uc</a> <br />. I saw the steps you mentioned in Openwrt wiki. Does it have stable wifi signals ? and newer kernel ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298149">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">joni</div>
					<div class="post-datetime">
						31 Oct 2015, 20:30					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t know, i&#039;m trying to get there myself.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298150">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">semirauthsala</div>
					<div class="post-datetime">
						31 Oct 2015, 20:36					</div>
				</div>
				<div class="post-content content">
					<p>This image working fine but the wifi throughput is not good.&nbsp; And also I tried to install openvpn but it failed because of the kernel version. LUCI is also little bit laggy first but after couple of reboots it fixed. I re-flashed stock again because I need strong wifi</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298151">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">joni</div>
					<div class="post-datetime">
						31 Oct 2015, 20:41					</div>
				</div>
				<div class="post-content content">
					<p>I download your file using the link you sent but i still cannot find it on the candyhouse project. Can you post the link to the page where you saw that file (or saw the link to the file)?</p><p>thanks<br />Joni</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298152">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">semirauthsala</div>
					<div class="post-datetime">
						31 Oct 2015, 20:44					</div>
				</div>
				<div class="post-content content">
					<p><a href="http://www.wolfteck.com/projects/candyhouse/openwrt/">http://www.wolfteck.com/projects/candyhouse/openwrt/</a></p><p>the file is posted by user called Queen Fiona. you can find that post easily</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298153">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">semirauthsala</div>
					<div class="post-datetime">
						31 Oct 2015, 20:46					</div>
				</div>
				<div class="post-content content">
					<p><span class="postimg"><img src="https://dl.dropboxusercontent.com/u/71712423/pic/Screenshot_2.jpg" alt="PunBB bbcode test" /></span></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298155">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">joni</div>
					<div class="post-datetime">
						31 Oct 2015, 21:01					</div>
				</div>
				<div class="post-content content">
					<p>Got it! thanks. Now I understand what they are talking about. As mentioned , EA4500 was added to the Chaos Calmer release but not squashfs (noted by Adrian on the same thread), that&#039;s why we have to go Claudio&#039;s first then perform the steps with USB stick to put Chaos in.<br />I will try this and report back.</p>											<p class="post-edited">(Last edited by <strong>joni</strong> on 31 Oct 2015, 21:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298156">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">semirauthsala</div>
					<div class="post-datetime">
						31 Oct 2015, 21:06					</div>
				</div>
				<div class="post-content content">
					<p>Okay I really cant understand what is the different between normal image and squashfs. :S The image I flashed only gave me 16MB of storage even the router has 128MB ( I thought this is the difference) anyway let me know if you are able to flash successfully and if it&#039;s possible please check the WiFi throughput as well. </p><p>Thanks !!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298282">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">joni</div>
					<div class="post-datetime">
						1 Nov 2015, 23:01					</div>
				</div>
				<div class="post-content content">
					<p>Hi, <br />a lot happened but let me sum up for you:</p><p>&nbsp; &nbsp;The instructions on the wiki to install OpenWrt on EA4500 without using serial cable <span style="color: blue"><strong>(1)</strong></span> do not work with the Fiona Claudio&#039;s based build <span style="color: blue"><strong>(2)</strong></span>. </p><p>&nbsp; &nbsp;I managed to get it working after a lot of investigating, some courage and a lot of luck I guess.</p><p>&nbsp; &nbsp;I&#039;m going to put a copy of the instructions that do not work <span style="color: blue"><strong>(1)</strong></span> here for future reference in case they are updated and invalidate my comments.</p><h5>INSTRUCTIONS</h5><p>-------<br />Prepare:</p><p>get the right Image for Your device from Candyhouse Projekt <span style="color: blue"><strong>(3)</strong></span><br />build an initramfs image from openwrts buildroot or download mine from Here <span style="color: blue"><strong>(4)</strong></span><br />download openwrt-kirkwood-ea4500-rootfs.ubi and openwrt-kirkwood-ea4500-uImage from Here <span style="color: blue"><strong>(5)</strong></span><br />format an usb pendrive with ext3 (no idea if fat is working? fatload available in uboot?) and mount it. (if it wont work, use ext2)<br />Put uImage, openwrt-kirkwood-ea4500-rootfs.ubi and openwrt-kirkwood-ea4500-uImage on that usb stick. Cleanly unmount it !!!</p><p>The flashing process:</p><p>Flash Your ea4500 wit the candyhouse image.<br />after reboot candyhouses openwrt will be up, login using telnet/ssh<br />plugin the prepared pen drive and run the following commands:</p><p>fw_setenv bootcmd &#039;run owrt_usb; run nandboot&#039;<br />fw_setenv owrt_usb &#039;usb start; sleep 5;ext2load usb 0:1 ${loadaddr} /uImage; setenv bootargs $(console) $(mtdparts) root=/dev/ram rw; bootm ${loadaddr}&#039;<br />mkdir /sda1 &amp;&amp; mount /dev/sda1 /sda1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(no mistake it does not boot without it)<br />reboot</p><p>After a few, openwrt initramfs will be boot from this pen drive. Login using telnet/ssh and rum Commands:</p><p>mkdir /sda1 &amp;&amp; mount /dev/sda1 /sda1 &amp;&amp; cd /sda1<br />ubiformat /dev/mtd3 &amp;&amp; ubiformat /dev/mtd3 -f openwrt-kirkwood-ea4500-rootfs.ubi</p><p>Only if ubiformat and mount didn&#039;t produce any errors continue with: (otherwise youre fucked!!)</p><p>mtd erase kernel<br />mtd write openwrt-kirkwood-ea4500-uImage kernel<br />fw_setenv bootcmd &#039;run owrt_usb; run owrt_boot&#039;<br />fw_setenv owrt_usb &#039;usb start; sleep 5;ext2load usb 0:1 ${loadaddr} /uImage; setenv bootargs $(console) root=/dev/ram rw; bootm ${loadaddr}&#039;<br />fw_setenv owrt_boot &#039;nand read.e ${loadaddr} 0x200000 0x200000; setenv bootargs $(console) ubi.mtd=3 root=ubi0:rootfs rootfstype=ubifs rw; bootm ${loadaddr}&#039;<br />fw_setenv auto_recovery no<br />reboot</p><p>Now you are done. With the usb stick connected and uImage on it, the router will boot this image. otherwise it boots from nand.<br />Have fun!</p><p>------</p><h5>COMMENTS</h5><p> based on my experience:</p><p>&nbsp; &nbsp;first issue was when mounting the usb pen, it gave me the error : <br />&nbsp; &nbsp;<br />&nbsp; &nbsp;<strong><span style="color: #FF0000">NTFS signature is missing.<br />&nbsp; &nbsp;Failed to mount &#039;/dev/sda1&#039;: Invalid argument<br />&nbsp; &nbsp;The device &#039;/dev/sda1&#039; doesn&#039;t seem to have a valid NTFS.</span><br />&nbsp; &nbsp;Maybe the wrong device is used? Or the whole disk instead of a<br />&nbsp; &nbsp;partition (e.g. /dev/sda, not /dev/sda1)? Or the other way around?<br />&nbsp; &nbsp;</strong><br />&nbsp; &nbsp;I search a lot about this but most issues were about trying to mount NTFS and not Ext. I tried Ext2, Ext3. even tried Fat and Fat32.<br />&nbsp; &nbsp;At some point I found that I could mount it using <strong>-t ext2</strong> parameter. <br />&nbsp; &nbsp;I proceeded for the reboot (after the 2 <strong>fw_setenv</strong> commands and the <strong>mount</strong>)<br />&nbsp; &nbsp;after the reboot the same banner and OpenWrt version appeared and I thought this can&#039;t be right but there was no way to tell, no intructions on how to verify, nothing..(afterwards I knew it was wrong).<br />&nbsp; &nbsp;The next block of commands started with the mount (again had to put -t ext2) and then a format command which when i ran it produced the following:<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;<strong>ubiformat: mtd3 (nand), size 27262976 bytes (26.0 MiB), 208 eraseblocks of 131072 bytes (128.0 KiB), min. I/O size 2048 bytes<br />&nbsp; &nbsp;libscan: scanning eraseblock 207 -- 100 % complete<br />&nbsp; &nbsp;ubiformat: 43 eraseblocks are supposedly empty<br />&nbsp; &nbsp;ubiformat: <span style="color: #FF0000">warning!: 165 of 208 eraseblocks contain non-UBI data</span><br />&nbsp; &nbsp;ubiformat: continue? (y/N) N<br />&nbsp; &nbsp;</strong><br />&nbsp; &nbsp;And as you can see i did not go ahead since i was not sure if this was expected or not. <br />&nbsp; &nbsp;After investigating without finding any clear explanation I decided to go ahead because there was a statement somewhere that this might be expected (the warning).<br />&nbsp; &nbsp;There were some more warnings and I proceeded with the next format (did not use the one liner &amp;&amp;, just ran it separetly).<br />&nbsp; &nbsp;That went well, no warnings, so now it was the critical point before the erase kernel (mentioned on the instructions with a warm &quot;your f&#039;ed&quot; if there&#039;s errors before...I had only warnings so..).<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;I decided to go ahead with the kernel erase:<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;<strong>root@OpenWrt:/sda1# mtd erase kernel<br />&nbsp; &nbsp;<span style="color: #FF0000">Could not open mtd device: kernel<br />&nbsp; &nbsp;Could not open mtd device: kernel</span><br />&nbsp; &nbsp;</strong><br />&nbsp; &nbsp;after some investigation about mtd I ran a command to list the mtd &quot;partitions&quot; </p><p>&nbsp; &nbsp;<strong>root@OpenWrt:/sda1# cat /proc/mtd<br />&nbsp; &nbsp;dev:&nbsp; &nbsp; size&nbsp; &nbsp;erasesize&nbsp; name<br />&nbsp; &nbsp;mtd0: 00080000 00020000 &quot;u-boot&quot;<br />&nbsp; &nbsp;mtd1: 00020000 00020000 &quot;u_env&quot;<br />&nbsp; &nbsp;mtd2: 00020000 00020000 &quot;s_env&quot;<br />&nbsp; &nbsp;mtd3: 01a00000 00020000 &quot;kernel1&quot;<br />&nbsp; &nbsp;mtd4: 01760000 00020000 &quot;rootfs1&quot;<br />&nbsp; &nbsp;mtd5: 01a00000 00020000 &quot;kernel2&quot;<br />&nbsp; &nbsp;mtd6: 01760000 00020000 &quot;ubi&quot;<br />&nbsp; &nbsp;mtd7: 04a00000 00020000 &quot;syscfg&quot;</strong></p><p>&nbsp; &nbsp;At this point I looked at the flash layout on the instructions page and on both of them (stock and openWRT recommended) and on both the kernel mtd match the same address as kernel1 on my mtd list.<br />&nbsp; &nbsp;I decided to go ahead and use &quot;kernel1&quot; without noticing that I already had formated mtd3 on the previous commands (what an idiot!).<br />&nbsp; &nbsp;Everything went well for the remaning commands.<br />&nbsp; &nbsp;I unmounted the pen and removed it just before the reboot.<br />&nbsp; &nbsp;This is where it went wrong because the router never came up again. Lights ok on the ethernet connection , the cisco bright with logo on top , dead as door nail...<br />&nbsp; &nbsp;At this point I thought to my self well...I can still try to boot the pen as mentioned in the instructions.<br />&nbsp; &nbsp;Turned power off, inserted pen, power on.....voila&#039; it booted...but now I got what I should have got with the first pen boot...the <strong>Designated driver</strong> build from <strong>uImage</strong> file.<br />&nbsp; &nbsp;I immeadiatly proceed to check mtd (because I noticed the double mtd3 burn I performed) and showed:<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;<strong>dev:&nbsp; &nbsp; size&nbsp; &nbsp;erasesize&nbsp; name<br />&nbsp; &nbsp;mtd0: 00080000 00020000 &quot;u-boot&quot;<br />&nbsp; &nbsp;mtd1: 00020000 00020000 &quot;u-boot environment&quot;<br />&nbsp; &nbsp;mtd2: 00200000 00020000 &quot;kernel&quot;<br />&nbsp; &nbsp;mtd3: 01c00000 00020000 &quot;root&quot;<br /></strong><br />&nbsp; &nbsp;So now this made sense , since kernel is now alone (no 1 or 2) and mtd3 is root.<br />&nbsp; &nbsp;This is the layout that is expected when you boot from the usb pen that should happened before and didn&#039;t.<br />&nbsp; &nbsp;I reformatted mtd3 again (and wrote the ubi image), removed the pen and rebooted.<br />&nbsp; &nbsp;It came back to designated driver again but now from NAND (since I removed the pen before reboot).<br />&nbsp; &nbsp;There was no Luci (web console), I tried changing the password and reboot , but it came back again and the password change did not stick.<br />&nbsp; &nbsp;I tried to set an IP address for my local network (I worked always with direct cable from my pc until now) and disabled DHCP using VI and config files (/etc/config/network and /etc/config/dhcp).<br />&nbsp; &nbsp;After reboot nothing was sticking, no IP , no password , SSH keys being generated anew with SSH complaining..<br />&nbsp; &nbsp;I noticed that running <strong>df</strong> only showed <strong>tmpfs</strong> file system listed twice for mount points <strong>/tmp</strong> and <strong>/dev</strong><br />&nbsp; &nbsp;After some reboots with same outcome I decided to do a power OFF.<br />&nbsp; &nbsp;After power ON I could not login to SSH because it was not accepting any password. Telnet was not available.<br />&nbsp; &nbsp;I decided to try via http and to my surprise Chaos Calmer&nbsp; came in (designated driver version was gone)and Luci was available.<br />&nbsp; &nbsp;Luci was stating that there was no password set, so i set it, rebooted and now i could login with SSH.<br />&nbsp; &nbsp;From now on I changed the IP, moved to my local network and everything is sticking after Chaos Calmer appeared.<br />&nbsp; &nbsp;Checked with <strong>df</strong> and had rootfs and <strong>ubi0:rootfs</strong> and also the 2 <strong>tmpfs</strong>.<br />&nbsp; &nbsp;</p><p><span style="color: blue"><strong>(1)</strong></span> link that I sent you before about wiki instructions: <a href="http://wiki.openwrt.org/toh/linksys/ea4500">http://wiki.openwrt.org/toh/linksys/ea4500</a>&nbsp; <br /><span style="color: blue"><strong>(2)</strong></span> link that you sent me before with Fiona&#039;s build: <a href="https://mega.nz/#!bNAhDI6S!PZQTb8X4XxOfBAuV61L8t5RqBNAdgnr0jtSSk6za9uc">https://mega.nz/#!bNAhDI6S!PZQTb8X4XxOf … tSSk6za9uc</a> <br />&nbsp; &nbsp; &nbsp; &nbsp;Fiona&#039;s Claudio&#039;s based build shows: <strong>CHAOS CALMER (Bleeding Edge, unknown)</strong><br /><span style="color: blue"><strong>(3)</strong></span> Project deprecated, old repo, no ready to flash imgs: <a href="http://www.wolfteck.com/projects/candyhouse/openwrt/">http://www.wolfteck.com/projects/candyhouse/openwrt/</a> <br /><span style="color: blue"><strong>(4)</strong></span> uImage <a href="http://cloud.directupload.net/1AhK">http://cloud.directupload.net/1AhK</a><br />&nbsp; &nbsp; &nbsp; &nbsp;uImage booting from Usb shows : <strong>DESIGNATED DRIVER (Bleeding Edge, r47048)</strong><br /><span style="color: blue"><strong>(5)</strong></span> Chaos Calmer on OpenWrt builds : <a href="https://downloads.openwrt.org/chaos_calmer/15.05/kirkwood/generic/">https://downloads.openwrt.org/chaos_cal … d/generic/</a><br />&nbsp; &nbsp; &nbsp; &nbsp;Chaos calmer after sucessfully installed shows: <strong>CHAOS CALMER (15.05, r46767)</strong></p>											<p class="post-edited">(Last edited by <strong>joni</strong> on 1 Nov 2015, 23:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298286">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">joni</div>
					<div class="post-datetime">
						1 Nov 2015, 23:12					</div>
				</div>
				<div class="post-content content">
					<p>Here&#039;s the action log. A lot of testing commands I used are not here but the essential is.</p><div class="codebox"><pre><code> === IMPORTANT ============================
  Use &#039;passwd&#039; to set your login password
  this will disable telnet and enable SSH
 ------------------------------------------


BusyBox v1.23.2 (2015-09-09 11:08:31 BST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (Bleeding Edge, unknown)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/#
root@OpenWrt:/# fw_setenv bootcmd &#039;run owrt_usb; run nandboot&#039;
root@OpenWrt:/# fw_setenv owrt_usb &#039;usb start; sleep 5;ext2load usb 0:1 ${loadad
dr} /uImage; setenv bootargs $(console) $(mtdparts) root=/dev/ram rw; bootm ${lo
adaddr}&#039;
root@OpenWrt:/# mkdir /sda1 &amp;&amp; mount /dev/sda1 /sda1
NTFS signature is missing.
Failed to mount &#039;/dev/sda1&#039;: Invalid argument
The device &#039;/dev/sda1&#039; doesn&#039;t seem to have a valid NTFS.
Maybe the wrong device is used? Or the whole disk instead of a
partition (e.g. /dev/sda, not /dev/sda1)? Or the other way around?

BusyBox v1.23.2 (2015-09-09 11:08:31 BST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (Bleeding Edge, unknown)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/# ls
bin      etc      mnt      proc     root     sda1     tmp      var
dev      lib      overlay  rom      sbin     sys      usr      www
root@OpenWrt:/# mount -t ext2 /dev/sda1 /sda1
root@OpenWrt:/# cd sda1
root@OpenWrt:/sda1# ubiformat /dev/mtd3
ubiformat: mtd3 (nand), size 27262976 bytes (26.0 MiB), 208 eraseblocks of 131072 bytes (128.0 KiB), min. I/O size 2048 bytes
libscan: scanning eraseblock 207 -- 100 % complete
ubiformat: 43 eraseblocks are supposedly empty
ubiformat: warning!: 165 of 208 eraseblocks contain non-UBI data
ubiformat: continue? (y/N) N
root@OpenWrt:/sda1#


 === IMPORTANT ============================
  Use &#039;passwd&#039; to set your login password
  this will disable telnet and enable SSH
 ------------------------------------------


BusyBox v1.23.2 (2015-09-09 11:08:31 BST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (Bleeding Edge, unknown)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:/# mount -t ext2 /dev/sda1 /sda1
root@OpenWrt:/# cd /sda1
root@OpenWrt:/sda1# ls -l
drwx------    2 root     root         12288 Nov  1  2015 lost+found
-rw-r--r--    1 root     root       5505024 Sep 14  2015 openwrt-15.05-kirkwood-ea4500-rootfs.ubi
-rw-r--r--    1 root     root       1591838 Sep 14  2015 openwrt-15.05-kirkwood-ea4500-uImage
-rw-r--r--    1 root     root       3505278 Oct 31  2015 uImage
root@OpenWrt:/sda1# ubiformat /dev/mtd3
ubiformat: mtd3 (nand), size 27262976 bytes (26.0 MiB), 208 eraseblocks of 131072 bytes (128.0 KiB), min. I/O size 2048 bytes
libscan: scanning eraseblock 207 -- 100 % complete
ubiformat: 43 eraseblocks are supposedly empty
ubiformat: warning!: 165 of 208 eraseblocks contain non-UBI data
ubiformat: continue? (y/N) y
ubiformat: warning!: only 0 of 208 eraseblocks have valid erase counter
ubiformat: erase counter 0 will be used for all eraseblocks
ubiformat: note, arbitrary erase counter value may be specified using -e option
ubiformat: continue? (y/N) y
ubiformat: use erase counter 0 for all eraseblocks
ubiformat: formatting eraseblock 207 -- 100 % complete
ubiformat: mtd3 (nand), size 27262976 bytes (26.0 MiB), 208 eraseblocks of 131072 bytes (128.0 KiB), min. I/O size 2048 bytes
libscan: scanning eraseblock 207 -- 100 % complete
ubiformat: 208 eraseblocks have valid erase counter, mean value is 0
root@OpenWrt:/sda1# ubiformat /dev/mtd3 -f openwrt-15.05-kirkwood-ea4500-rootfs.ubi
ubiformat: mtd3 (nand), size 27262976 bytes (26.0 MiB), 208 eraseblocks of 131072 bytes (128.0 KiB), min. I/O size 2048 bytes
libscan: scanning eraseblock 207 -- 100 % complete
ubiformat: 208 eraseblocks have valid erase counter, mean value is 0
ubiformat: flashing eraseblock 41 -- 100 % complete
ubiformat: formatting eraseblock 207 -- 100 % complete
root@OpenWrt:/sda1#
root@OpenWrt:/sda1#
root@OpenWrt:/sda1# mtd erase kernel
Could not open mtd device: kernel
Could not open mtd device: kernel
root@OpenWrt:/sda1# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00080000 00020000 &quot;u-boot&quot;
mtd1: 00020000 00020000 &quot;u_env&quot;
mtd2: 00020000 00020000 &quot;s_env&quot;
mtd3: 01a00000 00020000 &quot;kernel1&quot;
mtd4: 01760000 00020000 &quot;rootfs1&quot;
mtd5: 01a00000 00020000 &quot;kernel2&quot;
mtd6: 01760000 00020000 &quot;ubi&quot;
mtd7: 04a00000 00020000 &quot;syscfg&quot;
root@OpenWrt:/sda1# mtd erase kernel1
Unlocking kernel1 ...
Erasing kernel1 ...
root@OpenWrt:/sda1# mtd write openwrt-15.05-kirkwood-ea4500-uImage kernel1
Unlocking kernel1 ...

Writing from openwrt-15.05-kirkwood-ea4500-uImage to kernel1 ...
root@OpenWrt:/sda1# fw_setenv owrt_usb &#039;usb start; sleep 5;ext2load usb 0:1 ${loadaddr} /uImage; setenv bootargs $(console)
root=/dev/ram rw; bootm ${loadaddr}&#039;
root@OpenWrt:/sda1# fw_setenv owrt_boot &#039;nand read.e ${loadaddr} 0x200000 0x200000; setenv bootargs $(console) ubi.mtd=3 roo
t=ubi0:rootfs rootfstype=ubifs rw; bootm ${loadaddr}&#039;
root@OpenWrt:/sda1# fw_setenv auto_recovery no
root@OpenWrt:/sda1# cd /
root@OpenWrt:/# umount /sda1
root@OpenWrt:/sda1# reboot


login as: root


BusyBox v1.23.2 (2015-09-25 23:29:19 CEST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 DESIGNATED DRIVER (Bleeding Edge, r47048)
 -----------------------------------------------------
  * 2 oz. Orange Juice         Combine all juices in a
  * 2 oz. Pineapple Juice      tall glass filled with
  * 2 oz. Grapefruit Juice     ice, stir well.
  * 2 oz. Cranberry Juice
 -----------------------------------------------------
root@OpenWrt:~# mkdir /sda1 &amp;&amp; mount /dev/sda1 /sda1
root@OpenWrt:~# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00080000 00020000 &quot;u-boot&quot;
mtd1: 00020000 00020000 &quot;u-boot environment&quot;
mtd2: 00200000 00020000 &quot;kernel&quot;
mtd3: 01c00000 00020000 &quot;root&quot;
root@OpenWrt:~# ubiformat /dev/mtd3
ubiformat: mtd3 (nand), size 29360128 bytes (28.0 MiB), 224 eraseblocks of 131072 bytes (128.0 KiB), min. I/O size 2048 bytes
libscan: scanning eraseblock 223 -- 100 % complete
ubiformat: 11 eraseblocks have valid erase counter, mean value is 1
ubiformat: 192 eraseblocks are supposedly empty
ubiformat: warning!: 21 of 224 eraseblocks contain non-UBI data
ubiformat: continue? (y/N) y
ubiformat: warning!: only 11 of 224 eraseblocks have valid erase counter
ubiformat: erase counter 0 will be used for all eraseblocks
ubiformat: note, arbitrary erase counter value may be specified using -e option
ubiformat: continue? (y/N) y
ubiformat: use erase counter 0 for all eraseblocks
ubiformat: formatting eraseblock 223 -- 100 % complete
root@OpenWrt:~# cd /sda1
root@OpenWrt:/sda1# ubiformat /dev/mtd3 -f openwrt-15.05-kirkwood-ea4500-rootfs.
ubi
ubiformat: mtd3 (nand), size 29360128 bytes (28.0 MiB), 224 eraseblocks of 131072 bytes (128.0 KiB), min. I/O size 2048 bytes
libscan: scanning eraseblock 223 -- 100 % complete
ubiformat: 224 eraseblocks have valid erase counter, mean value is 0
ubiformat: flashing eraseblock 41 -- 100 % complete
ubiformat: formatting eraseblock 223 -- 100 % complete
root@OpenWrt:/sda1# mtd erase kernel
Unlocking kernel ...
Erasing kernel ...
root@OpenWrt:/sda1# mtd write openwrt-15.05-kirkwood-ea4500-uImage kernel
Unlocking kernel ...

Writing from openwrt-15.05-kirkwood-ea4500-uImage to kernel ...
root@OpenWrt:/sda1# fw_setenv bootcmd &#039;run owrt_usb; run owrt_boot&#039;
root@OpenWrt:/sda1# fw_setenv owrt_usb &#039;usb start; sleep 5;ext2load usb 0:1 ${loadaddr} /uImage; setenv bootargs $(console) root=/dev/ram rw; bootm ${loadaddr}&#039;
root@OpenWrt:/sda1# fw_setenv owrt_boot &#039;nand read.e ${loadaddr} 0x200000 0x200000; setenv bootargs $(console) ubi.mtd=3 root=ubi0:rootfs rootfstype=ubifs rw; bootm ${loadaddr}&#039;
root@OpenWrt:/sda1# fw_setenv auto_recovery no
root@OpenWrt:~# cd /
root@OpenWrt:/# umount /sda1
root@OpenWrt:/# reboot
root@OpenWrt:/#
TRIED LUCI ,connection refused.....then changed password and reboot

BusyBox v1.23.2 (2015-09-25 23:29:19 CEST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 DESIGNATED DRIVER (Bleeding Edge, r47048)
 -----------------------------------------------------
  * 2 oz. Orange Juice         Combine all juices in a
  * 2 oz. Pineapple Juice      tall glass filled with
  * 2 oz. Grapefruit Juice     ice, stir well.
  * 2 oz. Cranberry Juice
 -----------------------------------------------------
root@OpenWrt:~#
root@OpenWrt:~# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00080000 00020000 &quot;u-boot&quot;
mtd1: 00020000 00020000 &quot;u-boot environment&quot;
mtd2: 00200000 00020000 &quot;kernel&quot;
mtd3: 01c00000 00020000 &quot;root&quot;
root@OpenWrt:~# passwd
Changing password for root
New password:
Bad password: too weak
Retype password:
Password for root changed by root
login as: root
root@192.168.1.1&#039;s password:


BusyBox v1.23.2 (2015-07-24 20:06:02 CEST) built-in shell (ash)

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 CHAOS CALMER (15.05, r46767)
 -----------------------------------------------------
  * 1 1/2 oz Gin            Shake with a glassful
  * 1/4 oz Triple Sec       of broken ice and pour
  * 3/4 oz Lime Juice       unstrained into a goblet.
  * 1 1/2 oz Orange Juice
  * 1 tsp. Grenadine Syrup
 -----------------------------------------------------
root@OpenWrt:~#
root@OpenWrt:~# cat /proc/mtd
dev:    size   erasesize  name
mtd0: 00080000 00020000 &quot;u-boot&quot;
mtd1: 00020000 00020000 &quot;u-boot environment&quot;
mtd2: 00200000 00020000 &quot;kernel&quot;
mtd3: 01c00000 00020000 &quot;root&quot;
root@OpenWrt:~# df
Filesystem           1K-blocks      Used Available Use% Mounted on
rootfs                   21684      3416     18268  16% /
ubi0:rootfs              21684      3416     18268  16% /
tmpfs                    62720       524     62196   1% /tmp
tmpfs                      512         0       512   0% /dev
root@OpenWrt:~# df -h
Filesystem                Size      Used Available Use% Mounted on
rootfs                   21.2M      3.3M     17.8M  16% /
ubi0:rootfs              21.2M      3.3M     17.8M  16% /
tmpfs                    61.3M    524.0K     60.7M   1% /tmp
tmpfs                   512.0K         0    512.0K   0% /dev
root@OpenWrt:~# free
             total         used         free       shared      buffers
Mem:        125440        19896       105544          524            0
-/+ buffers:              19896       105544
Swap:            0            0            0
</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298633">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">joni</div>
					<div class="post-datetime">
						4 Nov 2015, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>I got a new EA4500 (at a ridiculous cheap price) and I decided to keep stock firmware for now for some tests.<br />The previous had the same exact stock version which is <strong>2.1.42.162351</strong><br />I have both configured with Wifi 5Ghz and both are working fine.<br />The setup is:<br />CISCO 1 (OpenWrt) : ch 36 (5.180 GHz) Tx-Power 10dBm ch width 40MHz<br />CISCO 2 (Stock): ch&nbsp; 44 (5.220 GHz) Tx-Power ? ch width 40MHz</p><p>note:&nbsp; I have nobody else in 5GHz.&nbsp; 2.4GHz is crowded.</p><p>let me know how you are testing Throughput so i can try to reproduce</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304479">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">droo</div>
					<div class="post-datetime">
						21 Dec 2015, 11:13					</div>
				</div>
				<div class="post-content content">
					<p>Joni,</p><p>Am I right that your method above would let me get from my current Trunk image to a working STABLE image ?</p><p>I have posted my question here :- <a href="https://forum.openwrt.org/viewtopic.php?id=61667">https://forum.openwrt.org/viewtopic.php?id=61667</a></p><p>Many Thanks for your efforts !</p><p>Drew</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304481">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">joni</div>
					<div class="post-datetime">
						21 Dec 2015, 12:35					</div>
				</div>
				<div class="post-content content">
					<p>Hi Drew, </p><p> If you are already running openwrt, you should use the sysupgrade images. <br /> Problem is that the stable image (Chaos Calmer) is an UBIFS instead of SQUASHFS ( UBIFS should be the best to use for this router who uses NAND flash) and i don&#039;t know the upgrade procedure for that (to go from Designated Driver trunk SquashFS to Chaos Calmer Stable UBIFS). Also don&#039;t forget that this is a downgrade since you are trying to go from an higher version (Designated driver) which now has full support for EA4500 to a lower (Chaos Calmer) that does not totally support this router (main issues are with unsupported wifi chipsets). I&#039;m currently running the chaos calmer stable (UbiFS) and the only problem i have (considering I don&#039;t care about wireless) is that every time I reboot the router either from command line or from the GUI, it crashes and requires an power off/on to boot again.<br />the OpenWrt page for this router&nbsp; (<a href="https://wiki.openwrt.org/toh/linksys/ea4500">https://wiki.openwrt.org/toh/linksys/ea4500</a>) mentions the steps to build the trunk and i would like to build an image but with UBIFS format, but the build system is something that I did not install yet and i also don&#039;t have enough linux skills to do it. For now i guess I will wait for the Designated Driver Stable version to come out since like yourself i would like to install Packages. I read somewhere that you can safely ignore the dependency errors somehow and have the packages installed, maybe you should investigate this. <br /> If you can , please test the reboot on that Designated Driver trunk you are running (run <strong>reboot</strong> at the command line) and let me know if it works).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304494">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">droo</div>
					<div class="post-datetime">
						21 Dec 2015, 15:34					</div>
				</div>
				<div class="post-content content">
					<p>Joni,</p><p>Will test the reboot tonight, but from what I recall it does indeed work.</p><p>So my problem still seems to be how do I get packages to apply on my build - maybe running the versions I am would be better than the &quot;downgraded&quot; STABLE one.</p><p>Regards,</p><p>Drew.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304501">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">leitec</div>
					<div class="post-datetime">
						21 Dec 2015, 16:55					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>joni wrote:</cite><blockquote><p>Problem is that the stable image (Chaos Calmer) is an UBIFS instead of SQUASHFS ( UBIFS should be the best to use for this router who uses NAND flash)</p></blockquote></div><p>The squashfs image for NAND is squashfs on an UBI block volume, so it&#039;s appropriate for use on NAND. UBI takes care of bad blocks, wear leveling, etc.</p><p>The read/write overlay is UBIFS. This seems to be the preferred setup for OpenWrt on NAND these days.</p><div class="quotebox"><blockquote><p>Also don&#039;t forget that this is a downgrade since you are trying to go from an higher version (Designated driver) which now has full support for EA4500 to a lower (Chaos Calmer) that does not totally support this router (main issues are with unsupported wifi chipsets).</p></blockquote></div><p>There are some differences between the mwl8k driver in the two versions, but they appear to be minor. The firmware provided with both is identical. Are you seeing distinct and reproducible differences in performance?</p><p>Also, it should be straightforward to backport the patches that added full support for DD to CC. That would give you easily flashable images for the old version.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304503">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">droo</div>
					<div class="post-datetime">
						21 Dec 2015, 17:24					</div>
				</div>
				<div class="post-content content">
					<p>leitec,</p><p>You sound like you know your stuff (unlike me) I am currently building a new image from source to attempt and upgrade !</p><p>is there any reason a flushable version for the EA4500 is not provided, or is it just a case no one built one as the more experienced people know what they are doing and theres no need for one ?</p><p>Drew.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304514">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">leitec</div>
					<div class="post-datetime">
						21 Dec 2015, 18:44					</div>
				</div>
				<div class="post-content content">
					<p>There&#039;s definitely a flashable snapshot for DD:</p><p><a href="https://downloads.openwrt.org/snapshots/trunk/kirkwood/generic/">https://downloads.openwrt.org/snapshots … d/generic/</a></p><p>&quot;linksys-viper&quot; is the EA4500/E4200v2. The code to build that image wasn&#039;t there yet for CC.</p>											<p class="post-edited">(Last edited by <strong>leitec</strong> on 21 Dec 2015, 18:48)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304515">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">droo</div>
					<div class="post-datetime">
						21 Dec 2015, 18:57					</div>
				</div>
				<div class="post-content content">
					<p>leitec,</p><p>If I apply the latest sysupdate file do you think I might then be able to install the openvpn package ?</p><p>The error I am trying to overcome is :- <a href="http://imgur.com/L6aDOPo">http://imgur.com/L6aDOPo</a></p><p>My current build is :- OpenWrt Designated Driver r47197 / LuCI squashfs Branch (git-15.310.28416-524c918)</p><p>Drew.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304518">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">leitec</div>
					<div class="post-datetime">
						21 Dec 2015, 19:17					</div>
				</div>
				<div class="post-content content">
					<p>Yes, it should install. The packages and images in the snapshot directory are built daily. There are enough changes on a regular basis to break package installs after some time. You can install everything right when you upgrade, or build an image from source that already includes the packages you need.</p><p>Edit: that image you&#039;re running now might be old enough that you should flash the factory firmware first, then flash with <a href="https://downloads.openwrt.org/snapshots/trunk/kirkwood/generic/openwrt-kirkwood-linksys-viper-squashfs-factory.bin">https://downloads.openwrt.org/snapshots … actory.bin</a> . The board name changed from ea4500 to linksys-viper, which will prevent sysupgrade from accepting the .tar image.</p>											<p class="post-edited">(Last edited by <strong>leitec</strong> on 21 Dec 2015, 19:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304521">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">droo</div>
					<div class="post-datetime">
						21 Dec 2015, 19:29					</div>
				</div>
				<div class="post-content content">
					<p>Ah i didnt think you could actually flash a factory file on to an already installed openwrt ?</p><p>Drew</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304557">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">leitec</div>
					<div class="post-datetime">
						21 Dec 2015, 22:47					</div>
				</div>
				<div class="post-content content">
					<p>If you&#039;re running something from my old Github repo or DD snapshot it will work. I&#039;ve tested it several times with the original FW_&lt;whatever&gt;.SSA images. I don&#039;t think the Candyhouse OpenWrt supported sysupgrade at all, though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304606">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">##</div>
					<div class="post-datetime">
						22 Dec 2015, 11:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I flashed my EA4500 with <a href="https://downloads.openwrt.org/snapshots/trunk/kirkwood/generic/openwrt-kirkwood-linksys-viper-squashfs-factory.bin,">https://downloads.openwrt.org/snapshots … ctory.bin,</a> and now can&#039;t login via web browser. I can only access it through ssh. Is there any way to restore original firmware?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p304630">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">droo</div>
					<div class="post-datetime">
						22 Dec 2015, 16:45					</div>
				</div>
				<div class="post-content content">
					<p>you need to install LuCI - <a href="https://wiki.openwrt.org/doc/howto/luci.essentials">https://wiki.openwrt.org/doc/howto/luci.essentials</a></p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=60649&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>