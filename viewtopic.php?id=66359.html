<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> U-boot and Kernel image.</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 23 Apr 2018 and 6 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=66359&amp;p=2.html">2</a></li></ul></nav></div>
			
		
		
			<article class="post" id="p332265">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						20 Jul 2016, 14:39					</div>
				</div>
				<div class="post-content content">
					<p>I am new to Openwrt firmware. My target chipset is RT5350. I know that Openwrt Buildroot can create cross-compile toolchain and root filesystem. How do I create the U-boot and kernel image ? </p><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332327">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						21 Jul 2016, 07:37					</div>
				</div>
				<div class="post-content content">
					<p>Openwrt create kernel, rootfs and firmware (contain u-boot header+kernel+rootfs) binary files for supported devices. It don&#039;t build u-boot for ralink/mediatek routers. Bootloader (u-boot) may be compiled using ralink/mediatek SDK.<br />Or you ask how to compile complete firmware for new device?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332328">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						21 Jul 2016, 07:50					</div>
				</div>
				<div class="post-content content">
					<p>It will be great if you tell about compiling complete firmware for the device. </p><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332338">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						21 Jul 2016, 10:49					</div>
				</div>
				<div class="post-content content">
					<p>Ok. I&#039;ll try to help.<br />Starting from BB 14.07 (openwrt Barrier Braker 14.07 release) you can build firmware for fully supported device (rt5350 is ok) without compiling source. Just use ImageBuilder. I describe IB&nbsp; CC 15.05.1 release.<br />After installing IB for rt305x you need create/modify some files:<br />1. Create target/linux/ramips/dts/YOU-ROUTER.dts - to describe your hardware (flash type/size/layout, buttons and leds, embedded switch wan/lan layout/mac and etc).<br />2. Modify target/linux/ramips/image/Makefile - to define rules for building firmware binary file.<br />3. Create target/linux/ramips/rt305x/profiles/your-router.mk - to define which packages to include into firmware.<br />4. Modify target/linux/ramips/base-files/lib/ramips.sh - to add your board identification.<br />5. Modify target/linux/ramips/base-files/lib/upgrade/platform.sh - to add your board to known for update.<br />6. Modify target/linux/ramps/base-files/etc/diag.sh - if your board have status LED.<br />7. Modify target/linux/ramps/base-files/etc/board.d/01_leds - if your board have other LED which openwrt can use (wifi, usb).<br />8. Modify target/linux/ramps/base-files/etc/board.d/02_network - if your board have specific network settings.<br />9. Create firmware binary file with IB commad:<br /></p><div class="codebox"><pre><code>make image PROFILE=your-profile FILES=target/linux/ramips/base-files</code></pre></div><p> and get ready image in bin/ramips directory.<br />Steps 5-8 are optional.</p><p>But 0 step - you need to know how to recover your device at any firmware error. It&#039;s good to have u-boot command line serial console or at least your u-boot should support so called emergency recover (possibility to flash new firmware if current firmware is broken).</p><p>If any question?</p>											<p class="post-edited">(Last edited by <strong>123serge123</strong> on 29 Jul 2016, 05:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332348">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						21 Jul 2016, 13:44					</div>
				</div>
				<div class="post-content content">
					<p>Ok. </p><p>I have an Ubuntu-mate-14.04.2 LTS OS as a VM in Virtual Box. From the reading, I shall have to use Debian 8(Sussie) with a hard disk size of 60 GB on a Virtual Box. I shall also need a 64-bit machine for host Linux for Image Generator.</p><p><a href="https://wiki.openwrt.org/doc/howto/obtain.firmware.generate">https://wiki.openwrt.org/doc/howto/obta … e.generate</a></p><p>From this link, I will install Image generator and Chaos Calmer 15.05.1</p><br /><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332351">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						21 Jul 2016, 14:04					</div>
				</div>
				<div class="post-content content">
					<p>Yes, you need 64-bit machine. But for use IB no need too much memory. My IB&nbsp; use about 5GB (with packages).<br />And wiki don&#039;t explain how to build firmware for new board <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332354">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						21 Jul 2016, 14:32					</div>
				</div>
				<div class="post-content content">
					<p>Do you suggest Debian 8 (Sussie) for IB, Which one you are using, I might install that one.</p><p>Rgds,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332358">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						21 Jul 2016, 14:58					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m using old Ubuntu 12.04 32bit and compile IB by myself.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332569">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						25 Jul 2016, 14:44					</div>
				</div>
				<div class="post-content content">
					<p>I am planning to have a hardware of:<br /> External Flash: 8MB (MX25L6405D)<br /> External SDRAM: 32MB (ESMT M12L2561616A)<br /> Wifi: Integrated 802.11b/g/n<br />MicroSD interface for memory card<br />USB: Integrated USB 2.0 Host</p><p>This hardware is similar with HooToo TM-02 device. </p><p>From the step 1, Can I use HooToo TM-02&#039;s dts file(HT-TM02.dts) as reference? Can I use it without changes as I donot know how to edit this file at present. The file has &quot;mx25l6405d&quot; references, which mean it support that chip. If we donot find the exact chipset in stock to use in our board, can I use a different chip name here having same memory size(8MB). There is no mention of SDRAM chip in this file, Is there a different location for it?</p><br /><p>To do the steps 6,7,8, I donot have a folder&nbsp; target/linux/ramps/etc. The /etc folder is missing in my Image Builder directory.</p><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332775">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						27 Jul 2016, 12:57					</div>
				</div>
				<div class="post-content content">
					<p>Okey.</p><p>I am currently using the profile HT-TM02. This device support USB interface, which I wish to test on my board. I am currently not considering testing micro-SD interface.</p><p>I am able to find the diag.sh, 01_leds, 02_network files in target/linux/ramips/base-files/etc folder( steps 6 to 8), it was a typo when you were entering the full folder path <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>My command was:</p><div class="codebox"><pre><code>make image PROFILE=HT-TM02</code></pre></div><p>It generate files in bin/ramips directory.</p><p>The current main files are:<br />openwrt-15.05.1-ramips-rt305x-uImage.bin<br />openwrt-15.05.1-ramips-rt305x-vmlinux.bin<br />openwrt-15.05.1-ramips-rt305x-vmlinux.elf<br />openwrt-15.05.1-ramips-rt305x-root.squashfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />openwrt-15.05.1-ramips-rt305x-ht-tm02-squashfs-sysupgrade.bin </p><p>Can you explain about these images, uImage.bin and vmlinux.bin are kernel images as I know.<br />There is no u-boot generated in this folder I suppose.<br />openwrt-15.05.1-ramips-rt305x-root.squashfs seem to be the file system.</p><p>Using flashrom software and ARM-USB-OCD(<a href="https://www.olimex.com/Products/ARM/JTAG/ARM-USB-OCD/">https://www.olimex.com/Products/ARM/JTAG/ARM-USB-OCD/</a>), I can program a u-boot to internal flash of the processor?</p><p>Rgds,</p>											<p class="post-edited">(Last edited by <strong>pradeepsysargus</strong> on 27 Jul 2016, 13:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332793">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						27 Jul 2016, 14:48					</div>
				</div>
				<div class="post-content content">
					<p>The Image Generator command given creates the same files as <a href="https://downloads.openwrt.org/chaos_calmer/15.05.1/ramips/rt305x/">here</a>. And in all likelihood they do not contain the <em>kmod</em> packages necessary for USB support.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332903">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						29 Jul 2016, 06:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pradeepsysargus wrote:</cite><blockquote><p> From the step 1, Can I use HooToo TM-02&#039;s dts file(HT-TM02.dts) as reference?</p></blockquote></div><p>Why not?<br /></p><div class="quotebox"><blockquote><p>The file has &quot;mx25l6405d&quot; references, which mean it support that chip. If we donot find the exact chipset in stock to use in our board, can I use a different chip name here having same memory size(8MB).</p></blockquote></div><p>Linux kernel spi-flash driver autodetect chip type. It can recognize practically all chipset in stock.<br /></p><div class="quotebox"><blockquote><p>There is no mention of SDRAM chip in this file, Is there a different location for it?</p></blockquote></div><p>Don&#039;t worry. It&#039;s a responsibility of bootloader (u-boot) to determine type and size of RAM </p><div class="quotebox"><blockquote><p>To do the steps 6,7,8, I donot have a folder&nbsp; target/linux/ramps/etc. The /etc folder is missing in my Image Builder directory.</p></blockquote></div><p>My mistake. I&#039;ve corrected prev post.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332904">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						29 Jul 2016, 06:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pradeepsysargus wrote:</cite><blockquote><p>openwrt-15.05.1-ramips-rt305x-uImage.bin<br />openwrt-15.05.1-ramips-rt305x-vmlinux.bin<br />openwrt-15.05.1-ramips-rt305x-vmlinux.elf<br />openwrt-15.05.1-ramips-rt305x-root.squashfs&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />openwrt-15.05.1-ramips-rt305x-ht-tm02-squashfs-sysupgrade.bin</p></blockquote></div><p>First three files are used for testing/debugging usually. It&#039;s difficult to describe its briefly. Last two files are root filesystem and firmware (u-boot header+kernel+root filesystem) images.&nbsp; <br /></p><div class="quotebox"><blockquote><p>Using flashrom software and ARM-USB-OCD(<a href="https://www.olimex.com/Products/ARM/JTAG/ARM-USB-OCD/">https://www.olimex.com/Products/ARM/JTAG/ARM-USB-OCD/</a>), I can program a u-boot to internal flash of the processor?</p></blockquote></div><p>Yes. With help of external flash programmer you can read/write any part of flash chip including u-boot, u-boot env, factory and firmware.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332907">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						29 Jul 2016, 07:58					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the replies.</p><p>I need to generate an u-boot Image also I suppose.</p><p><a href="http://www.dnclabs.com/?p=1329">http://www.dnclabs.com/?p=1329</a> <br /><a href="http://www.dnclabs.com/?p=1321">http://www.dnclabs.com/?p=1321</a></p><p>From the above links, there are steps to download u-boot sources, download mips-cross compiler.<br />He adds his Flash chip set information in a file spi_flash.c in U-boot drivers. He uses &#039;make distclean&#039;, &#039;make menuconfig&#039; - chooses RT chipset and SDRAM size here and finally &#039;make&#039;. </p><p>He is using a 32-bit host computer as the Ralink SDK toolchain is already compiled for a 32-bit architecture.</p><p>I get a uboot.img file after compilation.</p><div class="quotebox"><blockquote><p>With help of external flash programmer you can read/write any part of flash chip including u-boot, u-boot env, factory and firmware.</p></blockquote></div><p>How do I program u-boot and uImage files at different partition using programmer?<br />All I know is the command,</p><div class="codebox"><pre><code>flashrom -p ft2232_spi:type=arm-usb-ocd -w uboot.img</code></pre></div><p>There is no mention of address where the uboot.img file will be programmed. If I wish to program a uImage file, shouldn&#039;t I give a different address in the command, will it not overwrite the u-boot image ?</p><p>In our board, there is no ethernet port, I suppose we need one, because after u-boot loads up, we need to use tftp to transfer the uImage file to RAM ? Can we program the NOR flash without ethernet support?</p><p>Rgds,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332923">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						29 Jul 2016, 12:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pradeepsysargus wrote:</cite><blockquote><div class="codebox"><pre><code>flashrom -p ft2232_spi:type=arm-usb-ocd -w uboot.img</code></pre></div><p>There is no mention of address where the uboot.img file will be programmed. If I wish to program a uImage file, shouldn&#039;t I give a different address in the command, will it not overwrite the u-boot image ?</p></blockquote></div><p>See flashrom &quot;--layout&quot; parameter discription. By default flashrom use full flash image for read/write operation.<br /></p><div class="quotebox"><blockquote><p>In our board, there is no ethernet port, I suppose we need one, because after u-boot loads up, we need to use tftp to transfer the uImage file to RAM ? Can we program the NOR flash without ethernet support?</p></blockquote></div><p>You can configure u-boot to use &quot;loadb&quot; command for loading firmware through serial console. But ether port is more comfortable.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332972">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						30 Jul 2016, 16:06					</div>
				</div>
				<div class="post-content content">
					<p>I am able to detect my flash chip when I use the command:</p><div class="codebox"><pre><code>./flashrom -p ft2232_spi:type=arm-usb-ocd -c EN25Q64</code></pre></div><p>If use the below command to write binary file to the flash memory using JTAG - ARM-USB-OCD debugger for my target board RT5350F-OLinuXino-EVB, I am getting an error.</p><div class="codebox"><pre><code>./flashrom -p ft2232_spi:type=arm-usb-ocd -w FlashImage_RT5350F_OLinuXino_EVB.bin</code></pre></div><p>The error is:<br /></p><div class="quotebox"><blockquote><p>Found Eon flash chip &quot;EN25Q64&quot; (8192 kB, SPI) on ft2232_spi.<br />ftdi_write_data: -110, usb bulk write failed<br />send_buf failed before read: 1<br />Reading old flash chip contents... ftdi_read_data: -110, usb bulk read failed<br />get_buf failed: 1<br />FAILED.</p></blockquote></div><p>Please let me know,</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p332973">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						30 Jul 2016, 16:21					</div>
				</div>
				<div class="post-content content">
					<p>It&#039;s time to go flashrom.org? <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333178">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						3 Aug 2016, 15:23					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for pointing to flashrom.org.</p><p>Seems we cannot use --layout configuration to write to a specific region of flash as it was showing image size not equal to flash size error. There is a work around for that. <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>I have some time to play with my RT5350-Olimex-EVB board till the actual board arrive in some 15 days.</p><p>I have generated HT-TM02 device firmware image that I mentioned in one of the previous posts. <br />I have used the uboot.img file and openwrt-15.05.1-ramips-rt305x-ht-tm02-squashfs-sysupgrade.bin file to put in to the partition locations 0x00000 and 0x50000. I have left u-boot-env and factory partitions as empty.</p><p><a href="http://www.dnclabs.com/wp-content/uploads/2015/10/Memory_map.png">http://www.dnclabs.com/wp-content/uploa … ry_map.png</a><br />In the above link, the second image is the partitions I am following.</p><p>After flashing the two images to Olimex EVB, I am able to see the u-boot detecting flash memory and SDRAM. Kernel is able to boot. For HT-TM02, in the .dts file, there is a different flash memory that is mentioned. Still my kernel is able to detect the flash memory that is on EVB board. It mentioned that it was expecting a different flash memory, but still it is able to detect.</p><p>I am able to see the Openwrt network and able to connect to it without any password, I suppose these settings can be controlled at /etc/config/wireless in the board.</p><p>I am not able to open the LUCI interface at 192.168.1.1</p><p>What should I look at now ?</p><p>my /etc/config/wireless file looks like:</p><div class="codebox"><pre><code>config wifi-device &#039;radio0&#039;
        option type &#039;mac80211&#039;
        option channel &#039;11&#039;
        option hwmode &#039;11g&#039;
        option path &#039;10180000.wmac&#039;
        option htmode &#039;HT20&#039;
        option disabled &#039;0&#039;

config wifi-iface
        option device &#039;radio0&#039;
        option network &#039;lan&#039;
        option mode &#039;ap&#039;
        option ssid &#039;OpenWrt&#039;
        option encryption &#039;none&#039;</code></pre></div><br /><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333326">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						5 Aug 2016, 09:06					</div>
				</div>
				<div class="post-content content">
					<p>For Image Builder,&nbsp; Chaos Calmer 15.05.1, You have given steps to create/edit files.</p><p>Isn&#039;t there option like &#039;make menuconfig&#039; where we can enable the interfaces?</p><p>If possible, can you give me your contact email as I donot get any notifications when You send a reply to my post. I am not sure if you are getting notification either.</p><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333438">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						6 Aug 2016, 10:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pradeepsysargus wrote:</cite><blockquote><p>I have left u-boot-env and factory partitions as empty.</p></blockquote></div><p>Empty factory partition will disable wifi.<br /></p><div class="quotebox"><blockquote><p>Still my kernel is able to detect the flash memory that is on EVB board. It mentioned that it was expecting a different flash memory, but still it is able to detect.</p></blockquote></div><p>Correct dts-file to remove kernel warning.<br /></p><div class="quotebox"><blockquote><p>I am not able to open the LUCI interface at 192.168.1.1</p></blockquote></div><p>You can add luci to firmware with command<br /></p><div class="codebox"><pre><code>make image PROFILE=HT-TM02 PACKAGES=&quot;luci&quot;</code></pre></div><p>or directly editing profile file in target/linux/ramips/rt305x/profiles<br /></p><div class="quotebox"><blockquote><p>my /etc/config/wireless file looks like:</p></blockquote></div><p>You can add your preconfigured wireless-file to target/linux/ramips/base-files/etc/config/wireless and call<br /></p><div class="codebox"><pre><code>make image PROFILE=HT-TM02 PACKAGES=&quot;luci&quot; FILES=target/linux/ramips/base-files</code></pre></div><p>This way allow to replace any file in flnal image.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333547">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						7 Aug 2016, 13:36					</div>
				</div>
				<div class="post-content content">
					<p>Okey</p><div class="quotebox"><blockquote><p>Empty factory partition will disable wifi.</p></blockquote></div><p>How do I create a factory image that enable my wifi ?<br />How should I use u-boot-env partition?</p><p>If I change the following line in base-files/etc/config/wireless <br /></p><div class="codebox"><pre><code>        option hwmode &#039;11g&#039;</code></pre></div><p>to<br /></p><div class="codebox"><pre><code>       option hwmode &#039;11n&#039;</code></pre></div><p>does it change the datarate that happen in wifi? Is there a free tool that I can use to sniff this wifi protocol ?</p><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p333896">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						10 Aug 2016, 11:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>pradeepsysargus wrote:</cite><blockquote><p>How do I create a factory image that enable my wifi ?</p></blockquote></div><p>Every device is calibrated by vendor. This data is written into factory partition. If you lose this data you can use reference settings for your chipset from Ralink/Mediatek SDK with unpredictable state (from wifi work ok to wifi performance degradation or total wifi disfunction).<br /></p><div class="quotebox"><blockquote><p>How should I use u-boot-env partition?</p></blockquote></div><p>uboot-env may be empty<br /></p><div class="quotebox"><blockquote><p>does it change the datarate that happen in wifi? Is there a free tool that I can use to sniff this wifi protocol ?</p></blockquote></div><p>hwmode select 2.4/5GHz mode.<br />htmode - HT20 or HT40 select high transfer modes.<br />See <a href="https://wiki.openwrt.org/doc/uci/wireless">wik</a>i for details.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334281">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						13 Aug 2016, 07:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>you can use reference settings for your chipset from Ralink/Mediatek SDK</p></blockquote></div><p><a href="https://github.com/stevenylai/ralink_sdk">https://github.com/stevenylai/ralink_sdk</a></p><p>I found the above for ralink sdk, I have to write data to factory paritition I suppose, Do you know steps to create a factory image file (wifi ok state) for RT5350 chipset.</p><p>I am going through the wiki link that you have mentioned in the previous post.</p><p>Thanks,</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334289">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">123serge123</div>
					<div class="post-datetime">
						13 Aug 2016, 11:16					</div>
				</div>
				<div class="post-content content">
					<p>What is current state of your device? Show output of commands<br /></p><div class="codebox"><pre><code>dmesg
hexdump -C /dev/mtd2</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335147">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">pradeepsysargus</div>
					<div class="post-datetime">
						20 Aug 2016, 09:44					</div>
				</div>
				<div class="post-content content">
					<p>Currently, I am able to connect to the &#039;Openwrt&#039; network and also access its LUCI inferface with the instructions given by you.</p><div class="codebox"><pre><code>make image PROFILE=HT-TM02 PACKAGES=&quot;luci&quot;</code></pre></div><p>created the firmware image which I used to create the final flash image.</p><p>I kept u-boot-env and factory partitions as empty(looks like wifi is ok even without factory image)</p><p>The output of the below command is:<br /></p><div class="codebox"><pre><code>hexdump -C /dev/mtd2</code></pre></div><p>00000000&nbsp; ff ff ff ff ff ff ff ff&nbsp; ff ff ff ff ff ff ff ff&nbsp; |................|<br />*<br />00010000</p><p>I have put an USB pen drive into the usb -slot of the board, I am not able to see that in the LUCI interface.<br />Although, it detects in the board. I see the below message when I plug the USB on the board:</p><div class="quotebox"><blockquote><p>[&nbsp; 834.520000] usb 1-1: new high-speed USB device number 2 using ehci-platform</p></blockquote></div><p>I am putting the dmesg of my board for reference:</p><div class="codebox"><pre><code>[    0.000000] Linux version 3.18.23 (buildbot@builder1) (gcc version 4.8.3 (OpenWrt/Linaro GCC 4.8-2014.04 r47269) ) #1 Sun Jan 31 14:39:33 CET 2016
[    0.000000] SoC Type: Ralink RT5350 id:1 rev:3
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU0 revision is: 0001964c (MIPS 24KEc)
[    0.000000] MIPS: machine is HooToo HT-TM02
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 02000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone ranges:
[    0.000000]   Normal   [mem 0x00000000-0x01ffffff]
[    0.000000] Movable zone start for each node
[    0.000000] Early memory node ranges
[    0.000000]   node   0: [mem 0x00000000-0x01ffffff]
[    0.000000] Initmem setup node 0 [mem 0x00000000-0x01ffffff]
[    0.000000] On node 0 totalpages: 8192
[    0.000000] free_area_init_node: node 0, pgdat 802f6290, node_mem_map 81000000
[    0.000000]   Normal zone: 64 pages used for memmap
[    0.000000]   Normal zone: 0 pages reserved
[    0.000000]   Normal zone: 8192 pages, LIFO batch:0
[    0.000000] Primary instruction cache 32kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 16kB, 4-way, VIPT, no aliases, linesize 32 bytes
[    0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768
[    0.000000] pcpu-alloc: [0] 0
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
[    0.000000] Kernel command line: console=ttyS0,57600 rootfstype=squashfs,jffs2
[    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
[    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] Writing ErrCtl register=0007208e
[    0.000000] Readback ErrCtl register=0007208e
[    0.000000] Memory: 28948K/32768K available (2508K kernel code, 119K rwdata, 492K rodata, 136K init, 185K bss, 3820K reserved)
[    0.000000] SLUB: HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:256
[    0.000000] CPU Clock: 360MHz
[    0.000000] systick: running - mult: 214748, shift: 32
[    0.010000] Calibrating delay loop... 239.61 BogoMIPS (lpj=1198080)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.090000] Mount-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.100000] Mountpoint-cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.110000] pinctrl core: initialized pinctrl subsystem
[    0.120000] NET: Registered protocol family 16
[    0.130000] rt2880-pinmux pinctrl: try to register 28 pins ...
[    0.130000] pinctrl core: registered pin 0 (io0) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 1 (io1) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 2 (io2) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 3 (io3) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 4 (io4) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 5 (io5) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 6 (io6) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 7 (io7) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 8 (io8) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 9 (io9) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 10 (io10) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 11 (io11) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 12 (io12) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 13 (io13) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 14 (io14) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 15 (io15) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 16 (io16) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 17 (io17) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 18 (io18) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 19 (io19) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 20 (io20) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 21 (io21) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 22 (io22) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 23 (io23) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 24 (io24) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 25 (io25) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 26 (io26) on rt2880-pinmux
[    0.130000] pinctrl core: registered pin 27 (io27) on rt2880-pinmux
[    0.130000] pinctrl core: add 3 pinmux maps
[    0.130000] rt2880-pinmux pinctrl: found group selector 0 for i2c
[    0.130000] rt2880-pinmux pinctrl: found group selector 4 for jtag
[    0.130000] rt2880-pinmux pinctrl: found group selector 2 for uartf
[    0.130000] rt2880-pinmux pinctrl: request pin 1 (io1) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 2 (io2) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 17 (io17) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 18 (io18) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 19 (io19) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 20 (io20) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 21 (io21) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 7 (io7) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 8 (io8) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 9 (io9) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 10 (io10) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 11 (io11) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 12 (io12) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 13 (io13) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: request pin 14 (io14) for pinctrl
[    0.130000] rt2880-pinmux pinctrl: failed to lookup the sleep state
[    0.140000] rt2880_gpio 10000600.gpio: registering 22 gpios
[    0.150000] rt2880_gpio 10000600.gpio: registering 22 irq handlers
[    0.160000] Switched to clocksource systick
[    0.170000] NET: Registered protocol family 2
[    0.180000] TCP established hash table entries: 1024 (order: 0, 4096 bytes)
[    0.190000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.200000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.220000] TCP: reno registered
[    0.220000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.230000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.250000] NET: Registered protocol family 1
[    0.260000] rt-timer 10000100.timer: maximum frequency is 7324Hz
[    0.270000] alarmtimer alarmtimer: no of_node; not parsing pinctrl DT
[    0.270000] futex hash table entries: 256 (order: -1, 3072 bytes)
[    0.320000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.330000] jffs2: version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.380000] msgmni has been set to 56
[    0.390000] io scheduler noop registered
[    0.390000] io scheduler deadline registered (default)
[    0.410000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
[    0.420000] serial8250 serial8250: no of_node; not parsing pinctrl DT
[    0.420000] pinctrl core: add 1 pinmux maps
[    0.420000] rt2880-pinmux pinctrl: found group selector 3 for uartlite
[    0.420000] rt2880-pinmux pinctrl: request pin 15 (io15) for 10000c00.uartlite
[    0.420000] rt2880-pinmux pinctrl: request pin 16 (io16) for 10000c00.uartlite
[    0.420000] console [ttyS0] disabled
[    0.430000] 10000c00.uartlite: ttyS0 at MMIO 0x10000c00 (irq = 20, base_baud = 2500000) is a 16550A
[    0.450000] console [ttyS0] enabled
[    0.460000] bootconsole [early0] disabled
[    0.480000] pinctrl core: add 1 pinmux maps
[    0.480000] pinctrl core: add 1 pinmux maps
[    0.480000] rt2880-pinmux pinctrl: found group selector 1 for spi
[    0.480000] rt2880-pinmux pinctrl: found group selector 6 for spi_cs1
[    0.480000] rt2880-pinmux pinctrl: request pin 3 (io3) for 10000b00.spi
[    0.480000] rt2880-pinmux pinctrl: request pin 4 (io4) for 10000b00.spi
[    0.480000] rt2880-pinmux pinctrl: request pin 5 (io5) for 10000b00.spi
[    0.480000] rt2880-pinmux pinctrl: request pin 6 (io6) for 10000b00.spi
[    0.480000] rt2880-pinmux pinctrl: request pin 27 (io27) for 10000b00.spi
[    0.510000] m25p80 spi32766.0: found en25q64, expected mx25l6405d
[    0.520000] m25p80 spi32766.0: en25q64 (8192 Kbytes)
[    0.530000] 4 ofpart partitions found on MTD device spi32766.0
[    0.540000] Creating 4 MTD partitions on &quot;spi32766.0&quot;:
[    0.550000] 0x000000000000-0x000000030000 : &quot;u-boot&quot;
[    0.560000] 0x000000030000-0x000000040000 : &quot;u-boot-env&quot;
[    0.580000] 0x000000040000-0x000000050000 : &quot;factory&quot;
[    0.590000] 0x000000050000-0x000000800000 : &quot;firmware&quot;
[    0.670000] 2 uimage-fw partitions found on MTD device firmware
[    0.680000] 0x000000050000-0x000000162ac1 : &quot;kernel&quot;
[    0.700000] 0x000000162ac1-0x000000800000 : &quot;rootfs&quot;
[    0.710000] mtd: device 5 (rootfs) set to be root filesystem
[    0.720000] 1 squashfs-split partitions found on MTD device rootfs
[    0.730000] 0x000000390000-0x000000800000 : &quot;rootfs_data&quot;
[    0.750000] ralink_soc_eth 10100000.ethernet: generated random MAC address 42:de:97:b9:37:ca
[    0.770000] ralink_soc_eth 10100000.ethernet eth0: ralink at 0xb0100000, irq 5
[    0.790000] rt2880_wdt 10000120.watchdog: Initialized
[    0.800000] TCP: cubic registered
[    0.800000] NET: Registered protocol family 17
[    0.810000] bridge: automatic filtering via arp/ip/ip6tables has been deprecated. Update your scripts to load br_netfilter if you need this.
[    0.840000] Bridge firewalling registered
[    0.850000] 8021q: 802.1Q VLAN Support v1.8
[    0.890000] VFS: Mounted root (squashfs filesystem) readonly on device 31:5.
[    0.900000] Freeing unused kernel memory: 136K (8030e000 - 80330000)
[    3.810000] init: Console is alive
[    3.820000] init: - watchdog -
[    6.810000] usbcore: registered new interface driver usbfs
[    6.820000] usbcore: registered new interface driver hub
[    6.830000] usbcore: registered new device driver usb
[    6.850000] rt2880-pinmux pinctrl: request pin 10 (io10) for pio:10
[    6.850000] rt2880-pinmux pinctrl: request pin 14 (io14) for pio:14
[    6.850000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    6.870000] ehci-platform: EHCI generic platform driver
[    7.080000] phy phy-usbphy.0: remote usb device wakeup disabled
[    7.090000] phy phy-usbphy.0: UTMI 16bit 30MHz
[    7.100000] ehci-platform 101c0000.ehci: EHCI Host Controller
[    7.110000] ehci-platform 101c0000.ehci: new USB bus registered, assigned bus number 1
[    7.130000] ehci-platform 101c0000.ehci: irq 26, io mem 0x101c0000
[    7.160000] ehci-platform 101c0000.ehci: USB 2.0 started, EHCI 1.00
[    7.170000] usb usb1: no of_node; not parsing pinctrl DT
[    7.170000] hub 1-0:1.0: no of_node; not parsing pinctrl DT
[    7.170000] hub 1-0:1.0: USB hub found
[    7.180000] hub 1-0:1.0: 1 port detected
[    7.190000] ohci_hcd: USB 1.1 &#039;Open&#039; Host Controller (OHCI) Driver
[    7.210000] ohci-platform: OHCI generic platform driver
[    7.220000] ohci-platform 101c1000.ohci: Generic Platform OHCI controller
[    7.230000] ohci-platform 101c1000.ohci: new USB bus registered, assigned bus number 2
[    7.250000] ohci-platform 101c1000.ohci: irq 26, io mem 0x101c1000
[    7.320000] usb usb2: no of_node; not parsing pinctrl DT
[    7.320000] hub 2-0:1.0: no of_node; not parsing pinctrl DT
[    7.320000] hub 2-0:1.0: USB hub found
[    7.330000] hub 2-0:1.0: 1 port detected
[    7.340000] rt2880-pinmux pinctrl: request pin 7 (io7) for pio:7
[    7.340000] rt2880-pinmux pinctrl: request pin 12 (io12) for pio:12
[    7.870000] init: - preinit -
[    9.300000] rt305x-esw 10110000.esw: link changed 0x00
[    9.640000] random: procd urandom read with 15 bits of entropy available
[   12.850000] jffs2: notice: (314) jffs2_build_xattr_subsystem: complete building xattr subsystem, 0 of xdatum (0 unchecked, 0 orphan) and 0 of xref (0 dead, 0 orphan) found.
[   12.880000] mount_root: switching to jffs2 overlay
[   12.950000] procd: - early -
[   12.950000] procd: - watchdog -
[   14.200000] procd: - ubus -
[   15.220000] procd: - init -
[   16.550000] NET: Registered protocol family 10
[   16.570000] ip6_tables: (C) 2000-2006 Netfilter Core Team
[   16.610000] Loading modules backported from Linux version master-2015-03-09-0-g141f155
[   16.630000] Backport generated by backports.git backports-20150129-0-gdd4a670
[   16.650000] ip_tables: (C) 2000-2006 Netfilter Core Team
[   16.680000] nf_conntrack version 0.5.0 (454 buckets, 1816 max)
[   16.760000] xt_time: kernel timezone is -0000
[   16.820000] cfg80211: Calling CRDA to update world regulatory domain
[   16.880000] cfg80211: World regulatory domain updated:
[   16.890000] cfg80211:  DFS Master region: unset
[   16.890000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp), (dfs_cac_time)
[   16.910000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (N/A, 2000 mBm), (N/A)
[   16.930000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz, 92000 KHz AUTO), (N/A, 2000 mBm), (N/A)
[   16.950000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (N/A, 2000 mBm), (N/A)
[   16.960000] cfg80211:   (5170000 KHz - 5250000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (N/A)
[   16.980000] cfg80211:   (5250000 KHz - 5330000 KHz @ 80000 KHz, 160000 KHz AUTO), (N/A, 2000 mBm), (0 s)
[   17.000000] cfg80211:   (5490000 KHz - 5730000 KHz @ 160000 KHz), (N/A, 2000 mBm), (0 s)
[   17.020000] cfg80211:   (5735000 KHz - 5835000 KHz @ 80000 KHz), (N/A, 2000 mBm), (N/A)
[   17.030000] cfg80211:   (57240000 KHz - 63720000 KHz @ 2160000 KHz), (N/A, 0 mBm), (N/A)
[   17.130000] PPP generic driver version 2.4.2
[   17.150000] NET: Registered protocol family 24
[   17.210000] ieee80211 phy0: rt2x00_set_rt: Info - RT chipset 5350, rev 0500 detected
[   17.220000] ieee80211 phy0: rt2x00_set_rf: Info - RF chipset 5350 detected
[   17.240000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
[   28.790000] device eth0 entered promiscuous mode
[   28.810000] br-lan: port 1(eth0) entered forwarding state
[   28.820000] br-lan: port 1(eth0) entered forwarding state
[   30.820000] br-lan: port 1(eth0) entered forwarding state
[   31.900000] IPv6: ADDRCONF(NETDEV_UP): wlan0: link is not ready
[   31.920000] device wlan0 entered promiscuous mode
[   31.930000] br-lan: port 2(wlan0) entered forwarding state
[   31.940000] br-lan: port 2(wlan0) entered forwarding state
[   32.040000] IPv6: ADDRCONF(NETDEV_CHANGE): wlan0: link becomes ready
[   33.940000] br-lan: port 2(wlan0) entered forwarding state
[   70.070000] random: nonblocking pool is initialized
[  834.520000] usb 1-1: new high-speed USB device number 2 using ehci-platform
[  834.680000] usb 1-1: no of_node; not parsing pinctrl DT</code></pre></div><p>Let me know how do I see the USB pen drive data on the LUCI interface.</p><p>Thanks,</p>									</div>
			</article>

			
		
			
		
	
	<div class="pagination"><div class="pagination-number">Page 1 of 2</div><nav><ul><li class="pagination-current"><span>1</span></li><li><a href="viewtopic.php%3Fid=66359&amp;p=2.html">2</a></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>