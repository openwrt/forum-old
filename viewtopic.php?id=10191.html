<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> sendmail voicemail error</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 21 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p45809">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						4 Apr 2007, 02:11					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I have 1 error :</p><p>&lt;&lt;&lt;&lt; 220 smtp6-g19.free.fr ESMTP Postfix<br />&gt;&gt;&gt;&gt; HELO OpenWrt<br />&lt;&lt;&lt;&lt; 250 smtp6-g19.free.fr<br />&gt;&gt;&gt;&gt; MAIL FROM:&lt;Asterisk-Pbx@free.fr&gt;<br />&lt;&lt;&lt;&lt; 250 Ok<br />&gt;&gt;&gt;&gt; RCPT TO:&lt;&quot;Yannick Mailbox&quot; &lt;yann78essai@free.fr&gt;<br />&lt;&lt;&lt;&lt; 501 Bad recipient address syntax<br />/mnt/sd/usr/sbin/sendmail: unexpected response 501 to RCPT TO command</p><p>Why?</p><p>Can you help me?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45828">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						4 Apr 2007, 11:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yann78 wrote:</cite><blockquote><p>&gt;&gt;&gt;&gt; RCPT TO:&lt;&quot;Yannick Mailbox&quot; &lt;yann78essai@free.fr&gt;</p></blockquote></div><p>Count the number of brackets &lt;,&gt; and you&#039;ll notice that there is a formatting error in the mail address...<br />I would suggest to leave out the &quot;name&quot; part completely.</p><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45882">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						5 Apr 2007, 01:23					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><div class="quotebox"><cite>yann78 wrote:</cite><blockquote><p>&gt;&gt;&gt;&gt; RCPT TO:&lt;&quot;Yannick Mailbox&quot; &lt;yann78essai@free.fr&gt;</p></blockquote></div><p>Count the number of brackets &lt;,&gt; and you&#039;ll notice that there is a formatting error in the mail address...<br />I would suggest to leave out the &quot;name&quot; part completely.</p><p>Hans.</p></blockquote></div><p>With voicemail.conf :</p><p>[default]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />5623 =&gt; 5421,Yannick Mailbox,yann78essai@free.fr <br />&nbsp; <br />I have this error:<br />&nbsp; &nbsp;&lt;&lt;&lt;&lt; 220 smtp6-g19.free.fr ESMTP Postfix<br />&nbsp; &nbsp;&gt;&gt;&gt;&gt; HELO OpenWrt<br />&nbsp; &nbsp;&lt;&lt;&lt;&lt; 250 smtp6-g19.free.fr<br />&nbsp; &nbsp;&gt;&gt;&gt;&gt; MAIL FROM:&lt;Asterisk-Pbx@free.fr&gt;<br />&nbsp; &nbsp;&lt;&lt;&lt;&lt; 250 Ok<br />&nbsp; &nbsp;&gt;&gt;&gt;&gt; RCPT TO:&lt;&quot;Yannick Mailbox&quot; &lt;yann78essai@free.fr&gt;<br />&nbsp; &nbsp;&lt;&lt;&lt;&lt; 501 Bad recipient address syntax<br />&nbsp; &nbsp;/mnt/sd/usr/sbin/sendmail: unexpected response 501 to RCPT TO command</p><p>And with voicemail.conf :</p><p>default]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />5623 =&gt; 5421,,yann78essai@free.fr <br />&nbsp; <br />I have this error:<br />&nbsp; &nbsp;&lt;&lt;&lt;&lt; 220 smtp6-g19.free.fr ESMTP Postfix<br />&nbsp; &nbsp;&gt;&gt;&gt;&gt; HELO OpenWrt<br />&nbsp; &nbsp;&lt;&lt;&lt;&lt; 250 smtp6-g19.free.fr<br />&nbsp; &nbsp;&gt;&gt;&gt;&gt; MAIL FROM:&lt;Asterisk-Pbx@free.fr&gt;<br />&nbsp; &nbsp;&lt;&lt;&lt;&lt; 250 Ok<br />&nbsp; &nbsp;&gt;&gt;&gt;&gt; RCPT TO:&lt;&quot;&quot; &lt;yann78essai@free.fr&gt;<br />&nbsp; &nbsp;&lt;&lt;&lt;&lt; 501 Bad recipient address syntax<br />&nbsp; &nbsp;/mnt/sd/usr/sbin/sendmail: unexpected response 501 to RCPT TO command</p><br /><p>Can you help me ?</p><br /><p>Is there an error in the sendmail.c file? </p><p>_________________________________________________________________________<br />static void<br />add_recipient( char* recipient, int len )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; char buf[1000];<br />&nbsp; &nbsp; int status;</p><p>&nbsp; &nbsp; /* Skip leading whitespace. */<br />&nbsp; &nbsp; while ( len &gt; 0 &amp;&amp; ( *recipient == &#039; &#039; || *recipient == &#039;\t&#039; ) )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; ++recipient;<br />&nbsp; &nbsp; --len;<br />&nbsp; &nbsp; }</p><p>&nbsp; &nbsp; /* Strip off any angle brackets. */<br />&nbsp; &nbsp; while ( len &gt; 0 &amp;&amp; *recipient == &#039;&lt;&#039; )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; ++recipient;<br />&nbsp; &nbsp; --len;<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; while ( len &gt; 0 &amp;&amp; recipient[len-1] == &#039;&gt;&#039; )<br />&nbsp; &nbsp; --len;</p><p>&nbsp; &nbsp; (void) snprintf( buf, sizeof(buf), &quot;RCPT TO:&lt;%.*s&gt;&quot;, len, recipient );<br />&nbsp; &nbsp; send_command( buf );<br />&nbsp; &nbsp; status = read_response();<br />&nbsp; &nbsp; if ( status != 250&nbsp; &amp;&amp; status != 251 )<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; (void) fprintf(<br />&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;stderr,&nbsp; &quot;%s: unexpected response %d to RCPT TO command\n&quot;,<br />&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;argv0, status );<br />&nbsp; &nbsp; exit( 1 );<br />&nbsp; &nbsp; }<br />&nbsp; &nbsp; got_a_recipient = 1;<br />&nbsp; &nbsp; }<br />___________________________________________________________________________</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45899">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						5 Apr 2007, 10:04					</div>
				</div>
				<div class="post-content content">
					<p>What is the commandline for sending mail in the voicemail.conf?<br />Which sendmail package do you use (I recommend ssmtp)?<br />What does the configuration file for the sendmail package look like?</p><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p45922">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						6 Apr 2007, 02:01					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><p>What is the commandline for sending mail in the voicemail.conf?</p></blockquote></div><p>mailcmd=/mnt/sd/usr/sbin/sendmail -t -fAsterisk-Pbx@free.fr -ssmtp.free.fr -p25 -v </p><br /><br /><div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><p>Which sendmail package do you use (I recommend ssmtp)?</p></blockquote></div><p><a href="http://downloads.openwrt.org/backports/rc6/mini-sendmail_1.3.5-1_mipsel.ipk">http://downloads.openwrt.org/backports/ … mipsel.ipk</a></p><br /><br /><div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><p>What does the configuration file for the sendmail package look like?</p></blockquote></div><p>FILES&nbsp; Makefile&nbsp; &nbsp;mini_sendmail.c&nbsp; &nbsp; mini_sendmail.8&nbsp; &nbsp; &nbsp;version.h</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46006">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						7 Apr 2007, 13:29					</div>
				</div>
				<div class="post-content content">
					<p>Can you help me ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46011">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						7 Apr 2007, 15:05					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yann78 wrote:</cite><blockquote><p>Can you help me ?</p></blockquote></div><p>My guess is that there is an error in the configuration of mini-sendmail.<br />You should ask user jcgalvez as he seems to have voicemail running with mini-sendmail:<br /><a href="http://forum.openwrt.org/viewtopic.php?pid=41352#p41352">http://forum.openwrt.org/viewtopic.php?pid=41352#p41352</a><br /><a href="http://forum.openwrt.org/profile.php?id=3880">http://forum.openwrt.org/profile.php?id=3880</a></p><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46015">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">noelbou</div>
					<div class="post-datetime">
						7 Apr 2007, 16:13					</div>
				</div>
				<div class="post-content content">
					<p>Hello Yann,</p><p>I had the same problems (with WR RC6) until i removed completely the names from the voicemail.conf file.<br />It seems that mini-sendmail has a problems with the destination user address if it includes the user name.<br />Removing the user name from voicemail.conf solves the problem. Still works with WR 0.9 ...</p><p>Noel<br />Montreal, Canada</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46023">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">noelbou</div>
					<div class="post-datetime">
						7 Apr 2007, 18:03					</div>
				</div>
				<div class="post-content content">
					<p>Update ...</p><p>I just upgraded to asterisk 1.4 (from 1.2.14) and i now have also the same (or similar) problem ...:<br />&gt;&gt;&gt;&gt; MAIL FROM:&lt;root@OpenWrt&gt;<br />&lt;&lt;&lt;&lt; 250 2.1.0 &lt;root@OpenWrt&gt;... Sender ok<br />&gt;&gt;&gt;&gt; RCPT TO:&lt;&quot;&quot; &lt;noel201@teledata.qc.ca&gt;<br />&lt;&lt;&lt;&lt; 553 5.0.0 &lt;&quot;&quot; &lt;noel201@teledata.qc.ca&gt;... Unbalanced &#039;&lt;&#039;</p><p>I used the same sendmail cmd and voicemail.conf settings as before <br />201 =&gt; 201,,noel201@telexxxx.qc.ca,,attach=yes|saycid=no|envelope=no|delete=no<br />mailcmd=/usr/sbin/mini_sendmail -t -v -smailxxx.xxx.com<br />Note the blank 2nd param in the voicemail.conf (this fixed the problem in 1.2.14 ...) no it doesn&#039;t anymore :-(</p><p>So ... there must be a problem in the way * format the parameters from the conf. files ... </p><p>Any tought zandbelt ????<br />Tnx for any help ...</p><p>Noël</p>											<p class="post-edited">(Last edited by <strong>noelbou</strong> on 7 Apr 2007, 18:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46025">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						7 Apr 2007, 18:32					</div>
				</div>
				<div class="post-content content">
					<p>Try and debug the actual message sent using:</p><p>&nbsp; &nbsp;mailcmd=cat \&gt; /tmp/astvm-mail</p><p>Hans.</p><p>PS: it looks like asterisk 1.4.x and mini_sendmail have some interoperability issues (ssmtp works fine with 1.4.x)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46031">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">noelbou</div>
					<div class="post-datetime">
						7 Apr 2007, 20:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><p>Try and debug the actual message sent using:<br />&nbsp; &nbsp;mailcmd=cat \&gt; /tmp/astvm-mail</p></blockquote></div><p>Sorry .. but thi cmd doesn&#039;t work ... No such file ...&nbsp; (?)<br />Tried a few variations with same result ...</p><p>Noël</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46033">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						7 Apr 2007, 20:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><p>PS: it looks like asterisk 1.4.x and mini_sendmail have some interoperability issues (ssmtp works fine with 1.4.x)</p></blockquote></div><p>with sd/card ?</p><p>ssmtp dosn&#039;t work : segmentation fault</p>											<p class="post-edited">(Last edited by <strong>yann78</strong> on 7 Apr 2007, 20:52)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46035">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">noelbou</div>
					<div class="post-datetime">
						7 Apr 2007, 20:53					</div>
				</div>
				<div class="post-content content">
					<p>Update:</p><p>I had to go back to * 1.2.14 as my WRTSL54GS would not reboot after updating to V1.4 :-(</p><p>Here is what * sends to mini-sendmail (this seems perfect ...)</p><p>Date: Sat, 07 Apr 2007 17:37:06 +0000<br />From: Asterisk PBX &lt;asterisk@OpenWrt&gt;<br />To: Noel Bouchard &lt;noel201@telxxxxx.ca&gt;<br />Subject: Nouveau message (10) Boîte Vocale: 201<br />Message-ID: &lt;Asterisk-9-404370704-201-2052@OpenWrt&gt;<br />MIME-Version: 1.0<br />Content-Type: multipart/mixed; boundary=&quot;voicemail_920120521945708878&quot;</p><p>+----------------------------------------+</p><p>Reply from mini_sendmail:</p><p>&gt;&gt;&gt;&gt; MAIL FROM:&lt;root@OpenWrt&gt;<br />&lt;&lt;&lt;&lt; 250 2.1.0 &lt;root@OpenWrt&gt;... Sender ok<br />&gt;&gt;&gt;&gt; RCPT TO:&lt;Noel Bouchard &lt;noel201@teledata.qc.ca&gt;<br />&lt;&lt;&lt;&lt; 553 5.0.0 &lt;Noel Bouchard &lt;noel201@teledata.qc.ca&gt;... Unbalanced &#039;&lt;&#039;<br />/usr/sbin/mini_sendmail: unexpected response 553 to RCPT TO command</p><p>+------------------------------------------------------+</p><p>If i do not put a name in the voicemail.conf 201 =&gt; 201,, ...&nbsp; the problem does not occur ... <br />So i guess you are right ... the problem is with mini-sendmail ... <br />But ... there must be some diffs. in * 1.4 as it seemed that <br />not including the name would not solve the problem ???</p><p>+----------------------------------------+</p><p>On the V 1.4 issue ... it is strange as it ran ok after i updated until next reboot ...<br />which did not terminate ...&nbsp; (no http/ ssh ... had to access in fail-safe mode) ... <br />Then i did mount_root and tried to start everything &quot;manually&quot; and everything seemed<br />to start ok (???). Asterisk started ok ... <br />Could it be a memory problem ... ? i.e. i have exeeded the RAM capacity ??? </p><p>I noticed that even with V1.1.14 the free ram was sometimes very low (&lt; 1000) <br />Last question ...&nbsp; what are the buffers in the free (mem) display ? </p><p>Tnx ...</p><p>Noël</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46037">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						7 Apr 2007, 20:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><p>PS: it looks like asterisk 1.4.x and mini_sendmail have some interoperability issues (ssmtp works fine with 1.4.x)</p></blockquote></div><p>I have this error :<br />Server didn&#039;t accept AUTH LOGIN (530 5.7.0 Must issue a STARTTLS command first</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46043">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						7 Apr 2007, 21:36					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yann78 wrote:</cite><blockquote><p>:<br />Server didn&#039;t accept AUTH LOGIN (530 5.7.0 Must issue a STARTTLS command first</p></blockquote></div><p>This server expects a secure smtp connection on that particular port and it looks like you are trying to open a plain TCP connection instead. I assume this is ssmtp we&#039;re talking about now (or did you resolve the issue with mini-sendmail)? Here&#039;s a sample ssmtp.conf for a Gmail account which also uses secure smtp (replace &lt;myname&gt; and &lt;mydomain&gt;) :<br /></p><div class="codebox"><pre><code>root=&lt;myname&gt;@gmail.com
mailhub=smtp.gmail.com:587
rewriteDomain=&lt;mydomain&gt;
UseSTARTTLS=YES
AuthUser=&lt;myname&gt;
AuthPass=****
FromLineOverride=YES
hostname=&lt;mydomain&gt;</code></pre></div><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46046">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						7 Apr 2007, 21:41					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>noelbou wrote:</cite><blockquote><p>I had to go back to * 1.2.14 as my WRTSL54GS would not reboot after updating to V1.4 :-(<br />...<br />On the V 1.4 issue ... it is strange as it ran ok after i updated until next reboot ...<br />which did not terminate ...&nbsp; (no http/ ssh ... had to access in fail-safe mode) ... <br />Then i did mount_root and tried to start everything &quot;manually&quot; and everything seemed<br />to start ok (???). Asterisk started ok ... <br />Could it be a memory problem ... ? i.e. i have exeeded the RAM capacity ???</p></blockquote></div><p>Eehm, I think this can be due to the /etc/default/asterisk that is provided in the package, which opens a console...<br />Better remove any &quot;-c&quot; or &quot;-v&quot; flags there. 1.4.x is reported to work and I&#039;d recommend the upgrade.</p><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46051">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">noelbou</div>
					<div class="post-datetime">
						7 Apr 2007, 22:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><p>1.4.x is reported to work and I&#039;d recommend the upgrade.<br />Hans.</p></blockquote></div><p>I will try to give it a 2nd try later ... no more time now ...</p><p>Thank you Hans for your precious help !!!</p><p>Noël</p>											<p class="post-edited">(Last edited by <strong>noelbou</strong> on 7 Apr 2007, 22:07)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46052">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						7 Apr 2007, 22:22					</div>
				</div>
				<div class="post-content content">
					<p>I think that indeed the problem is caused by a change in app_voicemail after asterisk 1.2.14, so it will also exist in asterisk 1.2.16 etc:<br />&nbsp; <a href="http://svn.digium.com/view/asterisk/branches/1.2/apps/app_voicemail.c?rev=53529&amp;view=log">http://svn.digium.com/view/asterisk/bra … p;view=log</a></p><p>I&#039;m not sure whether this change revealed a bug in mini-sendmail or that the actual error is in asterisk (I guess I&#039;d have to check the RFCs on that...)</p><p>To be continued,</p><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46055">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						7 Apr 2007, 23:37					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><div class="quotebox"><cite>yann78 wrote:</cite><blockquote><p>:<br />Server didn&#039;t accept AUTH LOGIN (530 5.7.0 Must issue a STARTTLS command first</p></blockquote></div><p>This server expects a secure smtp connection on that particular port and it looks like you are trying to open a plain TCP connection instead. I assume this is ssmtp we&#039;re talking about now (or did you resolve the issue with mini-sendmail)? Here&#039;s a sample ssmtp.conf for a Gmail account which also uses secure smtp (replace &lt;myname&gt; and &lt;mydomain&gt;) :<br /></p><div class="codebox"><pre><code>root=&lt;myname&gt;@gmail.com
mailhub=smtp.gmail.com:587
rewriteDomain=&lt;mydomain&gt;
UseSTARTTLS=YES
AuthUser=&lt;myname&gt;
AuthPass=****
FromLineOverride=YES
hostname=&lt;mydomain&gt;</code></pre></div><p>Hans.</p></blockquote></div><p>With ssmtp : </p><p>1/ I installed the ssmtp_2.61-1_mipsel.ipk package&nbsp; </p><p>2/ I modified the file /etc/ssmtp/ssmtp.conf :</p><p>------------------------------------------------------------<br />root=yann78essai@gmail.com<br />mailhub=smtp.gmail.com:587<br />rewriteDomaine=root=yann78essai@gmail.com<br />UseSTARTTLS=YES<br />AuthUser=root=yann78essai<br />AuthPass=pass&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(The real password)<br />FromLineOverride=YES<br />hostname= yann78essai@gmail.com<br />-------------------------------------------------------------</p><br /><p>3/ I did a test : echo &quot;test&quot; | ssmtp -vvv yann78essai@gmail.com </p><p>And I get the following error : </p><p>[&lt;-] 220 mx.google.com ESMTP 5sm5145240ugc<br />[-&gt;] EHLO yann78essai@gmail.com<br />[&lt;-] 250 ENHANCEDSTATUSCODES<br />[-&gt;] AUTH LOGIN PG15bmFtZT4=<br />[&lt;-] 530 5.7.0 Must issue a STARTTLS command first 5sm5145240ugc<br />ssmtp: Server didn&#039;t accept AUTH LOGIN (530 5.7.0 Must issue a STARTTLS command first 5sm5145240ugc)</p><br /><p>Can you help me ?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46057">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						8 Apr 2007, 00:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yann78 wrote:</cite><blockquote><p>rewriteDomaine=root=yann78essai@gmail.com<br />...<br />AuthUser=root=yann78essai<br />...<br />hostname= yann78essai@gmail.com</p></blockquote></div><p>These lines all look kind of weird; you wanna change them into something sensible...</p><p>But: I just realized that I have a custom version of ssmtp that was built with SSL support enabled.<br />The default package that you installed doesn&#039;t build with SSL support; I put my package at:<br />&nbsp; <a href="http://zandbelt.dyndns.org/asterisk/ssmtp_2.61-2_mipsel.ipk">http://zandbelt.dyndns.org/asterisk/ssm … mipsel.ipk</a><br />Try this one (with a corrected config file) and I&#039;ll submit the patches to the repository.</p><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46058">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						8 Apr 2007, 00:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><p>I&#039;m not sure whether this change revealed a bug in mini-sendmail or that the actual error is in asterisk (I guess I&#039;d have to check the RFCs on that...)<br />...<br />To be continued.</p></blockquote></div><p>The matter is the following: mini-sendmail does not work with (quoted) full names for _any_ version of Asterisk, as Noel already mentioned.<br />The after-1.2.14 releases have changed behaviour for the case that no name is filled in: still &quot;&quot; is sent to the mailer, on which mini-sendmail now chokes (as it always would have). Mini-sendmail starts stripping of the &lt; and &gt; brackets but in case a full name (or: &quot;&quot;) is supplied, this removes the ending bracket, but leaves the opening bracket (since it is in the middle now, preceded by a full name). Then mini-sendmail surrounds it again with its own brackets...</p><p>Bottom line: it is a bug in mini-sendmail, which should support full names or strip them off correctly. I&#039;ll provide a fix for it shortly. In the mean time you could use the SSL-enabled version of ssmtp described in my previous post which works with full names.</p><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46060">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						8 Apr 2007, 01:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>zandbelt wrote:</cite><blockquote><div class="quotebox"><cite>yann78 wrote:</cite><blockquote><p>rewriteDomaine=root=yann78essai@gmail.com<br />...<br />AuthUser=root=yann78essai<br />...<br />hostname= yann78essai@gmail.com</p></blockquote></div><p>These lines all look kind of weird; you wanna change them into something sensible...</p><p>But: I just realized that I have a custom version of ssmtp that was built with SSL support enabled.<br />The default package that you installed doesn&#039;t build with SSL support; I put my package at:<br />&nbsp; <a href="http://zandbelt.dyndns.org/asterisk/ssmtp_2.61-2_mipsel.ipk">http://zandbelt.dyndns.org/asterisk/ssm … mipsel.ipk</a><br />Try this one (with a corrected config file) and I&#039;ll submit the patches to the repository.</p><p>Hans.</p></blockquote></div><p>Yes! Yes! Yes!</p><p>It&#039;s work with <a href="http://zandbelt.dyndns.org/asterisk/ssmtp_2.61-2_mipsel.ipk">http://zandbelt.dyndns.org/asterisk/ssm … mipsel.ipk</a></p><p>Thank you for your help.</p><p>Yann.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46065">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">yann78</div>
					<div class="post-datetime">
						8 Apr 2007, 03:31					</div>
				</div>
				<div class="post-content content">
					<p>How to configure voicemail.conf with ssmtp ?<br />What&#039;s the cmdline ?</p><p>Yann</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46079">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						8 Apr 2007, 15:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>yann78 wrote:</cite><blockquote><p>How to configure voicemail.conf with ssmtp ?<br />What&#039;s the cmdline ?</p></blockquote></div><p>Sigh; you could also actually _try_ some options yourself (e.g. the defaults...) before asking... <br />Or did you encounter an error? In that case it is useful to report it.</p><p>Hans.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p46144">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">zandbelt</div>
					<div class="post-datetime">
						9 Apr 2007, 19:52					</div>
				</div>
				<div class="post-content content">
					<p>To conclude this topic:</p><p>I have added a patch (<a href="https://dev.openwrt.org/ticket/1578">https://dev.openwrt.org/ticket/1578</a>) that adds support for full names to mini_sendmail.<br />I have also added a patch with SSL support for ssmtp (<a href="https://dev.openwrt.org/ticket/1567">https://dev.openwrt.org/ticket/1567</a>) that was already included in the source tree.</p><p>Now both mini_sendmail and ssmtp work with Asterisk (all versions, with and without full names configured); NB: mini_sendmail does not support secure SMTP (ie. SSL connections).</p><p>Thanks to noelb for testing.</p><p>Hans</p>											<p class="post-edited">(Last edited by <strong>zandbelt</strong> on 9 Apr 2007, 19:53)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>