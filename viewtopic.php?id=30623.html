<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Trouble debricking TP-Link WR740N using serial cable</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 28 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p137893">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">perazim</div>
					<div class="post-datetime">
						26 Jun 2011, 15:54					</div>
				</div>
				<div class="post-content content">
					<p>I managed to brick a TP-Link WR740N by apparently using the wrong firmware. </p><p>Then I purchased a Nokia CA-42 data cable with three conductors which I soldered to ground, RXD and TXD according to the OpenWRT docs for this router. I used a multimeter to verify ground and then connected RXD and TXD together to verify PC using Minicom was working. It was.</p><p>When the router is powered I can partially see the startup sequence but it appears to be intermittently dropping text. I also cannot get control of the router by typing tpl Enter or just Enter.</p><p>Does anybody know how to recover this specific router?</p><p>Thanks in advance.</p><p>Perazim</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137908">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">miguel.arce</div>
					<div class="post-datetime">
						26 Jun 2011, 20:40					</div>
				</div>
				<div class="post-content content">
					<p>Hi Perazim,</p><p>i have an issue right now with my serial on a wr1043nd, in my case the tx line screws my output, but for what you describe<br />it is like the gnd is not making proper contact as if you can see text and if you unplug the ground text would stop<br />plug it again and starts flowing again, check the gnd soldering my best advice.</p><p>regards,<br />Miguel.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137916">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						26 Jun 2011, 21:49					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p>Comment: to get the serial connection work reliably, I had to connect a 10k pullup resistor between the TX and the 3.3V pin.</p></blockquote></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p137954">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">perazim</div>
					<div class="post-datetime">
						27 Jun 2011, 11:10					</div>
				</div>
				<div class="post-content content">
					<p>I have shortened the cable as much as possible and now the output from the router does not have dropped text. I will need to go find a 10K resistor for a pullup but in the meantime here is the output I now see:</p><p>U-Boot 1.1.4 (Mar&nbsp; 8 2010 - 10:29:42)</p><p>AP91 (ar7240) U-boot<br />DRAM:&nbsp; <br />sri<br />#### TAP VALUE 1 = a, 2 = a<br />32 MB<br />id read 0x100000ff<br />flash size 4194304, sector count = 64<br />Flash:&nbsp; 4 MB<br />Using default environment</p><p>In:&nbsp; &nbsp; serial<br />Out:&nbsp; &nbsp;serial<br />Err:&nbsp; &nbsp;serial<br />Net:&nbsp; &nbsp;ag7240_enet_initialize...<br />No valid address in Flash. Using fixed address<br />: cfg1 0xf cfg2 0x7014<br />eth0: 00:03:7f:09:0b:ad<br />eth0 up<br />No valid address in Flash. Using fixed address<br />: cfg1 0xf cfg2 0x7214<br />eth1: 00:03:7f:09:0b:ad<br />ATHRS26: resetting s26<br />ATHRS26: s26 reset done<br />eth1 up<br />eth0, eth1<br />Autobooting in 1 seconds<br />## Booting image at 9f020000 ...<br />&nbsp; &nbsp;Uncompressing Kernel Image ... OK</p><p>Starting kernel ...</p><p>Linux version 2.6.32.10 (openwrt@wrt1.marcant.net) (gcc version 4.3.3 (GCC) ) #20 Tue Apr 6 15:01:26 CEST 2010<br />bootconsole [early0] enabled<br />CPU revision is: 00019374 (MIPS 24Kc)<br />Atheros AR7240 rev 2, CPU:350.000 MHz, AHB:175.000 MHz, DDR:350.000 MHz<br />Determined physical RAM map:<br /> memory: 02000000 @ 00000000 (usable)<br />Initrd not found or empty - disabling initrd<br />Zone PFN ranges:<br />&nbsp; Normal&nbsp; &nbsp;0x00000000 -&gt; 0x00002000<br />Movable zone start PFN for each node<br />early_node_map[1] active PFN ranges<br />&nbsp; &nbsp; 0: 0x00000000 -&gt; 0x00002000<br />Built 1 zonelists in Zone order, mobility grouping on.&nbsp; Total pages: 8128<br />Kernel command line: rootfstype=squashfs,yaffs,jffs2 noinitrd console=ttyS0,115200 board=TL-WR741ND<br />PID hash table entries: 128 (order: -3, 512 bytes)<br />Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)<br />Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)<br />Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.<br />Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes<br />Writing ErrCtl register=00000000<br />Readback ErrCtl register=00000000<br />Memory: 29332k/32768k available (2101k kernel code, 3436k reserved, 397k data, 152k init, 0k highmem)<br />SLUB: Genslabs=7, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1<br />Hierarchical RCU implementation.<br />NR_IRQS:56<br />Calibrating delay loop... 232.65 BogoMIPS (lpj=1163264)<br />Mount-cache hash table entries: 512<br />NET: Registered protocol family 16<br />MIPS: machine is TP-LINK TL-WR741ND<br />registering PCI controller with io_map_base unset<br />bio: create slab &lt;bio-0&gt; at 0<br />PCI: fixup device 0000:00:00.0<br />pci 0000:00:00.0: PME# supported from D0 D1 D3hot<br />pci 0000:00:00.0: PME# disabled<br />PCI: mapping irq 48 to pin1@0000:00:00.0<br />Switching to clocksource MIPS<br />NET: Registered protocol family 2<br />IP route cache hash table entries: 1024 (order: 0, 4096 bytes)<br />TCP established hash table entries: 1024 (order: 1, 8192 bytes)<br />TCP bind hash table entries: 1024 (order: 0, 4096 bytes)<br />TCP: Hash tables configured (established 1024 bind 1024)<br />TCP reno registered<br />NET: Registered protocol family 1<br />squashfs: version 4.0 (2009/01/31) Phillip Lougher<br />Registering mini_fo version $Id$<br />JFFS2 version 2.2. (NAND) (SUMMARY)&nbsp; © 2001-2006 Red Hat, Inc.<br />yaffs Mar 28 2010 17:53:41 Installing. <br />msgmni has been set to 57<br />io scheduler noop registered<br />io scheduler deadline registered (default)<br />Serial: 8250/16550 driver, 1 ports, IRQ sharing disabled<br />serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A<br />console [ttyS0] enabled, bootconsole disabled<br />console [ttyS0] enabled, bootconsole disabled<br />Atheros AR71xx SPI Controller driver version 0.2.4<br />m25p80 spi0.0: unrecognized JEDEC id 1c3116<br />ag71xx_mdio: probed<br />eth0: Atheros AG71xx at 0xba000000, irq 5<br />eth1: Atheros AG71xx at 0xb9000000, irq 4<br />Atheros AR71xx hardware watchdog driver version 0.1.0<br />TCP westwood registered<br />NET: Registered protocol family 17<br />Distributed Switch Architecture driver version 0.1<br />eth0[0]: detected a Atheros AR7240 built-in switch<br />dsa slave smi: probed<br />802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;<br />All bugs added by David S. Miller &lt;davem@redhat.com&gt;<br />VFS: Cannot open root device &quot;&lt;NULL&gt;&quot; or unknown-block(0,0)<br />Please append a correct &quot;root=&quot; boot option; here are the available partitions:<br />Kernel panic - not syncing: VFS: Unable to mount root fs on unknown-block(0,0)</p><br /><br /><p>Some observations:</p><p>1) There doesn&#039;t APPEAR to be an IP address stored and this MAY be why I cannot reflash using TFTP in the usual way.</p><p>2) The root filesystems appears to be missing causing the kernel panic.</p><br /><p>Comments at this point:</p><p>Thanks,</p><p>Perazim</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138002">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						27 Jun 2011, 21:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>perazim wrote:</cite><blockquote><p>## Booting image at 9f020000 ...<br />&nbsp; &nbsp;Uncompressing Kernel Image ... OK</p></blockquote></div><p>The image, kernel and rootfs, is OK.<br /></p><div class="quotebox"><cite>perazim wrote:</cite><blockquote><p>m25p80 spi0.0: unrecognized JEDEC id 1c3116</p></blockquote></div><p>Install RC5-testing or trunk.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p138057">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">perazim</div>
					<div class="post-datetime">
						28 Jun 2011, 14:08					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the help but I made the decision to file 13 this router and go back to using D-Link. I was never able to get the serial link working reliably and this router seems to be full of pitfalls.</p><p>Perazim</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p139451">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">mich181189</div>
					<div class="post-datetime">
						19 Jul 2011, 20:19					</div>
				</div>
				<div class="post-content content">
					<p>I was just working on this, didn&#039;t see this thread before. Place a 150 ohm or so resistor between the router&#039;s TX and ground. This made complete garbled rubbish into a perfectly usable terminal for me.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p142761">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">fyi</div>
					<div class="post-datetime">
						2 Sep 2011, 17:42					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>perazim wrote:</cite><blockquote><p>m25p80 spi0.0: unrecognized JEDEC id 1c3116</p></blockquote></div><p>EON EN25F32 has been supported since <a href="https://dev.openwrt.org/browser/trunk/target/linux/generic/patches-2.6.32/090-mtd-m25p80-add-en25f32-chip-support.patch">r23058</a>. You must have installed an old release. You should install 10.03.1-rc4 or rc5.</p><p><a href="https://forum.openwrt.org/viewtopic.php?pid=110188#p110188">OpenWrt / help bricked wr741nd</a><br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-wr841nd#tftp.install">TP-Link TL-WR841ND - OpenWrt Wiki - TFTP install</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p171792">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">DrStein</div>
					<div class="post-datetime">
						7 Jul 2012, 14:04					</div>
				</div>
				<div class="post-content content">
					<p>Hello guys!<br /><strong><a href="http://file.qip.ru/file/BhcKWfqz/740_hw4_2.html">Here</a></strong> is a full flash dump of 4MB flash of this router (TL-WR740N HW rev 4.2) which was used to recover &quot;dead&quot; router. May be some one will find it useful. <br />It should be flashed directly to chip using SPI programmer.<br /><strong><a href="http://depositfiles.com/files/f0ud5dtac">http://depositfiles.com/files/f0ud5dtac</a></strong><br /><strong><a href="http://letitbit.net/download/10492.1f4e173ac0f17366e698263f5a92/740_hw4_2.BIN.html">http://letitbit.net/download/10492.1f4e … 2.BIN.html</a></strong></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>