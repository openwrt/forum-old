<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-Link TD-W9980 &quot;No SPI flash selected&quot;</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p340998">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">nobodydoesITbetter</div>
					<div class="post-datetime">
						13 Oct 2016, 12:04					</div>
				</div>
				<div class="post-content content">
					<p>Hello,</p><p>I have used OpenWRT on devices many times before and I love it, but I have recently tried flashing it to a TP-Link TD-W9980 v1 and have come unstuck.</p><p>I have followed the OpenWRT Wiki guide for the W9980.</p><p>After transferring u-boot I get the error &quot;SPI flash not selected&quot; so I am unable to erase the SPI and flash the OpenWRT firmware image.</p><p>Please see below for serial capture (I didn&#039;t capture the transfer of u-boot using &quot;cat u-boot.asc &gt; /dev/ttyUSB0&quot;) :</p><div class="codebox"><pre><code>ROM VER: 1.1.4                                                                  
CFG 04                                                                          
EEPROM Data OK                                                                  
UART                                                                            
********************************************************************************
                                                                                
U-Boot 2010.06-LANTIQ-v-2.0.40-00014-g0553908 (Oct 19 2015 - 22:30:36)          
                                                                                
CLOCK CPU 500M RAM 250M                                                         
DRAM:  64 MiB                                                                   
Using default environment                                                       
                                                                                
In:    serial                                                                   
Out:   serial                                                                   
Err:   serial                                                                   
Net:   Internal phy(GE) firmware version: 0x841d                                
vr9 SwitchFailed to initialize SPI flash at 0:3                                 
No SPI flash selected. Please run `sf probe&#039;                                    
                                                                                
                                                                                
Type &quot;run flash_nfs&quot; to mount root filesystem over NFS                          
                                                                                
Hit any key to stop autoboot:  0                                                
VR9 # tftp $(loadaddr) openwrt-15.05.1-lantiq-xrx200-TDW8970-sysupgrade.image   
Failed to initialize SPI flash at 0:3                                           
No SPI flash selected. Please run `sf probe&#039;                                    
Using vr9 Switch device                                                         
TFTP from server 192.168.1.2; our IP address is 192.168.1.1                     
Filename &#039;openwrt-15.05.1-lantiq-xrx200-TDW8970-sysupgrade.image&#039;.              
Load address: 0x80800000                                                        
Loading: T #################################################################    
         #################################################################      
         #################################################################      
         #################################################################      
         ##########################                                             
done                                                                            
Bytes transferred = 4194308 (400004 hex)                                        
VR9 # sf erase 0x20000 0x7a0000                                                 
No SPI flash selected. Please run `sf probe&#039;</code></pre></div><p>And a capture from a normal boot with TP-Link firmware:</p><div class="codebox"><pre><code>ROM VER: 1.1.4                                                                  
CFG 05                                                                          
                                                                                
DDR autotuning Rev 1.0                                                          
DDR size from 0xa0000000 - 0xa3ffffff                                           
DDR check ok... start booting...                                                
                                                                                
                                                                                
                                                                                
U-Boot 2010.06-svn14907-LANTIQ-v-2.3.08 (Jan 22 2016 - 10:08:47)                
                                                                                
CLOCK CPU 500M RAM 250M                                                         
DRAM:  64 MiB                                                                   
Using default environment                                                       
                                                                                
In:    serial                                                                   
Out:   serial                                                                   
Err:   serial                                                                   
Net:   Internal phy(GE) firmware version: 0x8434                                
vr9 Switch8192 KiB GD25Q64C at 0:3 is now current device                        
MAC: 98-de-d0-ac-21-de                                                          
                                                                                
                                                                                
run &quot;flash_flash&quot; to bring up the kernel                                        
                                                                                
Hit any key to stop autoboot:  0                                                
8192 KiB GD25Q64C at 0:3 is now current device                                  
8192 KiB GD25Q64C at 0:3 is now current device                                  
        Uncompressing ...                                                       
Starting kernel ...                                                             
                                                                                
Lantiq xDSL CPE VR9                                                             
mips_hpt_frequency = 250000000, counter_resolution = 2                          
Linux version 2.6.32.32 (swd@localhost.localdomain) (gcc version 4.3.3 (GCC) ) 6
phym = 04000000, mem = 04000000, max_pfn = 00004000                             
Reserving memory for CP1 @0xa4000000, size 0x00000000                           
CPU revision is: 00019556 (MIPS 34Kc)                                           
Determined physical RAM map:                                                    
User-defined physical RAM map:                                                  
 memory: 04000000 @ 00000000 (usable)                                           
Initrd not found or empty - disabling initrd                                    
Zone PFN ranges:                                                                
  Normal   0x00000000 -&gt; 0x00004000                                             
Movable zone start PFN for each node                                            
early_node_map[1] active PFN ranges                                             
    0: 0x00000000 -&gt; 0x00004000                                                 
Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256      
Kernel command line: root=/dev/mtdblock2 rw rootfstype=squashfs ip=192.168.1.1:=
PID hash table entries: 256 (order: -2, 1024 bytes)                             
Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)                   
Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)                    
Primary instruction cache 32kB, VIPT, 4-way,
 linesize 32 bytes.                 
Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes          
Writing ErrCtl register=00040280                                                
Readback ErrCtl register=00040280                                               
Memory: 60596k/65536k available (2881k kernel code, 4872k reserved, 826k data, )
Hierarchical RCU implementation.                                                
NR_IRQS:185                                                                     
Lantiq ICU driver, version 3.0.1, (c) 2001-2011 Lantiq Deutschland GmbH         
console [ttyS0] enabled                                                         
Calibrating delay loop... 332.59 BogoMIPS (lpj=1662976)                         
Mount-cache hash table entries: 512                                             
NET: Registered protocol family 16                                              
Lantiq PCI host controller driver, version 1.2.0, (c) 2001-2011 Lantiq DeutschlH
Lantiq PCIe Root Complex driver, version 1.5.3, (c) 2001-2011 Lantiq DeutschlanH
bio: create slab &lt;bio-0&gt; at 0                                                   
pci 0000:00:00.0: PME# supported from D1 D2                                     
pci 0000:00:00.0: PME# disabled                                                 
ifx_pcie_rc_class_early_fixup: fixed pcie host bridge to pci-pci bridge         
pci 0000:01:00.0: PME# supported from D0 D3hot                                  
pci 0000:01:00.0: PME# disabled                                                 
pci 0000:02:00.0: PME# supported from D0 D1 D3hot                               
pci 0000:02:00.0: PME# disabled                                                 
pci 0000:01:00.0: PCI bridge, secondary bus 0000:02                             
pci 0000:01:00.0:   IO window: disabled                                         
pci 0000:01:00.0:   MEM window: 0x1c000000-0x1c0fffff                           
pci 0000:01:00.0:   PREFETCH window: disabled                                   
NET: Registered protocol family 8                                               
NET: Registered protocol family 20                                              
Switching to clocksource MIPS                                                   
NET: Registered protocol family 2                                               
IP route cache hash table entries: 1024 (order: 0, 4096 bytes)                  
TCP established hash table entries: 2048 (order: 2, 16384 bytes)                
TCP bind hash table entries: 2048 (order: 1, 8192 bytes)                        
TCP: Hash tables configured (established 2048 bind 2048)                        
TCP reno registered                                                             
NET: Registered protocol family 1                                               
gptu: totally 6 16-bit timers/counters                                          
gptu: misc_register on minor 63                                                 
gptu: succeeded to request irq 118                                              
gptu: succeeded to request irq 119                                              
gptu: succeeded to request irq 120                                              
gptu: succeeded to request irq 121                                              
gptu: succeeded to request irq 122                                              
gptu: succeeded to request irq 123                                              
IFX DMA driver, version ifxmips_dma_core.c:v1.0.17                              
,(c)2009 Infineon Technologies AG                                               
Lantiq CGU driver, version 1.1.27, (c) 2001-2011 Lantiq Deutschland GmbH        
vpe1_mem = 0                                                                    
Wired TLB entries for Linux read_c0_wired() = 0                                 
squashfs: version 4.0 (2009/01/31) Phillip Lougher                              
Registering mini_fo version $Id$                                                
fuse init (API version 7.13)                                                    
msgmni has been set to 118                                                      
Line: 127, function: deu_init                                                   
DMA Referenced PAGE_SIZE = 4096                                                 
Infineon Technologies DEU driver version 2.0.0                                  
IFX DEU DES initialized (multiblock) (DMA).                                     
IFX DEU AES initialized (multiblock) (DMA).                                     
IFX DEU ARC4 initialized (multiblock) (DMA).                                    
IFX DEU SHA1 initialized (DMA).                                                 
IFX DEU MD5 initialized (DMA).                                                  
IFX DEU SHA1_HMAC initialized (DMA).                                            
IFX DEU MD5_HMAC initialized (DMA).                                             
io scheduler noop registered (default)                                          
ifx_pmu_init: Major 252                                                         
Lantiq PMU driver, version 1.2.2, (c) 2001-2011 Lantiq Deutschland GmbH         
Lantiq GPIO driver, version 1.2.14, (c) 2001-2011 Lantiq Deutschland GmbH       
Infineon Technologies RCU driver version 1.0.8                                  
Lantiq LED Controller driver, version 1.0.6, (c) 2001-2011 Lantiq Deutschland GH
Lantiq (VRX) DSL CPE MEI driver, version 1.4.4, (c) 2013 Lantiq Deutschland GmbH
ttyS0 at MMIO 0xbe100c00 (irq = 105) is a IFX_ASC                               
Register ASC (UART) to PMCU.                                                    
Lantiq ASC (UART) driver, version 1.0.9, (c) 2001-2011 Lantiq Deutschland GmbH  
brd: module loaded                                                              
loop: module loaded                                                             
Lantiq SSC driver, version 2.2.6, (c) 2001-2011 Lantiq Deutschland GmbH         
Register flash device:flash0                                                    
SPI Device: GD25Q64C 0xC8 (GD) 0x40 0x17                                        
Parameters: num sectors = 128, sector size = 65536, write size = 256            
7 cmdlinepart partitions found on MTD device ifx_sflash                         
Creating 7 MTD partitions on &quot;ifx_sflash&quot;:                                      
0x000000000000-0x000000020000 : &quot;boot&quot;                                          
0x000000020000-0x000000160000 : &quot;kernel&quot;                                        
0x000000160000-0x0000007c0000 : &quot;rootfs&quot;                                        
mtd: partition &quot;rootfs&quot; set to be root filesystem                               
0x0000007c0000-0x0000007d0000 : &quot;config&quot;                                        
0x0000007d0000-0x0000007e0000 : &quot;romfile&quot;                                       
0x0000007e0000-0x0000007f0000 : &quot;rom&quot;                                           
0x0000007f0000-0x000000800000 : &quot;radio&quot;                                         
Lantiq SPI flash driver, version 1.1.9, (c) 2001-2011 Lantiq Deutschland GmbH   
ifxmips_gpio: Pin ID 10 (port 0, pin 10) has been reserved by module SFLASH fro!
ifx_dataflash_init status error 255                                             
PPP generic driver version 2.4.2                                                
NET: Registered protocol family 24                                              
IFX SWITCH API, Version 1.1.7.2                                                 
SWAPI: Registered character device [switch_api] with major no [81]              
Switch API: PCE MicroCode loaded !!                                             
Init IFX_ETHSW_Switch_API_procModule successfully.                              
Switch Auto Polling value = 0                                                   
GPHY FW load for A2x !!                                                         
GPHY FIRMWARE LOAD SUCCESSFULLY AT ADDR : 410000                                
IFX GPHY driver GE Mode, version ifxmips_vr9_gphy: V0.9 - Firmware: 8434        
Registered led device: broadband_led                                            
Registered led device: internet_led                                             
Registered led device: usb1_link_led                                            
Registered led device: usb2_link_led                                            
Lantiq LED driver, version 1.0.17, (c) 2001-2011 Lantiq Deutschland GmbH        
Mirror/redirect action on                                                       
u32 classifier                                                                  
    Actions configured                                                          
Netfilter messages via NETLINK v0.30.                                           
nf_conntrack version 0.5.0 (947 buckets, 5120 max)                              
CONFIG_NF_CT_ACCT is deprecated and will be removed soon. Please use            
nf_conntrack.acct=1 kernel parameter, acct=1 nf_conntrack module option or      
sysctl net.netfilter.nf_conntrack_acct=1 to enable it.                          
ctnetlink v0.93: registering with nfnetlink.                                    
GRE over IPv4 tunneling driver                                                  
ip_tables: (C) 2000-2006 Netfilter Core Team                                    
TCP cubic registered                                                            
NET: Registered protocol family 10                                              
ip6_tables: (C) 2000-2006 Netfilter Core Team                                   
IPv6 over IPv4 tunneling driver                                                 
NET: Registered protocol family 17                            
                  
NET: Registered protocol family 15                                              
Bridge firewalling registered                                                   
Ebtables v2.0 registered                                                        
NET: Registered protocol family 8                                               
atmpvc_init() failed with -17                                                   
KOAM is loaded successfully.                                                    
802.1Q VLAN Support v1.8 Ben Greear &lt;greearb@candelatech.com&gt;                   
All bugs added by David S. Miller &lt;davem@redhat.com&gt;                            
VFS: Mounted root (squashfs filesystem) readonly on device 31:2.                
Freeing unused kernel memory: 184k freed                                        
starting pid 190, tty &#039;&#039;: &#039;/etc/init.d/rcS&#039;                                     
SCSI subsystem initialized                                                      
usbcore: registered new interface driver usbfs                                  
usbcore: registered new interface driver hub                                    
usbcore: registered new device driver usb                                       
Initializing USB Mass Storage driver...                                         
usbcore: registered new interface driver usb-storage                            
USB Mass Storage support registered.                                            
IFXUSB: ifxusb_hcd: version 3.2 B120208                                         
Chip Version :0002 BurstSize=4                                                  
IFXUSB: USB core #0 soft-reset                                                  
IFXUSB: USB core #0 soft-reset                                                  
ifxusb_hcd ifxusb_hcd: IFX USB Controller                                       
ifxusb_hcd ifxusb_hcd: new USB bus registered, assigned bus number 1            
ifxusb_hcd ifxusb_hcd: irq 54, io mem 0xbe101000                                
IFXUSB: Init: Power Port (0)                                                    
usb usb1: configuration #1 chosen from 1 choice                                 
hub 1-0:1.0: USB hub found                                                      
hub 1-0:1.0: 1 port detected                                                    
IFXUSB: USB core #1 soft-reset                                                  
IFXUSB: USB core #1 soft-reset                                                  
ifxusb_hcd ifxusb_hcd: IFX USB Controller                                       
ifxusb_hcd ifxusb_hcd: new USB bus registered, assigned bus number 2            
ifxusb_hcd ifxusb_hcd: irq 83, io mem 0xbe106000                                
IFXUSB: Init: Power Port (0)                                                    
usb usb2: configuration #1 chosen from 1 choice                                 
hub 2-0:1.0: USB hub found                                                      
hub 2-0:1.0: 1 port detected                                                    
dns_init                                                                        
domain_name:tplinkmodem.net                                                     
                                                                                
Please press Enter to activate this console. [ dm_readFile ] 2042:  can not opel
[ dm_loadCfg ] 2254:  software version is not match, in config, version = 0     
[ dm_readFile ] 2042:  can not open xml file /var/tmp/pc/default_config.xml!, al
[ parseConfigNode ] 522:  Meet unrecognized object node &quot;PhDDNSCfg&quot;, skip the ne
[ parseConfigNode ] 527:  Meet unrecognized parameter node &quot;PhDDNSCfg&quot;, skip the
[ parseConfigNode ] 522:  Meet unrecognized object node &quot;X_TPLINK_WANUSB3gLinkCe
[ parseConfigNode ] 522:  Meet unrecognized object node &quot;QueueManagement&quot;, skipe
[ parseConfigNode ] 522:  Meet unrecognized object node &quot;X_TPLINK_IPTVCfg&quot;, skie
[ parseConfigNode ] 522:  Meet unrecognized object node &quot;VoiceService&quot;, skip the
[ parseConfigNode ] 527:  Meet unrecognized parameter node &quot;VoiceService&quot;, skipe
[ parseConfigNode ] 522:  Meet unrecognized object node &quot;X_TPLINK_SpeedDialCfg&quot;e
[ parseConfigNode ] 522:  Meet unrecognized object node &quot;X_TPLINK_MultiIspDialPe
[ parseConfigNode ] 522:  Meet unrecognized object node &quot;X_TPLINK_CallLogCfg&quot;, e
[ freshLineState ] 606:  Can not open /dev/dsl_cpe_api for reading!             
[ freshLineState ] 606:  Can not open /dev/dsl_cpe_api for reading!             
Loading E5 (MII0/1) driver ...... MAC-0: 98-de-d0-ac-21-de                      
MAC-1: 98-de-d0-ac-21-df                                                        
Succeeded!                                                                      
PPE datapath driver info:                                                       
  Version ID: 64.3.3.1.0.1.1                                                    
  Family    : VR9                                                               
  DR Type   : Normal Data Path | Indirect-Fast Path                             
  Interface : MII0 | MII1                                                       
  Mode      : Routing                                                           
  Release   : 0.1.1                                                             
PPE 0 firmware info:                                                            
  Version ID: 7.1.5.1.0.33                                                      
  Family    : VR9                                                               
  FW Type   : Standard                                                          
  Interface : MII0/1 + PTM                                                      
  Mode      : reserved - 1                                                      
  Release   : 0.33                                                              
PPE 1 firmware info:                                                            
  Version ID: 7.2.1.6.2.0                                                       
  Family    : VR9                                                               
  FW Type   : Acceleration                                                      
  Interface : MII0 + MII1                                                       
  Mode      : Bridging + IPv4 Routing                                           
  Release   : 2.0                                                               
IFXOS, Version 1.5.14 (c) Copyright 2009, Lantiq Deutschland GmbH               
                                                                                
                                                                                
Lantiq CPE API Driver version: DSL CPE API V4.16.6-pd1                          
                                                                                
Predefined debug level: 3                                                       
ifx_ppa_api: module license &#039;unspecified&#039; taints kernel.                        
Disabling lock debugging due to kernel taint                                    
PPA API --- init successfully                                                   
ifx_ppa_init - init succeeded                                                   
wlan0     no private ioctls.                                                    
                                                                                
wlan0.0   no private ioctls.                                                    
                                                                                
wlan0.0   no private ioctls.                                                    
                                                                                
ath0      no private ioctls.                                                    
                                                                                
ath2      no private ioctls.                                                    
                                                                                
ath2      no private ioctls.                                                    
                                                                                
sendto: No such file or directory                                               
send 2001 error 251, -1                                                         
[ oal_sys_getOldTZInfo ] 330:  Open TZ file error!                              
ioctl: No such device                                                           
device eth0 entered promiscuous mode                                            
br0: port 1(eth0) entering forwarding state                                     
[ rsl_initLanIgmpSnoopObj ] 181:  We need vlan if we want igmp snooping         
ath0      no private ioctls.                                                    
                                                                                
ath1      no private ioctls.                                                    
                                                                                
wlan0     no private ioctls.                                                    
                                                                                
device eth0 left promiscuous mode                                               
br0: port 1(eth0) entering disabled state                                       
device eth0.2 entered promiscuous mode                                          
device eth0 entered promiscuous mode                                            
br0: port 1(eth0.2) entering forwarding state                                   
device eth0.3 entered promiscuous mode                                          
br0: port 2(eth0.3) entering forwarding state                                   
device
 eth0.4 entered promiscuous mode                                          
br0: port 3(eth0.4) entering forwarding state                                   
device eth0.5 entered promiscuous mode                                          
br0: port 4(eth0.5) entering forwarding state                                   
*********cal_data*******                                                        
a55a00000000000000000000*********end*******                                     
ath_hal: 0.9.17.1 (AR5212, AR5416, AR9380, RF5111, RF5112, RF2413, RF5413, RF23)
ath_rate_atheros: Copyright (c) 2001-2005 Atheros Communications, Inc, All Righd
ath_dfs: Version 2.0.0                                                          
Copyright (c) 2005-2006 Atheros Communications, Inc. All Rights Reserved        
ath_dev: Copyright (c) 2001-2007 Atheros Communications, Inc, All Rights Reservd
ath_pci: 9.2.0_U10.1020 (Atheros/multi-bss)                                     
__ath_attach: Set global_scn[0]                                                 
ACBKMinfree = 48                                                                
ACBEMinfree = 32                                                                
ACVIMinfree = 16                                                                
ACVOMinfree = 0                                                                 
CABMinfree = 48                                                                 
UAPSDMinfree = 0                                                                
                                                                                
@@@@@@@@@@@@@devid = ff1c@@@@@@@@                                               
                                                                                
@@@@@@@@@@@@@devid = 2e@@@@@@@@                                                 
CalData[0] = 0xa5                                                               
CalData[1] = 0x5a                                                               
CalData[2] = 0x0                                                                
CalData[3] = 0x0                                                                
CalData[4] = 0x0                                                                
CalData[5] = 0x3                                                                
CalData[6] = 0x60                                                               
CalData[7] = 0x0                                                                
CalData[8] = 0x16                                                               
CalData[9] = 0x8c                                                               
CalData[10] = 0x0                                                               
CalData[11] = 0x2d                                                              
CalData[12] = 0x60                                                              
CalData[13] = 0x8                                                               
CalData[14] = 0x0                                                               
CalData[15] = 0x1                                                               
CalData[16] = 0x2                                                               
CalData[17] = 0x80                                                              
CalData[18] = 0x60                                                              
CalData[19] = 0x2c                                                              
CalData[20] = 0x16                                                              
CalData[21] = 0x8c                                                              
CalData[22] = 0xa1                                                              
CalData[23] = 0x99                                                              
CalData[24] = 0x50                                                              
CalData[25] = 0x0                                                               
CalData[26] = 0x16                                                              
CalData[27] = 0x8c                                                              
CalData[28] = 0x0                                                               
CalData[29] = 0x2e                                                              
CalData[30] = 0x50                                                              
CalData[31] = 0x8                                                               
CalData[32] = 0x0                                                               
CalData[33] = 0x1                                                               
CalData[34] = 0x2                                                               
CalData[35] = 0x80                                                              
CalData[36] = 0x50                                                              
CalData[37] = 0x2c                                                              
CalData[38] = 0x16                                                              
CalData[39] = 0x8c                                                              
CalData[40] = 0xa1                                                              
CalData[41] = 0x99                                                              
CalData[42] = 0x50                                                              
CalData[43] = 0x64                                                              
CalData[44] = 0x8c                                                              
CalData[45] = 0xc0                                                              
CalData[46] = 0x5                                                               
CalData[47] = 0x4                                                               
CalData[48] = 0x57                                                              
CalData[49] = 0xc                                                               
CalData[50] = 0x3f                                                              
CalData[51] = 0x1                                                               
CalData[52] = 0x22                                                              
CalData[53] = 0x0                                                               
CalData[54] = 0x50                                                              
CalData[55] = 0x6c                                                              
CalData[56] = 0x3c                                                              
CalData[57] = 0x11                                                              
CalData[58] = 0x0                                                               
CalData[59] = 0x3                                                               
CalData[60] = 0x40                                                              
CalData[61] = 0x4                                                               
CalData[62] = 0x5                                                               
CalData[63] = 0xb                                                               
CalData[64] = 0x0                                                               
CalData[65] = 0x4a                                                              
CalData[66] = 0x40                                                              
CalData[67] = 0x74                                                              
CalData[68] = 0x0                                                               
CalData[69] = 0x3                                                               
CalData[70] = 0x0                                                               
CalData[71] = 0x0                                                               
CalData[72] = 0x40                                                              
CalData[73] = 0x0                                                               
CalData[74] = 0x50                                                              
CalData[75] = 0x1                                                               
CalData[76] = 0x1                                                               
CalData[77] = 0xc2                                                              
CalData[78] = 0x60                                                              
CalData[79] = 0x34                                                              
CalData[80] = 0x0                                                               
CalData[81] = 0x44                                                              
CalData[82] = 0x0                                                               
CalData[83] = 0x0                                                               
CalData[84] = 0x51                                                              
CalData[85] = 0xc                                                               
CalData[86] = 0x20                                                              
CalData[87] = 0x10                                                              
CalData[88] = 0x0                                                               
CalData[89] = 0x6                                                               
CalData[90] = 0x51                                                              
CalData[91] = 0x64                                                              
CalData[92] = 0x14                                                              
CalData[93] = 0x12                                                              
CalData[94] = 0xff                                                              
CalData[95] = 0x24                                                              
CalData[96] = 0x51                                                              
CalData[97] = 0x68                                                              
CalData[98] = 0x17                                                              
CalData[99] = 0xff      
                                                        
CalData[100] = 0x0                                                              
CalData[101] = 0x15                                                             
CalData[102] = 0x50                                                             
CalData[103] = 0x68                                                             
CalData[104] = 0x20                                                             
CalData[105] = 0x10                                                             
CalData[106] = 0x0                                                              
CalData[107] = 0x19                                                             
CalData[108] = 0xff                                                             
CalData[109] = 0xff                                                             
CalData[110] = 0xff                                                             
CalData[111] = 0xff                                                             
CalData[112] = 0xff                                                             
CalData[113] = 0xff                                                             
CalData[114] = 0xff                                                             
CalData[115] = 0xff                                                             
CalData[116] = 0xff                                                             
CalData[117] = 0xff                                                             
CalData[118] = 0xff                                                             
CalData[119] = 0xff                                                             
CalData[120] = 0xff                                                             
CalData[121] = 0xff                                                             
CalData[122] = 0xff                                                             
CalData[123] = 0xff                                                             
CalData[124] = 0xff                                                             
CalData[125] = 0xff                                                             
CalData[126] = 0xff                                                             
CalData[127] = 0xff                                                             
CalData[128] = 0xff                                                             
CalData[129] = 0xff                                                             
CalData[130] = 0xff                                                             
CalData[131] = 0xff                                                             
CalData[132] = 0xff                                                             
CalData[133] = 0xff                                                             
CalData[134] = 0xff                                                             
CalData[135] = 0xff                                                             
CalData[136] = 0xff                                                             
CalData[137] = 0xff                                                             
CalData[138] = 0xff                                                             
CalData[139] = 0xff                                                             
CalData[140] = 0xff                                                             
CalData[141] = 0xff                                                             
CalData[142] = 0xff                                                             
CalData[143] = 0xff                                                             
CalData[144] = 0xff                                                             
CalData[145] = 0xff                                                             
CalData[146] = 0xff                                                             
CalData[147] = 0xff                                                             
CalData[148] = 0xff                                                             
CalData[149] = 0xff                                                             
CalData[150] = 0xff                                                             
CalData[151] = 0xff                                                             
CalData[152] = 0xff                                                             
CalData[153] = 0xff                                                             
CalData[154] = 0xff                                                             
CalData[155] = 0xff                                                             
CalData[156] = 0xff                                                             
CalData[157] = 0xff                                                             
CalData[158] = 0xff                                                             
CalData[159] = 0xff                                                             
CalData[160] = 0xff                                                             
CalData[161] = 0xff                                                             
CalData[162] = 0xff                                                             
CalData[163] = 0xff                                                             
CalData[164] = 0xff                                                             
CalData[165] = 0xff                                                             
CalData[166] = 0xff                                                             
CalData[167] = 0xff                                                             
CalData[168] = 0xff                                                             
CalData[169] = 0xff                                                             
CalData[170] = 0xff                                                             
CalData[171] = 0xff                                                             
CalData[172] = 0xff                                                             
CalData[173] = 0xff                                                             
CalData[174] = 0xff                                                             
CalData[175] = 0xff                                                             
CalData[176] = 0xff                                                             
CalData[177] = 0xff                                                             
CalData[178] = 0xff                                                             
CalData[179] = 0xff                                                             
CalData[180] = 0xff                                                             
CalData[181] = 0xff                                                             
CalData[182] = 0xff                                                             
CalData[183] = 0xff                                                             
CalData[184] = 0xff                                                             
CalData[185] = 0xff                                                             
CalData[186] = 0xff                                                             
CalData[187] = 0xff                                                             
CalData[188] = 0xff                                                             
CalData[189] = 0xff                                                             
CalData[190] = 0xff                                                             
CalData[191] = 0xff                                                             
CalData[192] = 0xff                                                             
CalData[193] = 0xff                                                             
CalData[194] = 0xff                                                             
CalData[195] = 0xff                                                             
CalData[196] = 0xff                                                             
CalData[197] = 0xff                                                             
CalData[198] = 0xff                                                             
CalData[199] = 0xffdfs_attach: use DFS enhancements                             
DFS min filter rssiThresh = 18                                                  
DFS max pulse dur = 151 ticks                                                   
ath_get_caps[5105] rx chainmask mismatch actual 3 sc_chainmak 0                 
ath_get_caps[5080] tx chainmask mismatch actual 3 sc_chainmak 0                 
Register wlan WPS function, dev=0x82e8c000                                      
Register wlan button on function                                                
Register wlan button off function                                               
wifi0: Atheros ???: mem=0x1c000000, irq=136 hw_base=0xbc000000                  
ath_netdev_set_macaddr: ffffff98:ffffffde:ffffffd0:ffffffac:21:ffffffde         
ni aponly is null!                                                              
wlan_vap_create : enter. devhandle=0x82e8c2c0, opmode=IEEE80211_M_HOSTAP, flags1
wlan_vap_create : exit. devhandle=0x82e8c2c0, opmode=IEEE80211_M_HOSTAP, flags=.
VAP device ath0 created                                                         
ath0                                                                            
wlan_vap_create : enter. devhandle=0x82e8c2c0, opmode=IEEE80211_M_STA, flags=0x3
wlan_vap_create : exit. devhandle=0x82e8c2c0, opmode=IEEE80211_M_STA, flags=0x3.
VAP device ath1 created                                                         
ath1                                                                            
wlan_vap_create : enter. devhandle=0x82e8c2c0, opmode=IEEE80211_M_HOSTAP, flags1
wlan_vap_create : exit. devhandle=0x82e8c2c0, opmode=IEEE80211_M_HOSTAP, flags=.
VAP device ath2 created                                                         
ath2                                      
                                      
                                                                                
 DES SSID SET=TP-LINK_2.4GHz_AC21DE                                             
DFS min filter rssiThresh = 15                                                  
DFS max pulse dur = 151 ticks                                                   
ni aponly is null!                                                              
WARNING: Fragmentation with HT mode NOT ALLOWED!!                               
Error for wireless request &quot;Set Fragmentation Threshold&quot; (8B24) :               
    SET failed on device ath0 ; Invalid argument.                               
                                                                                
 DES SSID SET=TP-LINK_Guest_2.4GHz                                              
Reading topology file /var/Wireless/2_4G_topology.conf ...                      
015.570: Reading radio configuration file /var/Wireless/2_4G_80211g.ap_radio ...
                                                                                
015.571: Reading bss configuration file /var/Wireless/ath0.ap_bss ...           
                                                                                
 ieee80211_ioctl_siwmode: imr.ifm_active=131712, new mode=3, valid=1            
Using interface ath0 with hwaddr 98:de:d0:ac:21:de and ssid &#039;TP-LINK_2.4GHz_AC2&#039;
                                                                                
 DES SSID SET=TP-LINK_2.4GHz_AC21DE                                             
015.887: upnp_wps_device_init called                                            
l2_packet_receive - recvfrom: Network is down                                   
ni aponly is null!                                                              
 Scan in progress.. Cancelling it                                               
l2_packet_receive - recvfrom: Network is down                                   
device ath0 entered promiscuous mode                                            
device ath1 entered promiscuous mode                                            
brctl: bridge br0: Device or resource busy                                      
device ath2 entered promiscuous mode                                            
[4294684846] mtlk0(mtlk_cdev_init:355): Max nodex set to 1048575                
[4294686546] mtlk0(__mtlk_print_endianess:4724): The system is Big endian (0xbe)
[4294686546] mtlk0(mtlk_fast_mem_print_info:114): Using normal memory for hot ct
[4294686556] mtlk0(_mtlk_df_user_alloc_devname:8341): NDEV Name pattern: wlan%d 
[4294686566] mtlk0(mtlk_core_pdb_fast_handles_open:42): Open Hot-path parameters
mtlk 0000:00:0e.0: firmware: requesting cal_wlan0.bin                           
[4294686846] mtlk&lt;3&gt;(_mtlk_df_fw_request_firmware:63): Firmware (cal_wlan0.bin)g
mtlk 0000:00:0e.0: firmware: requesting ap_upper_wave300.bin                    
mtlk 0000:00:0e.0: firmware: requesting contr_lm.bin                            
ni aponly is null!                                                              
[4294687806] mtlk0(_mtlk_core_start:3451): CID-0000: ap_upper_wave300.bin: @@@ @
contr_lm.bin: @@@ VERSION INFO @@@ version number: FW_3.4.2_r3444 MIPS:  Lower @
                                                                                
[4294687866] mtlk0(mtlk_eeprom_check_ee_data:1353): Options mask is 0x00        
[4294687876] mtlk0(load_default_hw_table:2119): HW configuration is 3X3         
[4294687896] mtlk0(_mtlk_df_user_ppa_register:541): PPA device function is regi)
[4294687916] mtlk0(_mtlk_core_mbss_add_vap:7425): CID-0000: Got PRM_ID_VAP_ADD  
[4294687926] mtlk0(_mtlk_df_user_alloc_devname:8341): NDEV Name pattern: wlan0.0
[4294687936] mtlk0(mtlk_core_pdb_fast_handles_open:42): Open Hot-path parameters
[4294687936] mtlk0(_mtlk_core_start:3451): CID-0001: ap_upper_wave300.bin: @@@ @
contr_lm.bin: @@@ VERSION INFO @@@ version number: FW_3.4.2_r3444 MIPS:  Lower @
                                                                                
[4294687986] mtlk0(_mtlk_core_mbss_add_vap:7443): CID-0000: VAP#1 added         
device wlan0 entered promiscuous mode                                           
brctl: iface lq1: No such device                                                
device wlan0.0 entered promiscuous mode                                         
sendto: No such file or directory                                               
send 2030 error 251, -1                                                         
[ oal_startUPnP ] 352:  TD-W9980, TD-W9980                                      
                                                                                
sendto: No such file or directory                                               
send 2004 error 251, -1                                                         
sendto: No such file or directory                                               
send 2004 error 251, -1                                                         
sendto: No such file or directory                                               
send 2004 error 251, -1</code></pre></div><p>Many Thanks,<br />Paul</p>											<p class="post-edited">(Last edited by <strong>nobodydoesITbetter</strong> on 13 Oct 2016, 12:17)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p342804">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mkresin</div>
					<div class="post-datetime">
						2 Nov 2016, 15:30					</div>
				</div>
				<div class="post-content content">
					<p>The installation instructions in the wiki are rubbish. The u-boot.asc shouldn&#039;t be required to install OpenWrt. The stock TP-Link uboot should have the same commands.</p><p>The u-boot.asc is meant to be used to install a backup of the TP-Link uboot in case one has managed to purge the stock TP-Link uboot from flash.</p><p>You better use the <a href="https://downloads.openwrt.org/snapshots/trunk/lantiq/xrx200/openwrt-lantiq-xrx200-TDW8980-squashfs-sysupgrade.bin">TDW8980 image from the current development tree</a>. The TDW8970 image doesn&#039;t have support for the wifi used on the TDW8980/TDW9980.</p><p>But since we already know that your board revision of the TDW9980 uses the GD25Q64C SPI Flash chip in contrast to the cFeon Q64-104HIP or Winbond 25Q64FVSIG used before, you might better compile an initramfs image by your self. </p><p>Boot this initramfs from ram as described in <a href="https://wiki.openwrt.org/toh/tp-link/td-w8970#installation">https://wiki.openwrt.org/toh/tp-link/td  stallation</a> to make sure that OpenWrt supports this new flash chip (partitions should be found during boot).</p><p>Please follow the installation procedure described in the TDW8970 wiki article to install OpenWrt on your TDW9980. It is the best (least error prone) way to install OpenWrt on your board. In case the GD25Q64C SPI Flash chip isn&#039;t supported the sysupgrade will fail anyway.</p><p>If it works this way for you, would you please remove the installation guide from the TDW9980 wiki article and <strong>link </strong> to the installation instruction of the TDW8970 wiki article.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p343216">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">HellFire</div>
					<div class="post-datetime">
						7 Nov 2016, 16:23					</div>
				</div>
				<div class="post-content content">
					<p>Thanks, I&#039;ve just flashed OpenWrt on my W8980 using the W8970 instructions (without flashing uboot).<br />I couldn&#039;t figure out how to get a uboot image built for testing, but as mine has the Winbond flash, I just flashed it directly and it boots.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p343277">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mkresin</div>
					<div class="post-datetime">
						8 Nov 2016, 09:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>HellFire wrote:</cite><blockquote><p>I couldn&#039;t figure out how to get a uboot image built for testing</p></blockquote></div><p>No uboot image, a initramfs image. You have to select in menuconfig:</p><div class="codebox"><pre><code>Target Images  ---&gt; [*] ramdisk</code></pre></div><p>Would you please update the W8980 wiki article and add a few words to the installation section. Basically that the W8970 installation instructions should be used.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>