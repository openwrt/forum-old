<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Bridged Client mode (not WDS, not routed/NAT) - Howto</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							between 18 Apr 2018 and 5 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=1078&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			
		
		
			<article class="post" id="p6432">
				<div class="post-metadata">
					<div class="post-num">Post #26</div>
					<div class="post-author">login_denied</div>
					<div class="post-datetime">
						24 Apr 2005, 19:54					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>acidbits wrote:</cite><blockquote><p>I did the tests myself. You get the same bandwith using &quot;client in breaked bridge mode (mode=sta)&quot;&nbsp; and &quot;client in bridged mode (mode=wet)&quot;. I used a Dlink-900AP as an AP (802.11b) and configured a WRT54G as client in the two different ways:</p><p>[http://woz.gs/wifi/openwrtbridge.html ]<br />wl0_mode=wet<br />lan_ifname=br0<br />...</p><p>[<a href="http://openwrt.org/ClientModeHowto">http://openwrt.org/ClientModeHowto</a>]<br />wl0_mode=sta<br />nvram set lan_ifname=vlan0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />nvram set wifi_ifname=eth1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />...</p><p>In the two configurations I used Iperf to test the bandwith and always had the same result: 5 Mbit/sec<br />The bandwith didn&#039;t decrease as I exepected.</p></blockquote></div><p>I followed [<a href="http://openwrt.org/ClientModeHowto">http://openwrt.org/ClientModeHowto</a>], but i can only ping my PCs behind the WRT. Looks like that there are some residual declarations from tryings before. Do you have a list a complete setting?</p>											<p class="post-edited">(Last edited by <strong>login_denied</strong> on 24 Apr 2005, 21:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6446">
				<div class="post-metadata">
					<div class="post-num">Post #27</div>
					<div class="post-author">acidbits</div>
					<div class="post-datetime">
						25 Apr 2005, 09:28					</div>
				</div>
				<div class="post-content content">
					<p>Sadly I have to say that works the same way to me. I posted the results done at home with a very simple setup and didn&#039;t notice those problems. When I set the WRT54G in the WLAN (25 WRT54G behind this one) I had exactly the same problems. </p><p>It looks like this setup works fine if there&#039;s only 1 PC connected to the WRT54G&#039;s LAN ports. Right now I have one WRT54G configured in client-wet mode at home with 1 PC connected at it and it works right. If I connect another one problems come up.</p><p>Had no time to work on this because I have a much serious problem with a WRT54G in AP mode that crashes on heavy traffic transfers. Once I got this fixed I&#039;ll go again on the client-wet mode, I guess there&#039;s something to do with ARP, maybe have to tell WRT54G to modify the routing, to put there a static ARP routing or something like this. </p><p>I&#039;m&nbsp; considering to use some kind of tunneling between them, this way you can set as many NATs as you need in the WLAN and it would be transparent to them. Looked at OpenVPN but it takes too much WRT54G&#039;s CPU usage and you get less bandwith, need to find a tunneling without cypher cause I don&#039;t need that level of security, the underlying WEP is enough. Don&#039;t want to configure a VPN in each PC, WRT54G should manage the tunneling.</p><p>I know this is not easy to apply to a small WLAN and that would be more reliable to have an easy way to solve this.</p><p>Any expert can help us on this?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6514">
				<div class="post-metadata">
					<div class="post-num">Post #28</div>
					<div class="post-author">nieslpriem</div>
					<div class="post-datetime">
						27 Apr 2005, 16:13					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><blockquote><p><strong>muchod wrote:</strong><br />1.- I can&#039;t telnet or ping the wrt54g from the main lan, but I can telnet and ping the pc&#039;s behind the wrt54g from the main lan. Sometimes the ping or the telnet works and I can see the telnet login screen or some ping responses. But the ping looses practically all the packets. No problems with pings to hosts behind the bridge. Also not problems connecting to the bridge from the pcs directly conected to it.</p></blockquote></div><p>Has someone found a solution for this problem?</p><p>I have a simple test-setup right now:</p><p>-------LAN-------&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Notebook<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I<br />&nbsp; &nbsp;WRT54GS&nbsp; &nbsp;&lt;=======&gt;&nbsp; WRT54GS<br />&nbsp; (in AP mode)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(in WET mode)</p><p>Now my PING/ICMP tests that I have done so far:</p><p>from&nbsp; \&nbsp; to I&nbsp; LAN&nbsp; &nbsp; &nbsp;AP&nbsp; &nbsp;WET&nbsp; &nbsp;Notebook<br />------------+--------------------------------<br />LAN&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I&nbsp; &nbsp; &nbsp;-&nbsp; &nbsp; &nbsp; OK&nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OK<br />AP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I&nbsp; &nbsp;OK&nbsp; &nbsp; &nbsp; -&nbsp; &nbsp; &nbsp; &nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OK<br />WET&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;I&nbsp; &nbsp;OK&nbsp; &nbsp; &nbsp;OK&nbsp; &nbsp; &nbsp; -&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OK<br />Notebook&nbsp; I&nbsp; &nbsp;OK&nbsp; &nbsp; &nbsp;OK&nbsp; &nbsp; OK&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -</p><p>where:<br />&nbsp; &nbsp; &nbsp;OK&nbsp; &nbsp; &nbsp;means, that PINGs are going through without problems<br />&nbsp; &nbsp; &nbsp; &nbsp;-&nbsp; &nbsp; &nbsp; n.a. (loopback)<br />&nbsp; &nbsp; &nbsp; *&nbsp; &nbsp; &nbsp; means, that about 85% of the PING/ICMP packages are not OK, and no answers are received</p><p>Looks weird to me, and I have no idea. /etc/init.d/S45firewall ist disabled - so definitely no firewall rules are killing the ICMPs.</p><p>Seems to be the same problem as <strong>muchod</strong>&#039;s - has someone any idea?</p><p>TIA<br />Daniel</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6619">
				<div class="post-metadata">
					<div class="post-num">Post #29</div>
					<div class="post-author">hutchman</div>
					<div class="post-datetime">
						30 Apr 2005, 20:41					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve been reading this bridge thread and researching WDS.&nbsp; All I really want to do is connect two wired networks in different buildings with a wireless bridge just like I used to do with the Linksys WAP11.&nbsp; With the WAP11, I select bridge and put in the MAC of the other device.&nbsp; </p><p>Can&#039;t OpenWRT and the WRT54GS do this?&nbsp; Everything I&#039;ve read so far always connects to an AP.&nbsp; I really don&#039;t want an AP in this case .... I just want to connect the wired network in each building to the LAN ports and use the wireless interface as a bridge between the two buildings with two WRT54GS.</p><p>How can I do this with OpenWRT?</p><p>Thanks,</p><p>Brian</p><p>P.S. by the way, I&#039;m typing this via the <a href="http://woz.gs/wifi/openwrtbridge.html">http://woz.gs/wifi/openwrtbridge.html</a> setup and I&#039;m not seeing the ping problems others talked about.&nbsp; I can ping any machine (including the two wrt54gs) on the network.&nbsp; I built from CVS just the other day.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6626">
				<div class="post-metadata">
					<div class="post-num">Post #30</div>
					<div class="post-author">NathanA</div>
					<div class="post-datetime">
						1 May 2005, 03:08					</div>
				</div>
				<div class="post-content content">
					<p>Hey, guys.</p><p>I&#039;d be surprised if there is a way to get true &quot;client-mode bridging&quot; to work without some kind of layer 3/proxy-ARP-esque solution.&nbsp; I believe that the problems that people are seeing with this method of wireless bridging has to do with a limitation in the 802.11 spec, and is not specifically a limitation of the WRT54G hardware or the OpenWRT software.&nbsp; Basically, as I understand it, an AP knows where to send a packet to by looking at the MAC addresses that clients used to identify themselves TO the AP when they registered/associated with it.&nbsp; So, if the wireless client identifies itself with its own MAC and then tries to &quot;bridge&quot; ethernet traffic over to the AP, the AP is going to be receiving ethernet frames which bear MAC addresses that are different from the one that the AP knows the wireless client by.&nbsp; If someone else connected to the AP tries to send traffic to one of the devices plugged into the &quot;client bridge&quot;, it will prepare an ethernet frame with the target MAC address being the device it wants to talk to, *not* the wireless client.&nbsp; Once that packet reaches the AP, it doesn&#039;t know what to do with it because there ARE no clients associated to it with that MAC address.&nbsp; The associated stations list *IS* the AP&#039;s learn table.&nbsp; In some cases/implementations, the AP may not even bother accepting packets from a wireless client to begin with if the MAC in the ethernet frames it is receiving from it does not match the MAC that the client used to identify itself by to the AP during association.</p><p>I work for a wireless ISP, and the equipment that we use to connect our clients to the APs on our towers have solved this dilemma in one of two ways, traditionally:</p><p>1) The wireless client &quot;clones&quot; the MAC of the first ethernet device it sees behind it, associates to the AP using that MAC, and then bridges traffic back-and-forth between the AP and that ethernet device ONLY.&nbsp; If it sees the MAC change on its ethernet interface (either because someone plugged in a different device or because there are multiple devices behind it), it will re-associate using the new MAC so that it can bridge traffic to THAT device.</p><p>2) The wireless client associates to the AP using its own MAC and then does what we like to call &quot;MAC-NAT&quot;: it maintains an internal layer 2 &quot;NAT&quot; table that maps this IP address to this MAC address, and then re-writes the ethernet frames as they&#039;re going out to the AP so that they all look like they&#039;re coming from the wireless device itself.&nbsp; When a packet comes in bound for a certain IP address, it consults its &quot;MAC-NAT learn table&quot; to detemine which host on the ethernet side of the bridge the packet should go to, and re-writes the packet accordingly before sending it on.</p><p>Neither of these are truly &quot;ethernet bridges.&quot;</p><p>From the sounds of it, the Linux bridge device coupled with the Broadcom wireless driver in client mode is doing something similar to #1 above; that&#039;s the only way I&#039;m able to explain why pings come back from all hosts, but only from one-at-a-time.&nbsp; It&#039;d be interesting to see what is going on during these &quot;ping tests&quot; from the AP&#039;s perspective: is the MAC of the WRT54G &quot;changing&quot; to match the MAC of the host that you are seeing ping responses from at that given instant?</p><p>I don&#039;t know too terribly much about WDS itself (it&#039;s something we&#039;ve never felt the urge to put into production anywhere on our network; our backhauls use more robust wireless solutions, and 802.11 is simply the &quot;last-mile&quot; hop to the customer), but I&#039;d guess that it was drafted up precisely because bridging devices behind an 802.11 client -- with the way the standard is written up -- simply doesn&#039;t work without some magic involved, and so another solution for effective &quot;wireless bridging&quot; was needed.&nbsp; Thus, if you want a REAL ethernet bridge over 802.11 links, you&#039;ll have to go with WDS.&nbsp; Otherwise, if you want multiple hosts behind the client bridge, you&#039;ll need to set up Proxy-ARP and use it as your &quot;MAC-NAT&quot; solution.</p><p>Hope this helps,</p><p>-- Nathan</p>											<p class="post-edited">(Last edited by <strong>NathanA</strong> on 1 May 2005, 03:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6638">
				<div class="post-metadata">
					<div class="post-num">Post #31</div>
					<div class="post-author">nieslpriem</div>
					<div class="post-datetime">
						1 May 2005, 09:30					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hutchman wrote:</cite><blockquote><p>I&#039;ve been reading this bridge thread and researching WDS.&nbsp; All I really want to do is connect two wired networks in different buildings with a wireless bridge just like I used to do with the Linksys WAP11.&nbsp; With the WAP11, I select bridge and put in the MAC of the other device.&nbsp; </p><p>Can&#039;t OpenWRT and the WRT54GS do this?&nbsp; Everything I&#039;ve read so far always connects to an AP.&nbsp; I really don&#039;t want an AP in this case .... I just want to connect the wired network in each building to the LAN ports and use the wireless interface as a bridge between the two buildings with two WRT</p><p>How can I do this with OpenWRT?</p></blockquote></div><p>This is the question. I haven&#039;t solved tzhe problem yet. But I have done some more investigation - and it seems also, that pings to and from the two bridged wired networks are behaving &quot;asynchonously&quot;.</p><p>Pinging from the net behind the &quot;WET&quot; configured bridge (using ping&#039;s or flood ping&#039;s) gets about 100% of the answers back. Pinging from the network behind the &quot;AP&quot; configured bridge looses about 2-4% of the packets (don&#039;t know if the pings are lost, or the answers).</p><p>I also have exchagend the Notebook in my original configuration with a &quot;real PC&quot; (and Linux) - because I believed, that maybe the Notebook looses some packet (I never trust Notebooks with Windows ;-)</p><p>This is really strange.</p><div class="quotebox"><cite>hutchman wrote:</cite><blockquote><p>P.S. by the way, I&#039;m typing this via the <a href="http://woz.gs/wifi/openwrtbridge.html">http://woz.gs/wifi/openwrtbridge.html</a> setup and I&#039;m not seeing the ping problems others talked about.&nbsp; I can ping any machine (including the two wrt54gs) on the network.&nbsp; I built from CVS just the other day.</p></blockquote></div><p>I believe you - from behind the WET-bridge it&#039;s really easy to work - but from behind the AP, TCP sessions allways &quot;stall&quot; for half a second or so - which seems to be a problem of the 2-4% packets lost.</p><p>Can you be more specific about your configuration - maybe PM - I&#039;m really interested. Which WRT&#039;s are you using? Version? OpenWrt Version/Build? IP network configuration? .....</p><p>Does anybody know of another configuration I can try? Is it possible, to put both WRT54GS into WET-mode, and connect them with &quot;infra=0&quot; (peer-to-peer mode) - maybe this would solve my problems?</p><p>TIA<br />Daniel</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6714">
				<div class="post-metadata">
					<div class="post-num">Post #32</div>
					<div class="post-author">nieslpriem</div>
					<div class="post-datetime">
						3 May 2005, 00:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>I wrote:</cite><blockquote><p>Does anybody know of another configuration I can try? Is it possible, to put both WRT54GS into WET-mode, and connect them with &quot;infra=0&quot; (peer-to-peer mode) - maybe this would solve my problems?</p></blockquote></div><p>So tried this - works, but same problem - so I switched back to WDS - which works fine now.</p><p>Bye<br />Daniel</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6715">
				<div class="post-metadata">
					<div class="post-num">Post #33</div>
					<div class="post-author">NathanA</div>
					<div class="post-datetime">
						3 May 2005, 00:35					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nieslpriem wrote:</cite><blockquote><p>So tried this - works, but same problem - so I switched back to WDS - which works fine now.</p></blockquote></div><p>Like I said above... <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; 802.11 &quot;client-mode&quot; bridging (as in, real bridging) will never work correctly because of 802.11.</p><p>-- Nathan</p>											<p class="post-edited">(Last edited by <strong>NathanA</strong> on 3 May 2005, 00:36)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6762">
				<div class="post-metadata">
					<div class="post-num">Post #34</div>
					<div class="post-author">acidbits</div>
					<div class="post-datetime">
						4 May 2005, 12:32					</div>
				</div>
				<div class="post-content content">
					<p>Ok I finally found a way to make it work. :-)</p><p>In my tests at home I have this layout:</p><p>Home network: 192.168.1.0/24</p><p>AP (Linksys DWL 900+): 192.168.1.10</p><p>[Wired to 192.168.1.10 (AP)]<br />DSL-router: 192.168.1.1<br />PC1 (Windows 98): 192.168.1.2<br />Server1 (Debian): 192.168.1.3<br />Server2 (Debian): 192.168.1.6</p><p>Wireless client in &quot;acidbits&#039; mode&quot; (WRT54G): 192.168.1.61 (eth1) &amp; 192.168.1.60 (vlan0)</p><p>[Wired to 192.168.1.60 (WRT54G LAN Ports)]<br />PC2 (WinXP): 192.168.1.33<br />Laptop (Ubuntu): 192.168.1.233</p><p>Here we go. What I did is to &quot;break the bridge&quot; and put each of the Interfaces in the same &quot;home subnet&quot;:</p><div class="codebox"><pre><code>nvram set lan_ifname=vlan0              #  &quot;vlan2&quot; on hardware version 1
nvram set wifi_ifname=eth1              #  &quot;eth2&quot; on hardware version 1
# Config ifaces
nvram set lan_proto=static 
nvram set lan_ipaddr=192.168.1.60
nvram set lan_netmask=255.255.255.0
nvram set lan_dns=80.58.0.33
nvram unset lan_gateway
nvram set wifi_proto=static
nvram set wifi_ipaddr=192.168.1.61
nvram set wifi_netmask=255.255.255.0
nvram unset wifi_gateway
# Client mode
nvram set wl0_mode=sta
# WiFi Settings
nvram set wl0_ssid=aCiDBiTS-home
nvram set wl0_wep=disabled</code></pre></div><p>Make sure your firewall doesn&#039;t makes any MASQUERADE, for testing purposes you can disable it. In /etc/init.d/ I set this script named S70routing:</p><div class="codebox"><pre><code>#!/bin/sh

#Enable proxy_arp for each interface, so WRT54G eth1 and vlan0 allow packets 
#going to other IPs than themselves (192.168.1.60 &amp; 192.168.1.61)

echo &quot;1&quot; &gt; /proc/sys/net/ipv4/conf/vlan0/proxy_arp
echo &quot;1&quot; &gt; /proc/sys/net/ipv4/conf/eth1/proxy_arp

#Tell him in which Interface is the gateway:

route add default gw 192.168.1.1 dev eth1

#Teach WRT54G in which interface is placed each device in the network:

route add -host 192.168.1.1 dev eth1
route add -host 192.168.1.2 dev eth1
route add -host 192.168.1.3 dev eth1
route add -host 192.168.1.6 dev eth1
route add -host 192.168.1.10 dev eth1
route add -host 192.168.1.33 dev vlan0
route add -host 192.168.1.233 dev vlan0</code></pre></div><p>And that&#039;s it! Everything works as expected, all devices are in the same subnet. Problem is that each time you add a new device you have to add a new entry to the routing table to specify in wich interface it is. I love OpenWRT :-)</p><p>UPDATE: Broadcasts doesn&#039;t work, in windows you won&#039;t find the resources of your workgroup. But you can make &quot;hard links&quot; like: change your \\WorkGroup\printer1 by \\192.168.1.x\printer1</p>											<p class="post-edited">(Last edited by <strong>acidbits</strong> on 4 May 2005, 16:51)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p6811">
				<div class="post-metadata">
					<div class="post-num">Post #35</div>
					<div class="post-author">login_denied</div>
					<div class="post-datetime">
						5 May 2005, 14:44					</div>
				</div>
				<div class="post-content content">
					<p>Hi acidbits!</p><p>lots of thanks! Its working fine on my WRT54GS V1.1.</p><p>Bye.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7396">
				<div class="post-metadata">
					<div class="post-num">Post #36</div>
					<div class="post-author">kaobiore</div>
					<div class="post-datetime">
						20 May 2005, 08:14					</div>
				</div>
				<div class="post-content content">
					<p>Hi all!</p><p>I&#039;ve the same problem ...</p><p>NathanA talked about MAC-NAT and that proxy_arp could do that.</p><p>Mmmhh ... could it be possible that the use of ebtables leads to <br />working solution for our problem?</p><p><a href="http://ebtables.sourceforge.net">http://ebtables.sourceforge.net</a>/</p><p>greetz<br />kao</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7399">
				<div class="post-metadata">
					<div class="post-num">Post #37</div>
					<div class="post-author">Ge0rG</div>
					<div class="post-datetime">
						20 May 2005, 10:53					</div>
				</div>
				<div class="post-content content">
					<p>It might be possible with ebtables too, but I&#039;ve solved the issue as follows:</p><p>* split the br0 to vlan0 and eth1<br />* set 192.168.0.253/32 for vlan0 and 192.168.0.253/24 for eth1<br />* ip r add 192.168.0.25/32 dev vlan0 (thats the only box behind the wrt, add host routes / network routes as you need)<br />* echo 1 &gt; /proc/sys/net/ipv4/conf/eth1/proxy_arp<br />* echo 1 &gt; /proc/sys/net/ipv4/conf/vlan0/proxy_arp</p><p>This made the WRT a semi-bridge between 192.168.0.25 on the LAN port and 192.168.0.* on the WLAN, which now works reliably for me.</p><p>The only thing you can&#039;t do is to move machines from one side to the other without changing the routes on the WRT</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7410">
				<div class="post-metadata">
					<div class="post-num">Post #38</div>
					<div class="post-author">wirelessjoe</div>
					<div class="post-datetime">
						20 May 2005, 15:14					</div>
				</div>
				<div class="post-content content">
					<p>why not drop bridging idea whole together and stic with complete routing ?<br />much faster<br />much secure<br />scale well<br />spread network easy<br />less overhead on wrt-cpu</p><p>wireless joe</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7493">
				<div class="post-metadata">
					<div class="post-num">Post #39</div>
					<div class="post-author">kaobiore</div>
					<div class="post-datetime">
						23 May 2005, 18:46					</div>
				</div>
				<div class="post-content content">
					<p>Hi all!</p><p>&quot;Complete routing&quot; is not an option for me!</p><p>I&#039;ve tried to do a &quot;MAC-NAT&quot; with ebtables with no success! :-(</p><p>Now, i found something new :-) ... please take a look at: <br /><a href="http://freshmeat.net/projects/parprouted/?topic_id=150">http://freshmeat.net/projects/parprouted/?topic_id=150</a></p><p>It&#039;s a daemon called parprouted ... and here is the description out of the man-page:</p><p>parprouted is a daemon for transparent IP (Layer 3) proxy ARP bridging.&nbsp; Unlike standard bridging, proxy ARP bridging allows to bridge Ethernet networks behind wireless nodes. Normal L2 bridging does not work between wireless nodes because wireless does not know about MAC addresses used in the wired Ethernet networks. Also this daemon is useful for making transparent firewalls. The daemon listens for incoming ARP requests, and in case the location of the requested IP address is unknown, forwards them to other interfaces, as well as updates kernel ARP table with the received replies. When necessary, the daemon generates an ARP reply itself, which causes the stations to send traffic to the host daemon is running on. By automatically adding appropriate /32 routes to Linux kernel IP routing table for the hosts learned via ARP, daemon ensures that the Linux kernel will be able to route the packets to the destination host when it receives them with-out any need routing/subnetting manually. All routes entered by the daemon have a metric of 50.<br />Unless you use -p switch, all entries in the ARP table will be refreshed (rechecked by sending ARP requests) every 50 seconds. This keeps them from being expired by kernel. Normally it takes about 60 ms for a bridge to update all its tables and start sending packets to the destination.</p><p>Ahhhmmm ... am I completely wrong or isn&#039;t that exactly what we need?!? ( ... looks like that there is no precompiled openwrt-package available for this ...)</p><p>By the way ... I&#039;ve red somewhere in the sveasoft-forum that the upcoming release will support multi-clients!?!</p><p>greetz<br />-=kao=-</p><p>*Edit* I&#039;ve already compiled it for openwrt ... will post my results tomorrow!</p>											<p class="post-edited">(Last edited by <strong>kaobiore</strong> on 23 May 2005, 23:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p7775">
				<div class="post-metadata">
					<div class="post-num">Post #40</div>
					<div class="post-author">Tony Hoyle</div>
					<div class="post-datetime">
						30 May 2005, 22:46					</div>
				</div>
				<div class="post-content content">
					<p>parprouted doesn&#039;t support broadcast though.</p><p>I have the following (have had it for a little while, so it&#039;s stable):</p><p>WRT in client mode<br />wpa_supplicant doing WPA/PSK (as the netgear supplicant is broken for client mode)<br />Routes to &#039;major&#039; machines hardcoded (fileserver, AD server)<br />parprouted handling everything else.<br />dhcp-relay relaying dhcp requests across the bridge.</p><p>What parprouted is basically call &#039;route add&#039; dynamically when it sees an IP on one side of the bridge.<br />This doesn&#039;t solve the big issue though - broadcasts.&nbsp; They simply don&#039;t cross the bridge.&nbsp; I partially solved this<br />with dhcp-relay but other broadcast-specific things (Windows networking, mdns) don&#039;t work at all.</p><p>I&#039;m pretty sure it would be possible for parprouted to be modified to relay and reply to broadcasts (specific ones presumably.. you don&#039;t<br />want to relay arp broadcasts!).&nbsp; Anyone looking at this?</p><p>Tony</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9663">
				<div class="post-metadata">
					<div class="post-num">Post #41</div>
					<div class="post-author">patrix</div>
					<div class="post-datetime">
						18 Jul 2005, 17:17					</div>
				</div>
				<div class="post-content content">
					<p>Hello all. I want to set up my WRT54G to function purely as a bridge so that I may hook two LAN&#039;s in my office together and make them function as one. Currently, each LAN has a WRT54G supplying them access and interconnectivity. Both of the Linksys WRT54G are receiving internet access from the same source, but I cannot get the LAN behind one linksys to reach the other LAN behind the second linksys and function as one.<br />Anyone know how I may do this.?<br />I thought disabling DHCP totally might help, but I haven&#039;t been able to get that done either. The Linksys&#039; still keep assigning IP&#039;s to devices connected to them. I really need some help on this please.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9701">
				<div class="post-metadata">
					<div class="post-num">Post #42</div>
					<div class="post-author">hutchman</div>
					<div class="post-datetime">
						19 Jul 2005, 06:06					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>patrix wrote:</cite><blockquote><p>Hello all. I want to set up my WRT54G to function purely as a bridge so that I may hook two LAN&#039;s in my office together and make them function as one. Currently, each LAN has a WRT54G supplying them access and interconnectivity. Both of the Linksys WRT54G are receiving internet access from the same source, but I cannot get the LAN behind one linksys to reach the other LAN behind the second linksys and function as one.<br />Anyone know how I may do this.?<br />I thought disabling DHCP totally might help, but I haven&#039;t been able to get that done either. The Linksys&#039; still keep assigning IP&#039;s to devices connected to them. I really need some help on this please.</p></blockquote></div><p>Use the search feature of these forums and search for WDS.&nbsp; Basically you plug in the MAC address of the far side WRTGS and vice versa.&nbsp; I&#039;d suggest turning on WPA for encryption too so the traffic going over the wireless link is secure.&nbsp; Here is a howto I&#039;ve been following but haven&#039;t actually been able to get is working with whiterussian yet <a href="http://jean.nu/view.php/page/openwrt">http://jean.nu/view.php/page/openwrt</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9778">
				<div class="post-metadata">
					<div class="post-num">Post #43</div>
					<div class="post-author">patrix</div>
					<div class="post-datetime">
						20 Jul 2005, 15:15					</div>
				</div>
				<div class="post-content content">
					<p>Does anyone know how to disable DHCP on the Linksys WRT54G running Openwrt firmware?</p><p>I was able to get a web interface running on it from <a href="http://davidoffdotnet.net/openwrt/ipkg/interface-wrt_0.72_mipsel.ipk">http://davidoffdotnet.net/openwrt/ipkg/ â€¦ mipsel.ipk</a> From this interface, I disabled DHCP, but found that the linksys was still assigning IP addresses to any station connected to it via cable or wireless cards. I would like to assign an IP to the linksys and stop it from assigning IP&#039;s to the clients so I may setup a seperate DHCP server on my LAN. Is this possible?</p><p>Also, anyone have an idea where or how I could get another web interface (perhaps another may have more features)?</p><p>Thanks,<br />Patrix</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p9781">
				<div class="post-metadata">
					<div class="post-num">Post #44</div>
					<div class="post-author">patrix</div>
					<div class="post-datetime">
						20 Jul 2005, 15:21					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I configured my Linksys WRT54G according to the guidelines at <a href="http://woz.gs/wifi/openwrtbridge.html">http://woz.gs/wifi/openwrtbridge.html</a> after this. I was able to get the linksys to perform the way I want, but only in failsafe mode. When I boot to failsafe mode, the linksys becomes transparent like any ordinary switch and allows my workstations connected to it to receive IP addresses from any DHCP server on my LAN (the linksys is also connected via the WAN port to my LAN) instead of assigning any IP&#039;s. This is the result I want, but it only happens in failsafe mode.</p><p>Can anyone tell me why this happens, and how I can achieve the same result in normal mode?</p><p>Thanks<br />Patrix</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11937">
				<div class="post-metadata">
					<div class="post-num">Post #45</div>
					<div class="post-author">roz</div>
					<div class="post-datetime">
						11 Sep 2005, 10:11					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I&#039;m a newbie to openwrt and I managed to scape together a wireless bridge by using the howto at <a href="http://woz.gs/wifi/openwrtbridge.html">http://woz.gs/wifi/openwrtbridge.html</a>.&nbsp; for whatever reason, after a power cycle, I must log into my wrt54gs and run<br />&gt;wl wet 1<br />This is undesirable since the only device I want to have connected to the wrt54gs is my xbox.<br />From the howto I set the wl0_mode variable to &quot;wet&quot;, but I&#039;m guessing there&#039;s something else I need to set to get this setting to persist.</p><p>If it matters, I&#039;m using the firmware from:<br /><a href="http://downloads.openwrt.org/people/nbd/whiterussian/">http://downloads.openwrt.org/people/nbd/whiterussian/</a></p><p>Thanks,</p><p>Chris</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11938">
				<div class="post-metadata">
					<div class="post-num">Post #46</div>
					<div class="post-author">roz</div>
					<div class="post-datetime">
						11 Sep 2005, 10:58					</div>
				</div>
				<div class="post-content content">
					<p>Hi again,</p><p>The answer to my own question: nvram set wl0_wet=1</p><p>I&#039;m now happily streaming music on my xbox.&nbsp; Will this setup be fast enough to stream MPEG2 across the network?&nbsp; I will have to try tomorrow... too late tonight...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11940">
				<div class="post-metadata">
					<div class="post-num">Post #47</div>
					<div class="post-author">olli</div>
					<div class="post-datetime">
						11 Sep 2005, 11:44					</div>
				</div>
				<div class="post-content content">
					<p>You need a recent White Russian version (snapshot) from <a href="http://downloads.openwrt.org/people/nbd/whiterussian/">http://downloads.openwrt.org/people/nbd/whiterussian/</a></p><p>Than use the following Howto from <a href="http://wiki.openwrt.org/ClientModeHowto">http://wiki.openwrt.org/ClientModeHowto</a></p><p>Please report if it works for you.</p>											<p class="post-edited">(Last edited by <strong>olli_04</strong> on 8 Oct 2005, 11:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11958">
				<div class="post-metadata">
					<div class="post-num">Post #48</div>
					<div class="post-author">/usr/local/fox</div>
					<div class="post-datetime">
						11 Sep 2005, 23:03					</div>
				</div>
				<div class="post-content content">
					<p>I tried all the configurations show here and cannot get this to work. I had Alchemy installed before I installed OpenWRT and wonder if my NVRAM settings are misconfigured. </p><p>In this thread some one mentioned that the configuration works with the FailSafe NVRAM settings, is there a way to load and commit NVRAM back to stock and restart from a fresh configuration? I&#039;m new to this and I think it will help is I start fresh and follow the howto verbatum.</p>											<p class="post-edited">(Last edited by <strong>/usr/local/fox</strong> on 11 Sep 2005, 23:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11962">
				<div class="post-metadata">
					<div class="post-num">Post #49</div>
					<div class="post-author">/usr/local/fox</div>
					<div class="post-datetime">
						12 Sep 2005, 02:12					</div>
				</div>
				<div class="post-content content">
					<p>Some one that has this setup working... Please do this so people who cannot get this working can do a compair.</p><p>nvram show &gt; nvramsettings.txt</p><p>Then zip or tar the nvramsettings.txt and all the files in the /etc/inet.d directory so we can see what is being setup. </p><p>Thanks!!</p><p>/usr/local/fox</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p11968">
				<div class="post-metadata">
					<div class="post-num">Post #50</div>
					<div class="post-author">/usr/local/fox</div>
					<div class="post-datetime">
						12 Sep 2005, 04:29					</div>
				</div>
				<div class="post-content content">
					<p>Sweet! I found what the problem was.. <br />I used nvram to set lan_ifnames .. Problem is I needed to quote the vlan0 eth1</p><p>nvram set lan_ifnames=&quot;vlan0 eth1&quot; </p><p>This solved the problem all together..</p><p>lan_gateway=192.168.1.1<br />lan_netmask=255.255.255.0<br />lan_ifnames=vlan0 eth1<br />lan_dns=192.168.1.1<br />lan_proto=static<br />lan_ipaddr=192.168.1.6<br />lan_ifname=br0<br />wan_proto=none<br />wan_ifname=vlan1<br />wl0_mode=sta<br />wl0_ssid=&lt;wirelessssid&gt;<br />wl0_wet=1</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 2 of 2</div><nav><ul><li><a href="viewtopic.php%3Fid=1078&amp;p=1.html">1</a></li><li class="pagination-current"><span>2</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>