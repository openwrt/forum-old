<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> Samba Problem</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 1 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p298383">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						2 Nov 2015, 16:31					</div>
				</div>
				<div class="post-content content">
					<p>Hello, i want to set up a standard samba server<br />I set up the security = share in the template of the luci page and i add the directory that i want to share but when i try to check the network in windows 10 i can only see my pc and not the samba server</p><p>If i try to manually add the drive with \\192.168.1.1\Download windows ask me name and password, but i set samba to allow guest and to share security so what is the problem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298491">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						3 Nov 2015, 15:27					</div>
				</div>
				<div class="post-content content">
					<p>Up</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298504">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">silentcreek</div>
					<div class="post-datetime">
						3 Nov 2015, 16:33					</div>
				</div>
				<div class="post-content content">
					<p>You should provide the contents of your smb.conf file. Otherwise it&#039;s hard to help you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298512">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						3 Nov 2015, 17:59					</div>
				</div>
				<div class="post-content content">
					<p>\ect\config\samba</p><p>config samba<br />&nbsp; &nbsp; option name &#039;OpenWrt&#039;<br />&nbsp; &nbsp; option workgroup &#039;WORKGROUP&#039;<br />&nbsp; &nbsp; option description &#039;OpenWrt&#039;<br />&nbsp; &nbsp; option homes &#039;1&#039;</p><p>config sambashare<br />&nbsp; &nbsp; option name &#039;Root&#039;<br />&nbsp; &nbsp; option path &#039;/&#039;<br />&nbsp; &nbsp; option read_only &#039;no&#039;<br />&nbsp; &nbsp; option guest_ok &#039;yes&#039;</p><br /><br /><p>\etc\samba\smb.conf.template<br />[global]<br />&nbsp; &nbsp; netbios name = |NAME| <br />&nbsp; &nbsp; display charset = |CHARSET|<br />&nbsp; &nbsp; interfaces = |INTERFACES|<br />&nbsp; &nbsp; server string = |DESCRIPTION|<br />&nbsp; &nbsp; unix charset = |CHARSET|<br />&nbsp; &nbsp; workgroup = |WORKGROUP|<br />&nbsp; &nbsp; browseable = yes<br />&nbsp; &nbsp; deadtime = 30<br />&nbsp; &nbsp; domain master = yes<br />&nbsp; &nbsp; encrypt passwords = true<br />&nbsp; &nbsp; enable core files = no<br />&nbsp; &nbsp; guest account = nobody<br />&nbsp; &nbsp; guest ok = yes<br />&nbsp; &nbsp; invalid users = root<br />&nbsp; &nbsp; local master = yes<br />&nbsp; &nbsp; load printers = no<br />&nbsp; &nbsp; map to guest = Bad User<br />&nbsp; &nbsp; max protocol = SMB2<br />&nbsp; &nbsp; min receivefile size = 16384<br />&nbsp; &nbsp; null passwords = yes<br />&nbsp; &nbsp; obey pam restrictions = yes<br />&nbsp; &nbsp; os level = 20<br />&nbsp; &nbsp; passdb backend = smbpasswd<br />&nbsp; &nbsp; preferred master = yes<br />&nbsp; &nbsp; printable = no<br />&nbsp; &nbsp; security = share<br />&nbsp; &nbsp; smb encrypt = disabled<br />&nbsp; &nbsp; smb passwd file = /etc/samba/smbpasswd<br />&nbsp; &nbsp; socket options = TCP_NODELAY IPTOS_LOWDELAY<br />&nbsp; &nbsp; syslog = 3<br />&nbsp; &nbsp; use sendfile = yes<br />&nbsp; &nbsp; writeable = yes</p><br /><p>Ok?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298607">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						4 Nov 2015, 12:36					</div>
				</div>
				<div class="post-content content">
					<p>Up</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298628">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">eduperez</div>
					<div class="post-datetime">
						4 Nov 2015, 15:33					</div>
				</div>
				<div class="post-content content">
					<p>My two cents:</p><p>* Sharing the root directory is a bad idea.<br />* Sharing the root directory to guest users is a very bad idea.</p><p>What do the log at the server say?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298630">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">silentcreek</div>
					<div class="post-datetime">
						4 Nov 2015, 16:00					</div>
				</div>
				<div class="post-content content">
					<p>Could you try to add the following parameter to your smb.conf.template and see if that helps:<br /></p><div class="codebox"><pre><code>guest only = Yes</code></pre></div><p>About your samba share not being visible in Windows Explorer: Do you have the service nmbd enabled on your OpenWrt device?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298635">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						4 Nov 2015, 17:16					</div>
				</div>
				<div class="post-content content">
					<p>the root share was only a test to exclude problem with drive mounting XD<br />I try the guest only and yes the service nmbd is enabled and if i check in the process tab it&#039;s running<br />The problem is that if i try to run smbd with the option -F i don&#039;t receive any output from the console<br />No error no info....</p><p>EDIT</p><p>no change with the guest only = yes <img src="https://forum.openwrt.org/img/smilies/sad.png" width="15" height="15" alt="sad" /></p>											<p class="post-edited">(Last edited by <strong>Ansuel</strong> on 4 Nov 2015, 17:18)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298942">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">silentcreek</div>
					<div class="post-datetime">
						7 Nov 2015, 23:50					</div>
				</div>
				<div class="post-content content">
					<p>Ok, sorry. Then I don&#039;t know any further... Hopefully, someone else has more ideas. I use samba a lot, but I actually have never used public/guest shares.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p298968">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						8 Nov 2015, 10:27					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>silentcreek wrote:</cite><blockquote><p>Ok, sorry. Then I don&#039;t know any further... Hopefully, someone else has more ideas. I use samba a lot, but I actually have never used public/guest shares.</p></blockquote></div><p>thx for your help anyway</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299008">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						8 Nov 2015, 17:20					</div>
				</div>
				<div class="post-content content">
					<p>hi</p><p>you could try for a straight access writing path inside address bar<br />\\OpenWrt\Root</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299019">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						8 Nov 2015, 18:07					</div>
				</div>
				<div class="post-content content">
					<p>Windows ask me about login....<br />But it should be public</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299049">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						8 Nov 2015, 21:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Ansuel wrote:</cite><blockquote><p>Windows ask me about login....<br />But it should be public</p></blockquote></div><p>well at least you got connected now you have to debug your config.. hf<br />ps: check sambas wiki regarding howto; also samba has some problems regarding stability.. check that too</p>											<p class="post-edited">(Last edited by <strong>makarel</strong> on 8 Nov 2015, 21:20)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299050">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						8 Nov 2015, 21:29					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>makarel wrote:</cite><blockquote><div class="quotebox"><cite>Ansuel wrote:</cite><blockquote><p>Windows ask me about login....<br />But it should be public</p></blockquote></div><p>well at least you got connected now you have to debug your config.. hf<br />ps: check sambas wiki regarding howto; also samba has some problems regarding stability.. check that too</p></blockquote></div><p>The real problem is that if i try to see the log in a very high debug setting (like 10...) the log is EMPTY.... <br />i think the process don&#039;t start at all...</p><p>It&#039;s strange because in the other build compiled by me (and not from the trunk) i didn&#039;t have any problem...</p><p>I will try to update... i hope they have fixed the problem</p><p>Just one last question... in your opinion the fact that i have extroot (the root is mounted on a external drive) could be the cause of the problem? It&#039;s the only main difference between my compiled version (where i had a /overlay mount) and the trunk version (where i have / mount )</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299139">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">makarel</div>
					<div class="post-datetime">
						9 Nov 2015, 18:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Ansuel wrote:</cite><blockquote><p>...<br />Just one last question... in your opinion the fact that i have extroot (the root is mounted on a external drive) could be the cause of the problem? It&#039;s the only main difference between my compiled version (where i had a /overlay mount) and the trunk version (where i have / mount )</p></blockquote></div><p>well as long as you have a working extroot(read you can boot) there should be no problem at all<br />from my knowledge all you have to do for samba to work(easy way) is to install luci-app-samba module define a share and enable option &#039;guest_ok&#039; &#039;yes&#039;<br /><a href="http://wiki.openwrt.org/doc/recipes/usb-storage-samba-webinterface">http://wiki.openwrt.org/doc/recipes/usb â€¦ binterface</a><br /><a href="http://wiki.openwrt.org/doc/howto/cifs.server">http://wiki.openwrt.org/doc/howto/cifs.server</a><br /><a href="http://wiki.openwrt.org/doc/uci/samba">http://wiki.openwrt.org/doc/uci/samba</a></p>											<p class="post-edited">(Last edited by <strong>makarel</strong> on 9 Nov 2015, 18:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p299307">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">Ansuel</div>
					<div class="post-datetime">
						10 Nov 2015, 22:10					</div>
				</div>
				<div class="post-content content">
					<p>Anyway after a sysupgrade with reset and set security to share i have fixed the problem <img src="https://forum.openwrt.org/img/smilies/big_smile.png" width="15" height="15" alt="big_smile" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>