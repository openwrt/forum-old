<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> WRT1900AC Brick/DDR Training Sequence Fail</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 24 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p346344">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">ipood</div>
					<div class="post-datetime">
						11 Dec 2016, 17:59					</div>
				</div>
				<div class="post-content content">
					<p>Hi All,</p><p>I recently inherited a LinksysWRT1900ac v1 from a family member with the explanation that it just doesn&#039;t work.&nbsp; I cracked it open and connected my TTL cable to it, but cannot get to complete boot up with the message that DDR3 training sequence failed.&nbsp; Is this thing fixable, or should I just harvet whatever parts I can recover?&nbsp; Output below.&nbsp; </p><div class="codebox"><pre><code>BootROM 1.20
Booting from NAND flash
Step 1: First phase of PEX-PIPE Configuration
Step 2: Configure the desire PIN_PHY_GEN
Step 3 QSGMII enable
Step 4: Configure SERDES MUXes
Step 5: Activate the RX High Impedance Mode
Step 6: [PEX-Only] PEX-Main configuration (X4 or X1)
Step 6.2: [PEX-Only] PCI Express Link Capabilities
Step 7: [PEX-X4 Only] To create PEX-Link
Steps 7,8,9,10 and 11
Steps 12: [PEX-Only] Last phase of PEX-PIPE ConfigurationSteps 13: Wait 15ms bef                                                                              ore checking resultsSteps 14: [PEX-Only]  In order to configureSteps 15: [PEX-On                                                                              ly]  In order to configureSteps 16: [PEX-Only] Training Enablestep 17: max_if= 0                                                                              x7
step 17:  PEX0  pexUnit= 0
** Link is Gen1, check the EP capability
 --&gt; 0050
mvPexConfigRead: return addr=0x%x0050
 --&gt; 7001
 --&gt; 7001
 --&gt; A005
 --&gt; A005
 --&gt; 0010
 --&gt; 4C12
Gen2 client!
step 17:  PEX1  pexUnit= 0
step 17:  PEX2  pexUnit= 0
** Link is Gen1, check the EP capability
 --&gt; 0040
mvPexConfigRead: return addr=0x%x0040
 --&gt; 5001
 --&gt; 5001
 --&gt; 7005
 --&gt; 7005
 --&gt; 0010
 --&gt; DC12
Gen2 client!
step 17:  PEX3  pexUnit= 0
PEX3 : Detected No Link. Status Reg(0x0004DA64) = 0x00000001
step 17:  PEX4  pexUnit= 1
PEX4 : Detected No Link. Status Reg(0x00081A64) = 0x00000001
step 17:  PEX5  pexUnit= 1
PEX5 : Detected No Link. Status Reg(0x00085A64) = 0x00000001
step 17:  PEX6  pexUnit= 1
PEX6 : Detected No Link. Status Reg(0x00089A64) = 0x00000001
                                                            DDR3 Training Sequen                                                                              ce - Ver 4.5.DDR3 Training Sequence - Static MC Init
DDR3 Training Sequence - HW Training Procedure
DDR3 Training Sequence - FAILED (Write Leveling Hi-Freq Sup)
DDR3 Training Sequence - FAILED</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346349">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nitroshift</div>
					<div class="post-datetime">
						11 Dec 2016, 18:28					</div>
				</div>
				<div class="post-content content">
					<p>Read the wiki, it has everything you need to revive it.</p><p>nitroshift</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346350">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ipood</div>
					<div class="post-datetime">
						11 Dec 2016, 18:34					</div>
				</div>
				<div class="post-content content">
					<p>I followed the wiki instructions for kwboot, but in the end it gives me a read error.&nbsp; What am I doing wrong?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346354">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">ValCher</div>
					<div class="post-datetime">
						11 Dec 2016, 18:53					</div>
				</div>
				<div class="post-content content">
					<p>It seems you have a problem with the DDR, it is necessary to rewire chips.<br />Also, check the router board was not filled with water.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p346365">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">ipood</div>
					<div class="post-datetime">
						11 Dec 2016, 20:01					</div>
				</div>
				<div class="post-content content">
					<p>This is the output I get when I follow the procedure to recover from corrupt boot loader.&nbsp; It fails with +xmodem: Protocol error.</p><div class="codebox"><pre><code>./kwboot -a -t /dev/ttyUSB0 -b u-boot-uart.kwb 
Sending boot message. Please reboot the target...\
Sending boot image...
  0 % [......................................................................]
  0 % [......................................................................]
  1 % [......................................................................]
  2 % [......................................................................]
  3 % [......................................................................]
  4 % [......................................................................]
  5 % [......................................................................]
  6 % [......................................................................]
  7 % [......................................................................]
  8 % [......................................................................]
  9 % [......................................................................]
 10 % [.............................Step 1: First phase of PEX-PIPE Configuration
Step 2: Configure the desire PIN_PHY_GEN
Step 3 QSGMII enable 
Step 4: Configure SERDES MUXes 
Step 5: Activate the RX High Impedance Mode  
Step 6: [PEX-Only] PEX-Main configuration (X4 or X1)
Step 6.2: [PEX-Only] PCI Express Link Capabilities
Step 7: [PEX-X4 Only] To create PEX-Link 
Steps 7,8,9,10 and 11
Steps 12: [PEX-Only] Last phase of PEX-PIPE ConfigurationSteps 13: Wait 15ms before checking resultsSteps 14: [PEX-Only]  In order to configureSteps 15: [PEX-Only]  In order to configureSteps 16: [PEX-Only] Training Enablestep 17: max_if= 0x7
step 17:  PEX0  pexUnit= 0
** Link is Gen1, check the EP capability 
 --&gt; 0050
mvPexConfigRead: return addr=0x%x0050
 --&gt; 7001
 --&gt; 7001
 --&gt; A005
 --&gt; A005
 --&gt; 0010
 --&gt; 4C12
Gen2 client!
step 17:  PEX1  pexUnit= 0
step 17:  PEX2  pexUnit= 0
** Link is Gen1, check the EP capability 
 --&gt; 0040
mvPexConfigRead: return addr=0x%x0040
 --&gt; 5001
 --&gt; 5001
 --&gt; 7005
 --&gt; 7005
 --&gt; 0010
 --&gt; DC12
Gen2 client!
step 17:  PEX3  pexUnit= 0
PEX3 : Detected No Link. Status Reg(0x0004DA64) = 0x00000001
step 17:  PEX4  pexUnit= 1
PEX4 : Detected No Link. Status Reg(0x00081A64) = 0x00000001
step 17:  PEX5  pexUnit= 1
PEX5 : Detected No Link. Status Reg(0x00085A64) = 0x00000001
step 17:  PEX6  pexUnit= 1
PEX6 : Detected No Link. Status Reg(0x00089A64) = 0x00000001
DDR3 Training Sequence - Ver 4.5.DDR3 Training Sequence - Static MC Init 
DDR3 Training Sequence - HW Training Procedure 
DDR3 Training Sequence - FAILED (Write Leveling Hw) 
DDR3 Training Sequence - FAILED  
+xmodem: Protocol error
root@wolf:/home/user1/kwboot# </code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348198">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">693988361</div>
					<div class="post-datetime">
						2 Jan 2017, 09:46					</div>
				</div>
				<div class="post-content content">
					<p>do you have solved the problem,i think maybe is the cpu&#039;s problem</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348229">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">sera</div>
					<div class="post-datetime">
						2 Jan 2017, 18:36					</div>
				</div>
				<div class="post-content content">
					<p>The xmodem protocol error sounds like your usb2ttl is only a partial implementation, maybe you see more in dmesg. Anyway, the router seems dead regardless.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348233">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">nitroshift</div>
					<div class="post-datetime">
						2 Jan 2017, 19:47					</div>
				</div>
				<div class="post-content content">
					<p>My hunch is a loose connection on the usb ttl adapter as the router shouldn&#039;t start the boot process until transfer has finished.</p><p>nitroshift</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348264">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">ValCher</div>
					<div class="post-datetime">
						3 Jan 2017, 04:15					</div>
				</div>
				<div class="post-content content">
					<p>No, this procedure U-Boon - DDR3 Training Sekuen. The high probability of a memory chip failure, or delamination of the contact paths of the chip.<br />I was so when I tried unsuccessfully to increase the memory in wrt1900ac v1 up to 512mb, - wrong soldering chips.<br />Now on the router configured with two chip HTQ2G63BFR, giving a total of - 512mb, but the system still identifies as 256mb. The router is working properly.<br />By the way, this is the maximum amount of memory that can be installed, as the router uses address memory bus&nbsp; in the range M_A[0] ... M_A[14] (M_A[15] are not divorced).<br />Who has any ideas?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348287">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">sera</div>
					<div class="post-datetime">
						3 Jan 2017, 11:50					</div>
				</div>
				<div class="post-content content">
					<p>Neither nitroshift nor I suggested it&#039;s not a hardware / ram issue, just that an additional issue can be seen in the output.</p><p>As for your mod, did you update the DT accordingly?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348293">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">ValCher</div>
					<div class="post-datetime">
						3 Jan 2017, 13:12					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sera wrote:</cite><blockquote><p>As for your mod, did you update the DT accordingly?</p></blockquote></div><p>I&#039;m sorry that this DT?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348297">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">nitroshift</div>
					<div class="post-datetime">
						3 Jan 2017, 13:32					</div>
				</div>
				<div class="post-content content">
					<p>DT is the device tree file.</p><p>nitroshift</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348301">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">ValCher</div>
					<div class="post-datetime">
						3 Jan 2017, 13:43					</div>
				</div>
				<div class="post-content content">
					<p>File &#039;armada-xp-linksys-mamba.dts&#039; corrected during assembly of the nucleus.<br /></p><div class="codebox"><pre><code>    memory {
           device_type = &quot;memory&quot;;
           reg = &lt;0x00000000 0x00000000 0x00000000 0x20000000&gt;; /* 512MB */
    };</code></pre></div><p>Or something else is necessary?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348321">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">sera</div>
					<div class="post-datetime">
						3 Jan 2017, 17:18					</div>
				</div>
				<div class="post-content content">
					<p>I should be sorry for assuming DT to be obvious.</p><p>Your snipped looks fine at a glance, probably you need to teach uboot about the additional ram. Did you document your mod somewhere?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348333">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">ValCher</div>
					<div class="post-datetime">
						3 Jan 2017, 18:58					</div>
				</div>
				<div class="post-content content">
					<p>This mod I have never documented.<br />Yes, it would be nice to look at Uboot source to set the upper limit of the memory, but not sure - I can handle myself. <br />I also need to check again in good memory chips, for that tomorrow I will establish a new set of chips.</p><p>And another question, whether there can be a hardware limitation of the upper limit of memory, such as a jumper, a resistor, etc.?</p>											<p class="post-edited">(Last edited by <strong>ValCher</strong> on 3 Jan 2017, 18:58)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348382">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">sera</div>
					<div class="post-datetime">
						4 Jan 2017, 11:53					</div>
				</div>
				<div class="post-content content">
					<p>Guess <a href="https://github.com/MarvellEmbeddedProcessors/u-boot-marvell/commit/f10d22eedc261eec501688fa6bdd5d756b115d5c">https://github.com/MarvellEmbeddedProce â€¦ 756b115d5c</a> is what is used on shelby. In that repo you should also find what was used for Mamba but you might just as well build the latest version instead.</p><p>There are always physical limitations, though I doubt you will hit them here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348413">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">ValCher</div>
					<div class="post-datetime">
						4 Jan 2017, 17:00					</div>
				</div>
				<div class="post-content content">
					<p>@Sera<br />Thanks for the info, I will study.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348471">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">sera</div>
					<div class="post-datetime">
						5 Jan 2017, 10:02					</div>
				</div>
				<div class="post-content content">
					<p>Well, if you have the energy to add u-boot builds to OpenWrt guess many could profit.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348522">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">ValCher</div>
					<div class="post-datetime">
						5 Jan 2017, 21:58					</div>
				</div>
				<div class="post-content content">
					<p>Ah, there are so many things and confused that I can not give an answer right now.<br />By the way, there really is explicitly defined by the upper limit of 256mb.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>