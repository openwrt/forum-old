<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> 3G Modem MA260 issue on MR3020 14.07</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 5 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p255792">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">fredaine</div>
					<div class="post-datetime">
						28 Nov 2014, 00:50					</div>
				</div>
				<div class="post-content content">
					<p>Hi,<br />I am trying to configure my TP-Link MR3020 running Breaking Barrier for 3G connections with a TP Link MA260.</p><p>Openwrt.org install pages says &quot;modem MA260 works out of the box&quot; but says also that exceptions exist.<br />I think that I try all given possibilities but without success, USB dev path are never created (no /dev/ttyUSBx).</p><p>The modem is dectected and I&#039;m able to configure an extroot using the internal microSD.<br />For sure I&#039;m not a Linux expert so I need your help to solve this issue. Please note that the modem seems to work on an other system and has working on the MR3020 before a failsafe procedure.</p><p>Thanks a lot in advance.<br />Fred.</p><p>(All mentionned opkg are installed)<br />==&gt;logread<br />....<br />Thu Nov 27 22:11:29 2014 kern.info kernel: [&nbsp; &nbsp; 8.770000] usb-storage 1-1.4:1.0: USB Mass Storage device detected<br />Thu Nov 27 22:11:29 2014 kern.info kernel: [&nbsp; &nbsp; 8.780000] scsi0 : usb-storage 1-1.4:1.0<br />Thu Nov 27 22:11:29 2014 kern.info kernel: [&nbsp; &nbsp; 8.790000] usbcore: registered new interface driver usb-storage<br />Thu Nov 27 22:11:29 2014 kern.notice kernel: [&nbsp; &nbsp; 9.790000] scsi 0:0:0:0: CD-ROM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TP-LINK&nbsp; MMC Storage&nbsp; &nbsp; &nbsp; 2.31 PQ: 0 ANSI: 2<br />Thu Nov 27 22:11:29 2014 kern.notice kernel: [&nbsp; &nbsp; 9.800000] scsi 0:0:0:1: Direct-Access&nbsp; &nbsp; &nbsp;TP-LINK&nbsp; MMC Storage&nbsp; &nbsp; &nbsp; 2.31 PQ: 0 ANSI: 2<br />Thu Nov 27 22:11:29 2014 kern.notice kernel: [&nbsp; &nbsp; 9.810000] sd 0:0:0:1: [sda] 31275008 512-byte logical blocks: (16.0 GB/14.9 GiB)<br />Thu Nov 27 22:11:29 2014 kern.notice kernel: [&nbsp; &nbsp; 9.810000] sd 0:0:0:1: [sda] Write Protect is off<br />....<br />Thu Nov 27 22:11:29 2014 kern.info kernel: [&nbsp; &nbsp;18.060000] usbcore: registered new interface driver usbserial<br />Thu Nov 27 22:11:29 2014 kern.info kernel: [&nbsp; &nbsp;18.060000] usbcore: registered new interface driver usbserial_generic<br />Thu Nov 27 22:11:29 2014 kern.info kernel: [&nbsp; &nbsp;18.080000] usbserial: USB Serial support registered for generic<br />....<br />Thu Nov 27 22:11:29 2014 kern.info kernel: [&nbsp; &nbsp;18.440000] usbcore: registered new interface driver option<br />Thu Nov 27 22:11:29 2014 kern.info kernel: [&nbsp; &nbsp;18.460000] usbserial: USB Serial support registered for GSM modem (1-port)<br />Thu Nov 27 22:11:29 2014 kern.debug kernel: [&nbsp; &nbsp;18.500000] ath: EEPROM regdomain: 0x0<br />Thu Nov 27 22:11:29 2014 kern.debug kernel: [&nbsp; &nbsp;18.500000] ath: EEPROM indicates default country code should be used<br />Thu Nov 27 22:11:29 2014 kern.debug kernel: [&nbsp; &nbsp;18.500000] ath: doing EEPROM country-&gt;regdmn map search<br />Thu Nov 27 22:11:29 2014 kern.debug kernel: [&nbsp; &nbsp;18.500000] ath: country maps to regdmn code: 0x3a<br />Thu Nov 27 22:11:29 2014 kern.debug kernel: [&nbsp; &nbsp;18.500000] ath: Country alpha2 being used: US<br />Thu Nov 27 22:11:29 2014 kern.debug kernel: [&nbsp; &nbsp;18.500000] ath: Regpair used: 0x3a<br />....</p><p>==&gt;ls /dev/tty*<br />/dev/tty&nbsp; &nbsp; &nbsp; /dev/ttyS0&nbsp; &nbsp; /dev/ttyS10&nbsp; &nbsp;/dev/ttyS12&nbsp; &nbsp;/dev/ttyS14&nbsp; &nbsp;/dev/ttyS2&nbsp; &nbsp; /dev/ttyS4&nbsp; &nbsp; /dev/ttyS6&nbsp; &nbsp; /dev/ttyS8<br />/dev/ttyATH0&nbsp; /dev/ttyS1&nbsp; &nbsp; /dev/ttyS11&nbsp; &nbsp;/dev/ttyS13&nbsp; &nbsp;/dev/ttyS15&nbsp; &nbsp;/dev/ttyS3&nbsp; &nbsp; /dev/ttyS5&nbsp; &nbsp; /dev/ttyS7&nbsp; &nbsp; /dev/ttyS9</p><p>==&gt;cat /sys/kernel/debug/usb/devices<br />....<br />T:&nbsp; Bus=01 Lev=02 Prnt=02 Port=03 Cnt=01 Dev#=&nbsp; 3 Spd=480&nbsp; MxCh= 0<br />D:&nbsp; Ver= 2.00 Cls=00(&gt;ifc ) Sub=00 Prot=00 MxPS=64 #Cfgs=&nbsp; 1<br />P:&nbsp; Vendor=2357 ProdID=f000 Rev= 0.00<br />S:&nbsp; Manufacturer=TP-LINK, Incorporated<br />S:&nbsp; Product=TP-LINK HSPA+ Modem<br />S:&nbsp; SerialNumber=863745010689384<br />C:* #Ifs= 1 Cfg#= 1 Atr=c0 MxPwr=500mA<br />I:* If#= 0 Alt= 0 #EPs= 2 Cls=08(stor.) Sub=06 Prot=50 Driver=usb-storage<br />E:&nbsp; Ad=01(O) Atr=02(Bulk) MxPS= 512 Ivl=0ms<br />E:&nbsp; Ad=81(I) Atr=02(Bulk) MxPS= 512 Ivl=0ms</p><p>==&gt; Libusb<br />Bus 001 Device 002: ID 1a40:0101 Terminus Technology Inc. 4-Port HUB<br />Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub<br />Bus 001 Device 003: ID 2357:f000</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255974">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">fredaine</div>
					<div class="post-datetime">
						30 Nov 2014, 00:15					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I&#039;m still searching and testing but without success. My problem (no /dev/ttyUSBx for the modem) is probably linked to the fact that the virtual CD ROM is not ejected. But I didn&#039;t find how to eject it.<br />Also I don&#039;t understand why the modem worked before the failsafe procedure if this ejection is really necessary. And I don&#039;t know if this is linked with the fact that I use now the extroot using the microSD card present on the modem. (so not possible to un-plug and re-plug the Modem)</p><p>My english is not so good so I hope that my question is clear enough.</p><p>Thank you in advance.<br />Fred.</p>											<p class="post-edited">(Last edited by <strong>fredaine</strong> on 30 Nov 2014, 00:22)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255976">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">neryba</div>
					<div class="post-datetime">
						30 Nov 2014, 00:27					</div>
				</div>
				<div class="post-content content">
					<p>install usb_modeswitch and send MessageContent=&quot;5553424312345678000000000000061b00 0000020000000000000000000000&quot;<br />read this links:<br /><a href="http://ubuntuforums.org/showthread.php?t=2197164">http://ubuntuforums.org/showthread.php?t=2197164</a><br /><a href="http://www.draisberghof.de/usb_modeswitch/bb/viewtopic.php?f=3&amp;t=1525">http://www.draisberghof.de/usb_modeswit … amp;t=1525</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255982">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">fredaine</div>
					<div class="post-datetime">
						30 Nov 2014, 02:10					</div>
				</div>
				<div class="post-content content">
					<p>Thank you for the reply.</p><p>The router is running Breaking Barrier. So usb_modeswitch uses now json configuration.<br />So I adapt the /etc/usb-mode.json to add the message &quot;5553424312345678000000000000061b00 0000020000000000000000000000&quot; and refer to the correspondig index.</p><p>Reboot, no change.</p><p>I created the custom file and run : usbmode -s -v -c /path/to/usb-mode-custom.json<br />Apparently&nbsp; the modem was resetted so impossible to execute any command after that (due to extroot)<br />Reboot, no change.</p><p>I don&#039;t know what I&#039;m doing wrong...</p><p>lsusb still:<br />Bus 001 Device 002: ID 1a40:0101 Terminus Technology Inc. 4-Port HUB<br />Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub<br />Bus 001 Device 003: ID 2357:f000</p><p>Any idea? Thx.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256296">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">fredaine</div>
					<div class="post-datetime">
						2 Dec 2014, 17:21					</div>
				</div>
				<div class="post-content content">
					<p>I don&#039;t progress...</p><p>I also tried to send this message &quot;5553424312345678000000000000061e000000000000000000000000000000&quot; in addition to the already mentioned.</p><p>Is there any person having MA260 working on Breaking barrier that can explain which action he did to be able to use it? And especially the action to switch from CD-Rom mode to Modem mode (+actions to be able to see the four /dev/ttyUSBx ports). </p><p>I think I tried all possible solutions available in the wiki and other sources without success.</p><p>Thank you.<br />F.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p256304">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						2 Dec 2014, 19:12					</div>
				</div>
				<div class="post-content content">
					<p>Using the card slot and modem at the same time may not be supported.&nbsp; Have you tried a separate card reader?</p><p>Most modems also have an AT command to permanently turn off the CD-ROM function, then usbmodeswitch will not be necessary.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p257745">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">fredaine</div>
					<div class="post-datetime">
						15 Dec 2014, 16:33					</div>
				</div>
				<div class="post-content content">
					<p>Thank you mk24. <br />I can confirm now that the problem comes indeed from the fact that I used the SD card slot present on the modem.<br />The usb_modeswitch works perfectly by default (on Breaking Barrier) when no SD card is present.</p><p>Now I know that using the SD card from the modem as Extroot works for a lot of people including people having the same Modem TP Link MA260.<br />SO I need to understand why it doesn&#039;t work and how I can correct it.<br />I would like to avoid utilization of an extra USB drive or equivalent.</p><p>Does anybody know how to do it?<br />Thank you.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p265131">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">billybahlah</div>
					<div class="post-datetime">
						11 Feb 2015, 15:11					</div>
				</div>
				<div class="post-content content">
					<p>Dear Fredaine,<br />I&#039;ve been trying to get the same combo on Barrier Breaker working too, MR3020 + MA260, without success.&nbsp; I am trying to get the 3G interface up, but it isn&#039;t able to detect the correct driver.</p><p>Did you have any success in making this work, and establish a 3G connection?<br />Thanks<br />William</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p290714">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">fredaine</div>
					<div class="post-datetime">
						6 Sep 2015, 23:19					</div>
				</div>
				<div class="post-content content">
					<p>Sorry William to answer 7 months later...<br />I never had any succes to make it work as expected.<br />The projet I had was stopped. I will restart it now but I am still not a linux expert. If I succeed, I will let you know even if it is too late...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p293561">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">epek</div>
					<div class="post-datetime">
						26 Sep 2015, 18:44					</div>
				</div>
				<div class="post-content content">
					<p>Hello fredaine!<br />Have you checked my workaround for MA260 at:<br /><a href="http://wiki.openwrt.org/doc/recipes/3gdongle#tp-link_ma260barrier_breaker">http://wiki.openwrt.org/doc/recipes/3gd … er_breaker</a><br />I am actually using my Ma260 with a TL-WR1043NDv1, but currently with snapshot r43612.<br />I guess chaos calmer final will do for you.<br />The activation messages are from draisberghof and others - just google for it.</p><p>E.g.: <a href="http://www.draisberghof.de/usb_modeswitch/bb/viewtopic.php?f=3&amp;t=1525">http://www.draisberghof.de/usb_modeswit … amp;t=1525</a> says:<br /><em>usb_modeswitch -v 2357 -p f000 -V 2357 -P 9000 -W -I -n -M &#039;5553424312345678000000000000061e000000000000000000000000000000&#039; -2 &#039;5553424312345678000000000000061b000000020000000000000000000000&#039;</em></p><p><em>The first message is &quot;allow media removal&quot; and the second is &quot;eject media&quot;<br /></em></p><p>So it looks like the modem can only be switched at that point.</p><p>Good luck!</p>											<p class="post-edited">(Last edited by <strong>epek</strong> on 27 Sep 2015, 02:53)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>