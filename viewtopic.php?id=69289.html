<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> usb device disconnects after the first successful command</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p348793">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">torkel</div>
					<div class="post-datetime">
						8 Jan 2017, 23:38					</div>
				</div>
				<div class="post-content content">
					<p>Hello</p><p>i use the foto-webcam.eu image on the TL-MR3020. And i got the Problem, that just the first Command works, the second one fails, then i have to turn off the camera, turn it on again and the first command is working again.</p><p>I use:<br />gphoto2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.5.0<br />libgphoto2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2.5.0<br />libgphoto2_port&nbsp; 0.10.0&nbsp; </p><p>for example: gphoto2 --summary</p><div class="codebox"><pre><code>Camera summary:                                                                
Manufacturer: Canon Inc.
Model: Canon EOS 1300D
  Version: 3-1.0.1
  Serial Number: xxxxxxx
Vendor Extension ID: 0xb (1.0)

Capture Formats: JPEG
Display Formats: Association/Directory, Script, DPOF, MS AVI, MS Wave, JPEG, CRW, Unknown(b103), Unknown(bf02), Defined Type, Unknown(b104), Unknown(b105)

Device Capabilities:
    File Download, File Deletion, File Upload
    No Image Capture, No Open Capture, Canon EOS Capture
    Canon Wifi support

Storage Devices Summary:
store_00020001:
    StorageDescription: SD
    VolumeLabel: None
    Storage Type: Removable RAM (memory card)
    Filesystemtype: Digital Camera Layout (DCIM)
    Access Capability: Read-Write
    Maximum Capability: 31913410560 (30435 MB)
    Free Space (Bytes): 31913115648 (30434 MB)
    Free Space (Images): -1

Device Property Summary:
Property 0xd402:(read only) (type=0xffff) &#039;Canon EOS 1300D&#039;
Property 0xd407:(read only) (type=0x6) 1
Property 0xd406:(readwrite) (type=0xffff) &#039;Unknown Initiator&#039;
Property 0xd303:(read only) (type=0x2) 1
Battery Level(0x5001):(read only) (type=0x2) Enumeration [100,0,75,0,50] value: 100% (100)</code></pre></div><p>second use of the same command:</p><div class="codebox"><pre><code>*** Error (-52: &#039;Could not find the requested device on the USB port&#039;) ***       </code></pre></div><p>if i now restart the camera, the command is working again for one time.</p><p>does anyone have any idea to solve this problem?</p><p>best regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348796">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						8 Jan 2017, 23:44					</div>
				</div>
				<div class="post-content content">
					<p>How is the camera powered?<br />What OpenWrt version are you running the MR3020 on, 12.09?</p><p>Please post the output of lsusb before/after issuing the first gphoto command<br />Please post relevant output of dmesg and/or logread</p><p>Have you already been searching for a solution on gphoto side?<br />Are you sure the 1300D is compatible with gphoto 2.5.0?</p><p>Edit: On <a href="http://gphoto.org/news/">http://gphoto.org/news/</a> I can not see any info on the 1300D being added to the supported cameras.<br />...but <a href="http://gphoto.org/proj/libgphoto2/support.php">http://gphoto.org/proj/libgphoto2/support.php</a> does: 1300D is supported, but without indication when support was added.</p>											<p class="post-edited">(Last edited by <strong>tmo26</strong> on 8 Jan 2017, 23:59)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348799">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">torkel</div>
					<div class="post-datetime">
						9 Jan 2017, 00:07					</div>
				</div>
				<div class="post-content content">
					<p>Hi tmo26</p><p>the camera is just powerd with the accu, because i&#039;m just testing it...is that the problem ... do i need permanent power?</p><p>lsubs before:<br /></p><div class="codebox"><pre><code>root@air360cam:~# lsusb

P:  Vendor=1d6b ProdID=0002 Rev= 3.03
S:  Manufacturer=Linux 3.3.8 ehci_hcd
S:  Product=Generic Platform EHCI Controller

P:  Vendor=1a40 ProdID=0101 Rev= 1.00
S:  Product=USB 2.0 Hub [MTT]

P:  Vendor=04a9 ProdID=32b4 Rev= 0.02
S:  Manufacturer=Canon Inc.
S:  Product=Canon Digital Camera</code></pre></div><p>lsusb after</p><div class="codebox"><pre><code>P:  Vendor=1d6b ProdID=0002 Rev= 3.03
S:  Manufacturer=Linux 3.3.8 ehci_hcd
S:  Product=Generic Platform EHCI Controller

P:  Vendor=1a40 ProdID=0101 Rev= 1.00
S:  Product=USB 2.0 Hub [MTT]</code></pre></div><p>dmesg:<br /></p><div class="codebox"><pre><code>[    0.000000] Linux version 3.3.8 (blogic@Debian-60-squeeze-64-minimal) (gcc version 4.6.3 20120201 (prerelease) (Linaro GCC 4.6-2012.02) ) #1 Sat Mar 23 16:49:30 UTC 2013
[    0.000000] MyLoader: sysp=5306ac2e, boardp=8e303482, parts=f904f9ea
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 00019374 (MIPS 24Kc)
[    0.000000] SoC: Atheros AR9330 rev 1
[    0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:25.000MHz
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 02000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone PFN ranges:
[    0.000000]   Normal   0x00000000 -&gt; 0x00002000
[    0.000000] Movable zone start PFN for each node
[    0.000000] Early memory PFN ranges
[    0.000000]     0: 0x00000000 -&gt; 0x00002000
[    0.000000] On node 0 totalpages: 8192
[    0.000000] free_area_init_node: node 0, pgdat 802f1100, node_mem_map 81000000
[    0.000000]   Normal zone: 64 pages used for memmap
[    0.000000]   Normal zone: 0 pages reserved
[    0.000000]   Normal zone: 8128 pages, LIFO batch:0
[    0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768
[    0.000000] pcpu-alloc: [0] 0 
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 8128
[    0.000000] Kernel command line:  board=TL-MR3020 console=ttyATH0,115200 rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 128 (order: -3, 512 bytes)
[    0.000000] Dentry cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Inode-cache hash table entries: 2048 (order: 1, 8192 bytes)
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] Writing ErrCtl register=00000000
[    0.000000] Readback ErrCtl register=00000000
[    0.000000] Memory: 29000k/32768k available (2211k kernel code, 3768k reserved, 418k data, 212k init, 0k highmem)
[    0.000000] SLUB: Genslabs=9, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.000000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.080000] Mount-cache hash table entries: 512
[    0.090000] NET: Registered protocol family 16
[    0.090000] gpiochip_add: registered GPIOs 0 to 29 on device: ath79
[    0.100000] MIPS: machine is TP-LINK TL-MR3020
[    0.350000] bio: create slab &lt;bio-0&gt; at 0
[    0.360000] Switching to clocksource MIPS
[    0.360000] NET: Registered protocol family 2
[    0.370000] IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.370000] TCP established hash table entries: 1024 (order: 1, 8192 bytes)
[    0.370000] TCP bind hash table entries: 1024 (order: 0, 4096 bytes)
[    0.380000] TCP: Hash tables configured (established 1024 bind 1024)
[    0.390000] TCP reno registered
[    0.390000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.400000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.400000] NET: Registered protocol family 1
[    0.410000] PCI: CLS 0 bytes, default 32
[    0.430000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.430000] JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.440000] msgmni has been set to 56
[    0.440000] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 254)
[    0.450000] io scheduler noop registered
[    0.450000] io scheduler deadline registered (default)
[    0.460000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
[    0.470000] ar933x-uart: ttyATH0 at MMIO 0x18020000 (irq = 11) is a AR933X UART
[    0.480000] console [ttyATH0] enabled, bootconsole disabled
[    0.490000] m25p80 spi0.0: found w25q32, expected m25p80
[    0.490000] m25p80 spi0.0: w25q32 (4096 Kbytes)
[    0.500000] 5 tp-link partitions found on MTD device spi0.0
[    0.500000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.510000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.520000] 0x000000020000-0x000000109c70 : &quot;kernel&quot;
[    0.520000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.530000] 0x000000109c70-0x0000003f0000 : &quot;rootfs&quot;
[    0.540000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.550000] mtd: partition &quot;rootfs&quot; set to be root filesystem
[    0.560000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=360000, len=90000 
[    0.560000] 0x000000360000-0x0000003f0000 : &quot;rootfs_data&quot;
[    0.570000] 0x0000003f0000-0x000000400000 : &quot;art&quot;
[    0.580000] 0x000000020000-0x0000003f0000 : &quot;firmware&quot;
[    0.600000] ag71xx_mdio: probed
[    0.610000] eth0: Atheros AG71xx at 0xb9000000, irq 4
[    1.160000] ag71xx ag71xx.0: eth0: connected to PHY at ag71xx-mdio.1:04 [uid=004dd041, driver=Generic PHY]
[    1.170000] TCP cubic registered
[    1.170000] NET: Registered protocol family 17
[    1.180000] Bridge firewalling registered
[    1.180000] 8021q: 802.1Q VLAN Support v1.8
[    1.190000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    1.190000] Freeing unused kernel memory: 212k freed
[    3.360000] Registered led device: tp-link:green:3g
[    3.360000] Registered led device: tp-link:green:wlan
[    3.360000] Registered led device: tp-link:green:lan
[    3.360000] Registered led device: tp-link:green:wps
[    6.160000] eth0: link up (100Mbps/Full duplex)
[    6.660000] JFFS2 notice: (441) jffs2_build_xattr_subsystem: complete building xattr subsystem, 20 of xdatum (1 unchecked, 19 orphan) and 27 of xref (0 dead, 19 orphan) found.
[    6.780000] eth0: link down
[    7.630000] Compat-drivers backport release: compat-drivers-2012-09-04-2-gddac993
[    7.640000] Backport based on wireless-testing.git master-2012-09-07
[    7.640000] compat.git: wireless-testing.git
[    7.670000] cfg80211: Calling CRDA to update world regulatory domain
[    7.680000] cfg80211: World regulatory domain updated:
[    7.680000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[    7.690000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    7.700000] cfg80211:   (2457000 KHz - 2482000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[    7.710000] cfg80211:   (2474000 KHz - 2494000 KHz @ 20000 KHz), (300 mBi, 2000 mBm)
[    7.710000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    7.720000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.010000] usbcore: registered new interface driver usbfs
[    8.010000] usbcore: registered new interface driver hub
[    8.020000] usbcore: registered new device driver usb
[    8.500000] ath: EEPROM regdomain: 0x0
[    8.500000] ath: EEPROM indicates default country code should be used
[    8.500000] ath: doing EEPROM country-&gt;regdmn map search
[    8.500000] ath: country maps to regdmn code: 0x3a
[    8.500000] ath: Country alpha2 being used: US
[    8.500000] ath: Regpair used: 0x3a
[    8.510000] ieee80211 phy0: Selected rate control algorithm &#039;minstrel_ht&#039;
[    8.510000] Registered led device: ath9k-phy0
[    8.510000] ieee80211 phy0: Atheros AR9330 Rev:1 mem=0xb8100000, irq=2
[    8.520000] cfg80211: Calling CRDA for country: US
[    8.520000] cfg80211: Regulatory domain changed to country: US
[    8.520000] cfg80211:   (start_freq - end_freq @ bandwidth), (max_antenna_gain, max_eirp)
[    8.530000] cfg80211:   (2402000 KHz - 2472000 KHz @ 40000 KHz), (300 mBi, 2700 mBm)
[    8.540000] cfg80211:   (5170000 KHz - 5250000 KHz @ 40000 KHz), (300 mBi, 1700 mBm)
[    8.550000] cfg80211:   (5250000 KHz - 5330000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.560000] cfg80211:   (5490000 KHz - 5600000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.560000] cfg80211:   (5650000 KHz - 5710000 KHz @ 40000 KHz), (300 mBi, 2000 mBm)
[    8.570000] cfg80211:   (5735000 KHz - 5835000 KHz @ 40000 KHz), (300 mBi, 3000 mBm)
[    8.650000] ip_tables: (C) 2000-2006 Netfilter Core Team
[    8.780000] ehci_hcd: USB 2.0 &#039;Enhanced&#039; Host Controller (EHCI) Driver
[    8.790000] ehci-platform ehci-platform: Generic Platform EHCI Controller
[    8.790000] ehci-platform ehci-platform: new USB bus registered, assigned bus number 1
[    8.830000] ehci-platform ehci-platform: irq 3, io mem 0x1b000000
[    8.850000] ehci-platform ehci-platform: USB 2.0 started, EHCI 1.00
[    8.850000] hub 1-0:1.0: USB hub found
[    8.850000] hub 1-0:1.0: 1 port detected
[    8.880000] nf_conntrack version 0.5.0 (456 buckets, 1824 max)
[    9.110000] xt_time: kernel timezone is -0000
[    9.180000] usb 1-1: new high-speed USB device number 2 using ehci-platform
[    9.330000] hub 1-1:1.0: USB hub found
[    9.330000] hub 1-1:1.0: 4 ports detected
[    9.350000] usbcore: registered new interface driver cdc_acm
[    9.350000] cdc_acm: USB Abstract Control Model driver for USB modems and ISDN adapters
[   13.270000] eth0: link up (100Mbps/Full duplex)
[  309.110000] usb 1-1.1: new high-speed USB device number 3 using ehci-platform
[  359.300000] usb 1-1.1: USB disconnect, device number 3
[ 2309.220000] usb 1-1.1: new high-speed USB device number 4 using ehci-platform
[ 2342.260000] usb 1-1.1: USB disconnect, device number 4
[ 3661.150000] usb 1-1.1: new high-speed USB device number 5 using ehci-platform
[ 3692.400000] usb 1-1.1: USB disconnect, device number 5
[ 3710.300000] usb 1-1.1: new high-speed USB device number 6 using ehci-platform
[ 3860.850000] usb 1-1.1: USB disconnect, device number 6
[ 3879.260000] usb 1-1.1: new high-speed USB device number 7 using ehci-platform
[ 3984.490000] usb 1-1.1: USB disconnect, device number 7</code></pre></div><p>as you wrote, the cam should be supported.</p><p>regards</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348806">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						9 Jan 2017, 01:33					</div>
				</div>
				<div class="post-content content">
					<p>You seem to be using AA12.09, which had some USB issues.<br />There have been big improvements after 12.09 -&gt; try a newer release.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348808">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">tmo26</div>
					<div class="post-datetime">
						9 Jan 2017, 01:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>torkel wrote:</cite><blockquote><p>as you wrote, the cam should be supported.</p></blockquote></div><p>Important: 1300D is supported, but without indication when support was added.</p><p>I have gone through all releases until 2.5.0, but couldn&#039;t find any hint to the 1300D: <a href="https://sourceforge.net/projects/gphoto/files/libgphoto/">https://sourceforge.net/projects/gphoto â€¦ libgphoto/</a></p><p>1300D is modelyear 2016 according to wikipedia.<br />The first libgphoto release in 2016 is 2.5.10</p><p>-&gt; 2.5.0 can not support the 1300D.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p348822">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">torkel</div>
					<div class="post-datetime">
						9 Jan 2017, 08:01					</div>
				</div>
				<div class="post-content content">
					<p>ok, i try to upgrade the openwrt... where can i see with one i need to install, i don&#039;t finde the platform on the list.</p><p>i use the TL-MR3020 V1.9</p><br /><p>regards</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>