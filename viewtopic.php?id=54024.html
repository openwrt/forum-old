<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> B.A.T.M.A.N adv act as an internet gateway through ethernet</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 16 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p254406">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						15 Nov 2014, 04:02					</div>
				</div>
				<div class="post-content content">
					<p>Hello Community,<br />&nbsp; &nbsp; &nbsp;I have a B.A.T.M.A.N node (call it A) that is connected to the internet through eth0. eth0 is running is a DHCP client. I would like my mesh to have internet access through this node. A can ping 8.8.4.4.</p><p>I followed through these instructsions: <a href="http://www.open-mesh.org/projects/batman-adv/wiki/Gateways">http://www.open-mesh.org/projects/batma … i/Gateways</a> so that I have A act as a DHCP server and another node acting as a client (call it B). </p><p>I don&#039;t understand how the node will be able to connect to the internet through A though. </p><p>I tried bridging the eth0 and the bat0 interface with brctl but that does not work (or at least I don&#039;t think it does). </p><p>Currently I have it set up so that I can ssh into A from another node running B.A.T.M.A.N adv. <br />Each node has its own IP on a 10.0.0.0 network.<br />How do I configure the network so that I can access the internet through A?</p><p>Thanks for all the help.</p><p>========================================================================<br />On a side note, I have a Raspberry Pi connected to the BATMAN network through a bridged router. I had to change the Pi&#039;s IP to be on the same network 10.0.0.0 as the rest of the batman nodes. I have another router that is a normal router that is connected to a bridged BATMAN node through ethernet. I am able to ping the PI from a computer that is connected to the normal router through wifi but the Pi cannot ping back. Is there a way to remedy that? Do I have to change the IP of the wifi interface to be on the same network? </p><p>UPDATE:<br />I changed the IP to be on the 10.0.0.0 network but I am not able to telnet or ssh through that address. Does the range of the ip matter for telnetting?</p><p>=========================================================================</p><p>Thanks all.</p>											<p class="post-edited">(Last edited by <strong>chen.jacob92</strong> on 15 Nov 2014, 04:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254451">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						15 Nov 2014, 16:57					</div>
				</div>
				<div class="post-content content">
					<p>On node A, start with a default router configuration, connect wan (ethernet) to Internet, set lan network into bridge mode, build and configure your batman interface and attach it to the lan bridge.&nbsp; </p><p>Basically you are replacing the typical AP mode wifi interface with an instance of batman.&nbsp; You can also run both in the same router, making a conventional AP available to non-mesh enabled clients.&nbsp; All will receive their DHCP addresses from A&#039;s DHCP server, and all will be bridged together.</p><p>On node B, turn off the DHCP server, delete the wan interface, and bridge the ethernet port to the lan so that wired client(s) can get onto the mesh.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 15 Nov 2014, 17:03)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254457">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						15 Nov 2014, 18:54					</div>
				</div>
				<div class="post-content content">
					<p>Hi mk24. <br />Thanks for getting back so soon.<br />So on Node A, do you mean to run these commands:</p><p>brctl addbr mesh-bridge <br />brctl addif mesh-bridge eth0 <br />brctl addif mesh-bridge bat0 <br />ifconfig eth0 up <br />ifconfig bat0 up ifconfig <br />mesh-bridge up</p><p>then do a <br />batctl if add mesh-bridge <br />to add mesh-bridge to the mesh?<br />I would like Node A&#039;s wireless interface to be connected to the BATMAN adv mesh as well so should I also add it through batctl?</p><p>Then should I have A act as a DHCP server and all the other nodes act as a dhcp client?</p><p>Will that automatically give internet access to all the B.A.T.M.A.N nodes? Node B is a B.A.T.M.A.N node and I would like that node and all other such nodes to access the internet.</p>											<p class="post-edited">(Last edited by <strong>chen.jacob92</strong> on 15 Nov 2014, 18:55)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254465">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						15 Nov 2014, 19:53					</div>
				</div>
				<div class="post-content content">
					<p>Bridge node A&#039;s AP and mesh functions onto the LAN using the stock &quot;lan&quot; network configured as bridge mode.&nbsp; Do not create another bridge.</p><p>I know that for 802.11s mesh you just put &quot;option network &#039;lan&#039;&quot; in the /etc/config/wireless section that creates the mesh interface-- but never tried batman.</p><p>The B nodes should probably be configured with unique static IP&#039;s in the same range as A&#039;s LAN (but outside the DHCP range) so that you know what address they have so you can log in to administer them.&nbsp; Make sure to configure gateway and DNS on them so they can access the Internet for NTP and package installation, etc.&nbsp; </p><p>Casual mesh participants (not an official part of your permanent network) like the Raspberry can use DHCP client to get their IP addresses.&nbsp; This DHCP request will pass through the ethernet cable, be bridged onto the mesh, to be granted by node A, which wlll also indicate itself as the gateway to the Internet.&nbsp; As an advanced topic, you can even run a wifi B.A.T.M.A.N directly on a Raspberry with a suitable USB wifi adapter, but it must be the same BATMAN version or they will completely ignore each other.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 15 Nov 2014, 20:04)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254565">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						17 Nov 2014, 00:00					</div>
				</div>
				<div class="post-content content">
					<p>Okay, so:</p><p>1) Bridge A&#039;s wireless with its ethernet<br />2) Start a DHCP server on the wireless interface (Wireless interface is running BATMAN)<br />3) Since each B node has the BATMAN protocol on the wireless, I need to configure the gateway to be A&#039;s IP and the DNS to something like Google&#039;s 8.8.4.4?<br />4) On the Raspberry Pi, I need to set up a DHCP client on the Ethernet port to enter the mesh</p><p>Did I get everything?</p><p>Thanks for all the help mk24 really appreciate it.<br />We did try to use the R PI with a USB wifi adaptor but the versions of the BATMAN did mismatch and we couldn&#039;t get them to talk to each other.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254569">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						17 Nov 2014, 01:13					</div>
				</div>
				<div class="post-content content">
					<p>On point 1, run A as a conventional router and put the batman interface on to the lan.&nbsp; The ethernet is the wan.&nbsp; When you first install an OpenWRT firmware the lan and wan networks that you need and the routing between them are already defined.<br />2. yes, this is already set up as the default router configuration.&nbsp; Basically all you need to do is augment or replace the usual AP (master mode) wifi interface on A&#039;s lan with the BATMAN.<br />3. yes, it should also work to set dns to A&#039;s lan IP (requests will forward thru to the DNS server that A&#039;s wan knows) or your ISP&#039;s DNS server(s).<br />4. yes, this is the default on most Raspberry OS&#039;s.&nbsp; If the router A hardware has lan ethernet ports, confirm that it will connect to the Internet when you plug the Raspberry ethenet cable directly to router A.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 17 Nov 2014, 01:15)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254584">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						17 Nov 2014, 04:14					</div>
				</div>
				<div class="post-content content">
					<p>Great. On point 1 again... Forgive me if I am slow.</p><p>If I need A to communicate with the BATMAN network, I have to have it in adhoc mode still with the bssid and ssid matching those of the BATMAN nodes. It looks like:</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp; &nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp; &nbsp; mesh0<br />&nbsp; &nbsp; &nbsp; option network&nbsp; &nbsp; mesh<br />&nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp; &nbsp; adhoc<br />&nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mesh<br />&nbsp; &nbsp; &nbsp; option bssid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&#039;02:12:34:56:78:9A&#039;<br />&nbsp; &nbsp; &nbsp; option mcast_rate 18000<br />&nbsp; &nbsp; &nbsp; option encryption&nbsp; &nbsp;none</p><p>Then in my network file, I still need to run the batadv protocol for the wireless interface and also bridge it. I also have the bat interface configured, so I have:<br />...<br />config interface &#039;mesh&#039;<br />&nbsp; &nbsp; &nbsp; option mtu&nbsp; 1532<br />&nbsp; &nbsp; &nbsp; option proto&nbsp; batadv<br />&nbsp; &nbsp; &nbsp; option mesh&nbsp; bat0<br />&nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &#039;bridge&#039;</p><p>config interface &#039;bat&#039;<br />&nbsp; &nbsp; &nbsp; option ifname &#039;bat0&#039;<br />&nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp;&#039;static&#039;<br />&nbsp; &nbsp; &nbsp; option mtu&nbsp; &nbsp; &nbsp;&#039;1500&#039;<br />&nbsp; &nbsp; &nbsp; option ipaddr&nbsp; &#039;10.0.0.7&#039;<br />&nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;<br />...</p><p>in my dhcp file I need to make the wireless as a server, so I have:</p><p>config dhcp &#039;mesh&#039;<br />&nbsp; &nbsp; &nbsp; option interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; option start&nbsp; &nbsp; &nbsp; &nbsp;&#039;100&#039;<br />&nbsp; &nbsp; &nbsp; option limit&nbsp; &nbsp; &nbsp; &nbsp; &#039;150&#039;<br />&nbsp; &nbsp; &nbsp; option leasetime&nbsp; &nbsp;&#039;12h&#039;<br />&nbsp; &nbsp; &nbsp; option dhcpv6&nbsp; &nbsp; &nbsp; &nbsp;&#039;server&#039;<br />&nbsp; &nbsp; &nbsp; option ra &#039;server&#039;</p><p>Would the dhcp server automatically run when I reload the network? Or does the wifi interface need to be in an &#039;ap&#039; mode for that to run?</p><p>=====================================================================================<br />UPDATE:<br />So in my wireless file, I was able to create another wifi interface for both the lan and the mesh. The lan is in access point mode and my dhcp file is set up so that it is a server on the lan. This is verified because I can connect my laptop to the router through wifi and browse the internet. I can also telnet into the router and ping the other BATMAN nodes which is what I want. </p><p>However, when I connect the RPI to the mesh as a DHCP client on the eth0 I am not able to connect to the internet. <br />Also, I tried setting the default gw of one of the BATMAN router to 10.0.0.7 (The IP of the BATMAN interface on Node A) by typing: route add default gw 10.0.0.7 netmask 255.255.255.0. When I do netstat -rn, I am able to see that the default gateway is that IP. <br />However, when I try to ping 8.8.4.4 it still says that the network is unreachable. Anything that I am missing on the setup that would explain this? Should I try putting the option type to bridge on my mesh interface as well?</p><p>======================================================================================<br />UPDATE:</p><p>Okay, so I bridged the mesh interface and the network was unreachable and then I bridged the bat interface and the network was still unreachable. What Do?? Did I add the default gateway correctly?</p><p>======================================================================================<br />UPDATE:</p><p>Okay, so I created bridges for lan-eth, bat-eth, and mesh-eth on Node A. When I am on another batman node, I added the default gateway of 10.0.0.7 successfully (The IP of the Node A&#039;s BATMAN interface). Then when I ping for 8.8.4.4 I am able to see that traffic does go to 10.0.0.7&#039;s BATMAN interface by monitoring batctl td bat0. For some reason it isn&#039;t passing the request through to the ethernet. Is it something to do with my bridge? Thanks for all the help. </p><p>Thanks.</p>											<p class="post-edited">(Last edited by <strong>chen.jacob92</strong> on 17 Nov 2014, 07:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254614">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">duongnv_52</div>
					<div class="post-datetime">
						17 Nov 2014, 10:37					</div>
				</div>
				<div class="post-content content">
					<p>Hi Jacob, have u try NAT in your node A?<br /><a href="http://www.revsys.com/writings/quicktips/nat.html">http://www.revsys.com/writings/quicktips/nat.html</a><br />Could you please post your configuration here?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254638">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						17 Nov 2014, 15:39					</div>
				</div>
				<div class="post-content content">
					<p>The &quot;mesh&quot; network is only an internal connection between BATMAN and your mesh radio.&nbsp; &nbsp;kmod-batman takes direct and exclusive control of your mesh0 radio interface and outputs to the bat0 interface it created.&nbsp; The interface between the BATMAN mesh and ordinary IP protocol is always and only through bat0.&nbsp; You don&#039;t need more networks or bridges on A other than the stock &#039;wan&#039; and &#039;lan&#039; (br-lan if in bridge mode which it should be).</p><p>Put &quot;option network &#039;br-lan&#039;&#039; under bat0.&nbsp; Do not assign bat0 its own IP address.&nbsp; It is bridged into the lan and will have that address.&nbsp; Basically bat0 is another physical path to the lan, it is exactly like an AP or the ethernet switch except for different low-level protocol.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 17 Nov 2014, 15:57)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254657">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						17 Nov 2014, 17:43					</div>
				</div>
				<div class="post-content content">
					<p>@duongnv_52: I will try it as soon as I know my configuration for everything is A-OK. Will post my configuration if this effort with mk24 fails for me.</p><p>@mk24: So bat0 will take the IP address of the lan? I see that option &#039;network&#039; is: a Logical network to which the tunnel will be added (bridged). <br />1) Will the BATMAN adv protocol take care of broadcasting that IP address to all the other BATMAN nodes? (All the BATMAN nodes have static IP&#039;s btw. They all have IPs in the range of 10.0.0.0 with a netmask of 255.255.255.0)<br />2) For each B node do I manually add the default gateway to be the IP of the lan of A? </p><p>Thanks very much guys,<br />Jacob</p><p>======================================================================================</p><br /><p>/etc/config/wireless:</p><p>config wifi-device radio0<br />...</p><p>config wifi-iface<br />option device radio0<br />option network lan<br />option mode ap<br />option ssid SUPERMAN<br />option encryption none</p><p>config wifi-iface<br />option device radio0<br />option ifname &#039;mesh0&#039;<br />option network &#039;mesh&#039;<br />option mode &#039;adhoc&#039;<br />option bssid &#039;02:12:34:56:78:9A&#039;<br />option ssid &#039;mesh&#039;<br />option mcast_rate 18000<br />option encryption none</p><p>---------------------------------------------------------------------------------------------------------------------------------------------------</p><p>/etc/config/network</p><p>config interface &#039;loopback&#039;<br />...</p><p>config globals &#039;globals&#039;<br />...</p><p>config interface &#039;lan&#039;<br />option ifname &#039;wlan0&#039; # This doesnt seem to make the interface name of wlan0. It seems to just default to br-lan<br />option force_link 1<br />option type bridge<br />option type static<br />option ipaddr 192.168.1.1<br />option netmask 255.255.255.0</p><p>config interface &#039;mesh&#039;<br />option mtu 1532<br />option proto batadv<br />option mesh bat0</p><p>config interface &#039;bat&#039;<br />option ifname bat0<br />option mtu 1500<br />option network br-lan</p><p>config interface &#039;wan&#039;<br />option ifname eth0<br />option proto dhcp</p><p>---------------------------------------------------------------------------------------------------------------------------------------------------</p><p>root@OpenWrt:/etc/config# ifconfig<br />bat0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 26:49:82:F4:88:63<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::2449:82ff:fef4:8863/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:5113 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:15094 errors:0 dropped:7 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:401586 (392.1 KiB)&nbsp; TX bytes:1442724 (1.3 MiB)</p><p>br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr EA:DE:27:E0:D3:BE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:192.168.1.1&nbsp; Bcast:192.168.1.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::e8de:27ff:fee0:d3be/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:33090 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:71433 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:4534031 (4.3 MiB)&nbsp; TX bytes:25900361 (24.7 MiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr E8:DE:27:E0:D3:BE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:10.221.11.79&nbsp; Bcast:10.221.11.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::eade:27ff:fee0:d3be/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:281044 errors:0 dropped:5817 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:26460 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:50930613 (48.5 MiB)&nbsp; TX bytes:4475136 (4.2 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: ::1/128 Scope:Host<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:65536&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:14 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:14 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1732 (1.6 KiB)&nbsp; TX bytes:1732 (1.6 KiB)</p><p>mesh0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr E8:DE:27:E0:D3:BE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::eade:27ff:fee0:d3be/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:2010216 errors:0 dropped:896 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:405012 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:155838692 (148.6 MiB)&nbsp; TX bytes:38699390 (36.9 MiB)</p><p>wlan0-1&nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr EA:DE:27:E0:D3:BE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::e8de:27ff:fee0:d3be/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:34176 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:47119 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:5147763 (4.9 MiB)&nbsp; TX bytes:24844339 (23.6 MiB)</p>											<p class="post-edited">(Last edited by <strong>chen.jacob92</strong> on 17 Nov 2014, 23:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254721">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						18 Nov 2014, 03:20					</div>
				</div>
				<div class="post-content content">
					<p>1.&nbsp; All interfaces in a bridge inherit the bridge&#039;s IP address.&nbsp; Node A&#039;s DHCP server running on the LAN side will announce that its IP address is the Internet gateway to anyone who asks for it over any br-lan interface (AP or BATMAN mesh).&nbsp; BATMAN-adv is strictly a layer 2 protocol, it knows or cares nothing about IP addresses.&nbsp; It looks only at MAC addresses.&nbsp; (BATMAN is configurable to announce that a node is a &quot;gateway&quot; to enhance layer 2 routing among nodes -- any unknown traffic will be sent with priority to go there in the hopes that it can be resolved.)<br />2.&nbsp; Yes.&nbsp; Also manually configure option dns to be the address of a working DNS server, which can be node A or a public server.</p><p>In /etc/config files the parameter value (third thing on the line) must always be placed in single quotes, e.g. <br />option network &#039;br-lan&#039;<br />Also you have set your lan IP to 192.168.0.1 instead of 10.0.0.1 that you wanted.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 18 Nov 2014, 03:30)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254738">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						18 Nov 2014, 06:07					</div>
				</div>
				<div class="post-content content">
					<p>Okay. So does the LAN IP have to be on the same network as the batman ip&#039;s?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254800">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						18 Nov 2014, 18:34					</div>
				</div>
				<div class="post-content content">
					<p>Yes.&nbsp; The B nodes are part of A&#039;s LAN, connected through bat0.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254806">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">duongnv_52</div>
					<div class="post-datetime">
						18 Nov 2014, 19:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi mk24, I&#039;m trying to set up batman adv on 3 nodes, and one of them connected to ethernet cable, other working as repeater. I&#039;m setup following:<br /><a href="http://www.radiusdesk.com/technical_discussions/batman_vlan_nat#dokuwiki__content">http://www.radiusdesk.com/technical_dis … i__content</a><br />Wifi look good to me, the problem is when i ssh to client node, i can&#039;t ping to google.com or ping to 192.168.1.1(my router ip). I can ping to batman ip of gateway node from client node.<br />Do you know how to fix this problem? Thank you so much.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254858">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						19 Nov 2014, 01:39					</div>
				</div>
				<div class="post-content content">
					<p>Okay. So I changed the bridge ip to 10.0.0.7 and I also put option network &#039;br-lan&#039; under bat0. I am telnetted through that IP so I know that it is changed. Should I be able to then ping 10.0.0.7 from another BATMAN node? <br />I also changed the gateway by doing:<br />route add default gw 10.0.0.7 netmask 0.0.0.0<br />I am not able to ping the 10.0.0.7 ip on node B.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254859">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						19 Nov 2014, 01:51					</div>
				</div>
				<div class="post-content content">
					<p>On B, you want to <br />delete wan network<br />put bat0 into br-lan (same as A)<br />static address br-lan to 10.0.0.X (but not 7)<br />static configure gateway and dns of br-lan set to A&#039;s IP.</p><p>Use batctl on B to confirm that you really have a layer 2 link established to A.</p><p>Remember that when setting MAC addresses manually, A and B must have different MACs.&nbsp; Usually you take the device&#039;s factory MAC (which is automatically assigned to the AP radio interface) and set bit 1 in the first byte to flag it as a locally assigned MAC and use that as the mesh MAC.</p><p>@duongv I need to get some time to read through those instructions but possibly you are on the wrong VLAN.&nbsp; I suggest not using VLANs until you have experience with a non-VLAN&#039;d connection working.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 19 Nov 2014, 01:54)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254860">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						19 Nov 2014, 02:25					</div>
				</div>
				<div class="post-content content">
					<p>Okay, so bridge B&#039;s ethernet and its mesh (Wifi acting in ad-hoc mode) and have option network &#039;br-mesh&#039; under bat0? B does not have a WAN option. I use the ethernet to ssh into B.</p><p>So, lets say I connect a Rasp Pi to B&#039;s ethernet. I need to have the Rasp Pi&#039;s ethernet act as a DHCP client and bridge the ethernet of B with the Mesh interface so that it can go to A&#039;s lan IP of 10.0.0.7 to ask for a IP address. Then I just set the gateway of B to be 10.0.0.7 and its DNS to be 10.0.0.7. B should be able to ping 10.0.0.7 in this setup, correct?</p><p>Thanks mk24.</p>											<p class="post-edited">(Last edited by <strong>chen.jacob92</strong> on 19 Nov 2014, 02:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254862">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						19 Nov 2014, 03:05					</div>
				</div>
				<div class="post-content content">
					<p>You should have the standard br-lan on B.&nbsp; Put both the ethernet and bat0 in there.&nbsp; Make sure that B is not running a DHCP server.&nbsp; You want A to control all the DHCP so that DHCP clients will be properly configured with A as the gateway to the Internet.</p><p>Once everything is bridged together, an ethernet cable plugged into B will be part of A&#039;s LAN as well as B.&nbsp; B generally won&#039;t be doing anything but bridge the ethernet into the BATMAN driver, but you also want access to it&#039;s LAN so you can ssh in.&nbsp; Thus you set B&#039;s lan IP to a static address which is in the same network but not the same address as A.</p>											<p class="post-edited">(Last edited by <strong>mk24</strong> on 19 Nov 2014, 03:10)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254871">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						19 Nov 2014, 04:52					</div>
				</div>
				<div class="post-content content">
					<p>Okay. So, on Node A, I can see the Node B&#039;s MAC Address as well as the other BATMAN nodes&#039; MAC addresses. I can use batctl to ping those MAC addresses. However, I cannot ping using the IP addresses of the bat0 interfaces for the other nodes. Node B is not taking on the IP address of its bridge either. On Node B, I can ping the MAC addresses of the other BATMAN Nodes. I believe that the bat0 is not taking on the static IP address of the br-lan interface. My setup for Node A is:</p><p>/etc/config/wireless:</p><p>config wifi-device&nbsp; radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;mac80211<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode&nbsp; &nbsp;11g<br />&nbsp; &nbsp; &nbsp; &nbsp; option path&nbsp; &nbsp; &nbsp;&#039;platform/ar933x_wmac&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option htmode&nbsp; &nbsp;HT20<br />&nbsp; &nbsp; &nbsp; &nbsp; # REMOVE THIS LINE TO ENABLE WIFI:<br />&nbsp; &nbsp; &nbsp; &nbsp; #option disabled 1</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;SUPERMAN<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption none</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&#039;mesh0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &#039;mesh&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;&#039;adhoc&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option bssid&nbsp; &nbsp; &#039;02:12:34:56:78:9A&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;&#039;mesh&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mcast_rate 18000<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption &#039;none&#039;</p><p>------------------------------------------------------------------------------------------------------------------------------------</p><p>/etc/config/network:</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;wlan0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.0.0.7&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.255.255.0&#039;</p><p>config interface &#039;bat&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&#039;bat0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu&nbsp; &nbsp; &nbsp; &#039;1500&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &#039;br-lan&#039;</p><p>config interface &#039;mesh&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu&nbsp; &nbsp; &nbsp; 1532<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto&nbsp; &nbsp; batadv<br />&nbsp; &nbsp; &nbsp; &nbsp; option mesh&nbsp; &nbsp; &nbsp;bat0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; &#039;br-lan&#039;</p><p> ----------------------------------------------------- ----------------------------------------------------- ------------------------------------</p><p>ifconfig:</p><p>bat0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 6E:B0:E2:9C:DC:10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::6cb0:e2ff:fe9c:dc10/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:8 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:5 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:336 (336.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr EA:DE:27:E0:D3:BE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:10.0.0.7&nbsp; Bcast:10.0.0.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::e8de:27ff:fee0:d3be/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:30069 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:34847 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:2866009 (2.7 MiB)&nbsp; TX bytes:16380433 (15.6 MiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr E8:DE:27:E0:D3:BE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:10.221.11.79&nbsp; Bcast:10.221.11.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::eade:27ff:fee0:d3be/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:46510 errors:0 dropped:810 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:13258 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:16112009 (15.3 MiB)&nbsp; TX bytes:2176532 (2.0 MiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: ::1/128 Scope:Host<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:65536&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:15 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:15 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:1488 (1.4 KiB)&nbsp; TX bytes:1488 (1.4 KiB)</p><p>mesh0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr E8:DE:27:E0:D3:BE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::eade:27ff:fee0:d3be/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1532&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:159630 errors:0 dropped:2 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:41896 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:12242424 (11.6 MiB)&nbsp; TX bytes:4024546 (3.8 MiB)</p><p>wlan0-1&nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr EA:DE:27:E0:D3:BE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::e8de:27ff:fee0:d3be/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:30611 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:36013 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:3447213 (3.2 MiB)&nbsp; TX bytes:17438610 (16.6 MiB)</p><p>==================================================================================</p><p>Node B&#039;s Setup:</p><p>/etc/config/wireless</p><p>config wifi-device&nbsp; radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option type&nbsp; &nbsp; &nbsp;mac80211<br />&nbsp; &nbsp; &nbsp; &nbsp; option channel&nbsp; 1<br />&nbsp; &nbsp; &nbsp; &nbsp; option hwmode&nbsp; &nbsp;11g<br />&nbsp; &nbsp; &nbsp; &nbsp; option path&nbsp; &nbsp; &nbsp;&#039;platform/ar933x_wmac&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option htmode&nbsp; &nbsp;HT20<br />&nbsp; &nbsp; &nbsp; &nbsp; #option disabled &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; #option phy &#039;phy0&#039;</p><br /><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device&nbsp; &nbsp;radio0<br />&nbsp; &nbsp; &nbsp; &nbsp; option network&nbsp; lan<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode&nbsp; &nbsp; &nbsp;ap<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid&nbsp; &nbsp; &nbsp;JOKER<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption none</p><p>config wifi-iface<br />&nbsp; &nbsp; &nbsp; &nbsp; option device &#039;radio0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;mesh0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option encryption &#039;none&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;mesh&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mode &#039;adhoc&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option bssid &#039;02:12:34:56:78:9A&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ssid &#039;mesh&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mcast_rate 18000</p><p>---------------------------------------------------------------------------------------------------------------------------------------------------</p><p>/etc/config/network</p><p>config interface &#039;loopback&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;lo&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;127.0.0.1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask &#039;255.0.0.0&#039;</p><p>config globals &#039;globals&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ula_prefix &#039;fdb7:0874:dca1::/48&#039;</p><p>config interface &#039;lan&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&#039;wlan0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr&nbsp; &nbsp;&#039;10.0.0.69&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask&nbsp; &#039;255.255.255.0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option type &#039;bridge&#039;</p><p>config interface &#039;lan0&#039; # For the ethernet<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname &#039;eth0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option force_link &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto &#039;static&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ipaddr &#039;10.0.0.10&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option netmask&nbsp; &#039;255.255.255.0&#039;</p><p>config interface &#039;mesh&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mesh bat0<br />&nbsp; &nbsp; &nbsp; &nbsp; option proto batadv<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu 1532<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;br-lan&#039;</p><p>config interface &#039;bat&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ifname&nbsp; &nbsp;&#039;bat0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option mtu&nbsp; &nbsp; &nbsp; &#039;1500&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option network &#039;br-lan’</p><p>---------------------------------------------------------------------------------------------------------------------------------------------------</p><p>ifconfig:</p><p>bat0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 52:BB:02:FD:FA:F6<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::50bb:2ff:fefd:faf6/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:1 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:0 errors:0 dropped:4 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:42 (42.0 B)&nbsp; TX bytes:0 (0.0 B)</p><p>br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr EA:DE:27:E0:D4:42<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:10.0.0.69&nbsp; Bcast:10.0.0.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::e8de:27ff:fee0:d442/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:526 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:28 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:47547 (46.4 KiB)&nbsp; TX bytes:2888 (2.8 KiB)</p><p>eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr E8:DE:27:E0:D4:42<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:10.0.0.10&nbsp; Bcast:10.0.0.255&nbsp; Mask:255.255.255.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::eade:27ff:fee0:d442/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:1224 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:568 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:120399 (117.5 KiB)&nbsp; TX bytes:56337 (55.0 KiB)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Interrupt:4</p><p>lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: ::1/128 Scope:Host<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP LOOPBACK RUNNING&nbsp; MTU:65536&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:3450 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:3450 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:247088 (241.2 KiB)&nbsp; TX bytes:247088 (241.2 KiB)</p><p>mesh0&nbsp; &nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr E8:DE:27:E0:D4:42<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::eade:27ff:fee0:d442/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1532&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:8445 errors:0 dropped:5 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:2199 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:646142 (630.9 KiB)&nbsp; TX bytes:207348 (202.4 KiB)</p><p>wlan0-1&nbsp; &nbsp;Link encap:Ethernet&nbsp; HWaddr EA:DE:27:E0:D4:42<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inet6 addr: fe80::e8de:27ff:fee0:d442/64 Scope:Link<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX packets:908 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TX packets:698 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; collisions:0 txqueuelen:1000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RX bytes:98169 (95.8 KiB)&nbsp; TX bytes:103577 (101.1 KiB)</p><p>Node B can see the MAC address of A and I can use bactl to ping that mac address. <br />How come BATMAN doesn&#039;t see the IP&#039;s of the other BATMAN interfaces? On another BATMAN Node with a static BATMAN IP I can ping other nodes with static IP&#039;s. For some reason on Node B and A I can only ping the MAC addresses using batctl.</p><p>======================================================================================<br />UPDATE:<br />Okay, got the bat0 to take the IP address of the bridge. However, on Node A I am not able to grab an IP from the DHCP server. I have it configured to be a DHCP client. I know that it is sending out requests to the DHCP server because I can monitor the requests with batctl td eth0. However, there is a warning coming in that says Warning - packet contains unknown ether type: 0x0027. <br />Thanks</p>											<p class="post-edited">(Last edited by <strong>chen.jacob92</strong> on 20 Nov 2014, 00:49)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254958">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">mk24</div>
					<div class="post-datetime">
						20 Nov 2014, 01:55					</div>
				</div>
				<div class="post-content content">
					<p>In config/network, do not put &#039;br-lan&#039; under mesh.&nbsp; The &quot;mesh&quot; network is just a connection from the mesh radio to the BATMAN kernel module.&nbsp; The connection to outside is bat0.<br />Thus also I think you need to use bat0 not &#039;bat&#039; when you put it into br-lan.&nbsp; Try putting option interface &#039;bat0&#039; under lan and don&#039;t have config interface &#039;bat&#039; section at all.</p><p>Remember in these files, all the option values need to be in single quotes or they are unlikely to take effect.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254959">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						20 Nov 2014, 02:31					</div>
				</div>
				<div class="post-content content">
					<p>Okay. I got it set up correctly. The lan is bridged to the bat0 and the eth0. The gateway is set up correctly on B, I am able to ping the ethernet of A. A&#039;s eth0 is a dhcp client and has an IP from the DHCP server of the external network. However, now eth0 of A does not forward the requests of B to the external network for some reason. Do you think this is an issue with the headers that bat0 is using to forward requests through the network? When I monitor it with batctl, it says:<br />Warning - packet contains unknown ether type: 0x0027</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p254967">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						20 Nov 2014, 04:26					</div>
				</div>
				<div class="post-content content">
					<p>SOLVED!!!! Check out the solution here: <a href="http://chenjacob.com/research-progress/">http://chenjacob.com/research-progress/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255267">
				<div class="post-metadata">
					<div class="post-num">Post #23</div>
					<div class="post-author">duongnv_52</div>
					<div class="post-datetime">
						23 Nov 2014, 11:03					</div>
				</div>
				<div class="post-content content">
					<p>@chen.jacob92: hi Chen, look like u r missing put network config sample link for client node in <br /><a href="http://chenjacob.com/research-progress/">http://chenjacob.com/research-progress/</a><br />Could you please update that link? I&#039;m finding solution for my issue so it will help me a lot.<br />Thank you so much.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255307">
				<div class="post-metadata">
					<div class="post-num">Post #24</div>
					<div class="post-author">chen.jacob92</div>
					<div class="post-datetime">
						23 Nov 2014, 18:28					</div>
				</div>
				<div class="post-content content">
					<p>Oops. yes. I will update it once I get back to the lab.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p335245">
				<div class="post-metadata">
					<div class="post-num">Post #25</div>
					<div class="post-author">sat4all</div>
					<div class="post-datetime">
						20 Aug 2016, 23:59					</div>
				</div>
				<div class="post-content content">
					<p>@chen.jacob92 hi your link with solution not working anymore ?? anychance you to see your solution ??</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>