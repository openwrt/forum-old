<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> [SOLVED] Archer C7 (v2) - Strange IP (169.254.x.x) - No Connection</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 13 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p327577">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">WildByDesign</div>
					<div class="post-datetime">
						8 Jun 2016, 01:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi there,</p><p>I&#039;ve been happily using OpenWrt for about 5-6 years now with several devices, though I do lack fundamental Linux CLI skills.&nbsp; I have been using a few different D-Link devices over the years and more recently a TP-Link WDR4300 all with great success with OpenWrt.</p><p>I finally saved up money for a TP-Link Archer C7 (v2) and bought it today brand new.&nbsp; It had an older firmware from 2014, therefore I was not worried about firmware being blocked.&nbsp; I confirmed that hardware version is 2.</p><p>The TP-Link web interface accepted the OpenWrt firmware (<em>openwrt-15.05.1-ar71xx-generic-archer-c7-v2-squashfs-factory.bin</em>) successfully and restarted without any issues.</p><ul><li><p>From this point, I was not able to access the OpenWrt web interface at 192.168.1.1 or any other potential addresses.&nbsp; I cannot ping 192.168.1.1 or any other familiar addresses either.</p></li></ul><p>From Windows ipconfig /all:</p><div class="codebox"><pre><code>Ethernet adapter Ethernet:

   Connection-specific DNS Suffix  . :
   Description . . . . . . . . . . . : Realtek PCIe GBE Family Controller
   Physical Address. . . . . . . . . : C4-54-44-F1-6A-AD
   DHCP Enabled. . . . . . . . . . . : Yes
   Autoconfiguration Enabled . . . . : Yes
   Autoconfiguration IPv4 Address. . : 169.254.141.53(Preferred)
   Subnet Mask . . . . . . . . . . . : 255.255.0.0
   Default Gateway . . . . . . . . . :
   NetBIOS over Tcpip. . . . . . . . : Disabled</code></pre></div><ul><li><p>As you can see, it is auto-assigning a strange IP that I am not familiar with.&nbsp; I have never experienced this during my past 5-6 years with OpenWrt.&nbsp; So I tried pinging 169.254.141.1, 169.254.1.1, etc., etc. with no success.</p></li></ul><p>I did several searches here at the OpenWrt forum for <em>169.254</em> and found the following similar results:</p><p><a href="https://forum.openwrt.org/viewtopic.php?id=65302">https://forum.openwrt.org/viewtopic.php?id=65302</a><br /><a href="https://forum.openwrt.org/viewtopic.php?id=65270">https://forum.openwrt.org/viewtopic.php?id=65270</a><br /><a href="https://forum.openwrt.org/viewtopic.php?id=65017">https://forum.openwrt.org/viewtopic.php?id=65017</a></p><p>I am familiar with using SCP client WinSCP for managing my OpenWrt routers.&nbsp; However, in this case, I don&#039;t know what IP address to use to access the router now.</p><p>Some of those similar search results suggested that one user may have plugged the ethernet cable into WAN port instead of the LAN ports.&nbsp; But in my case, I&#039;ve been using LAN port 1 throughout flashing, etc.&nbsp; I also tried ruling out a bad LAN port and tried switching to LAN port 2 and rebooting the router, but no success.</p><p>I have tried holding down the Reset button for 10+ seconds to restore factory defaults but no luck.</p><ul><li><p>One of those search results suggests that the user &quot;Missed option network &#039;lan&#039; for ap&quot;&nbsp; and that solved one users issue with these strange <em>169.254.x.x</em> IP addresses.&nbsp; Surely that might even resolve my issue.&nbsp; However, I don&#039;t know how to access the router through SCP right now to make that modification to the network settings.&nbsp; Nor do I know how why this issue would have occurred after flashing OpenWrt as I have done so for 5-6 years now following the same steps.</p></li></ul><p>So I am hoping that somebody can help me to resolve this issue and also let me know what might have caused this problem so that I can avoid it happening again.</p><p>I used bullet points to highlight some of the pertinent information to help narrow it down a bit.</p><p>Thank you for your time.&nbsp; I appreciate any assistance that I can get.</p>											<p class="post-edited">(Last edited by <strong>WildByDesign</strong> on 15 Jun 2016, 17:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327596">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						8 Jun 2016, 04:36					</div>
				</div>
				<div class="post-content content">
					<p>I believe there were some silent revisions to the Archer C7 v2 internals (new flash chip or something) with the newer hardware not supported by 15.05.1 builds. I think some users reported successful flashing of the current DD/trunk version (which has been pretty stable on my Archer, although you&#039;d have to install Luci from the command line once). </p><p>Try using built-in recovery to flash either old TP-Link firmware (which wouldn&#039;t lock your router to TP-link only firmwares) or to flash factory OpenWrt DD/trunk image (and remember, it doesn&#039;t come with Luci). Information on that process should be available on the wiki page. You&#039;d have to set a static IP address on your computer to access router in recovery mode.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327609">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">xxx-wrt</div>
					<div class="post-datetime">
						8 Jun 2016, 07:11					</div>
				</div>
				<div class="post-content content">
					<p>@WildByDesign</p><p>Had this with Win10 on a destop PC with two nics, one also a realtek network card , had to reboot and only after that a regular ip from the router was given but surely you already done that several times.</p>											<p class="post-edited">(Last edited by <strong>xxx-wrt</strong> on 8 Jun 2016, 07:12)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327679">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">PJK</div>
					<div class="post-datetime">
						8 Jun 2016, 19:47					</div>
				</div>
				<div class="post-content content">
					<p>Windows assign 169.* ip when there is no DHCP available. Try different network cable first.</p><p><a href="https://wiki.openwrt.org/toh/tp-link/tl-wdr7500#tftp_recovery_de-bricking">https://wiki.openwrt.org/toh/tp-link/tl … e-bricking</a></p><p>If cable doesn&#039;t help you might have bricked your device, try tftp unbrick method.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327716">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">WildByDesign</div>
					<div class="post-datetime">
						9 Jun 2016, 01:28					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>stangri wrote:</cite><blockquote><p>I believe there were some silent revisions to the Archer C7 v2 internals (new flash chip or something) with the newer hardware not supported by 15.05.1 builds. I think some users reported successful flashing of the current DD/trunk version (which has been pretty stable on my Archer, although you&#039;d have to install Luci from the command line once). </p><p>Try using built-in recovery to flash either old TP-Link firmware (which wouldn&#039;t lock your router to TP-link only firmwares) or to flash factory OpenWrt DD/trunk image (and remember, it doesn&#039;t come with Luci). Information on that process should be available on the wiki page. You&#039;d have to set a static IP address on your computer to access router in recovery mode.</p></blockquote></div><p>Thank you for your response.&nbsp; It appears that you are correct regarding one of the internal chips being slightly different in newer versions of C7 2.0.&nbsp; According to the OpenWrt wiki:</p><p><em>&quot;In late 2015 the V2 changed to flash chip gd25q128, affected serial numbers start with 215C or higher. The chip is supported in trunk as of r47588 and 15.05.1 as of r49220&quot;</em></p><p>So that could be what caused my firmware flashing to end up failing at some stage, I assume.&nbsp; Once I am able to get this resolved, I will use a newer trunk build.</p><p>I wanted to ensure that I&#039;ve done my due diligence with regard to learning more and getting a better technical understanding of OpenWrt in general and spent approximately 2-3 hours last night studying various aspects and learned quite a bit.</p><p>I also spent about an hour last night and another 1-2 hours today trying to get into Failsafe Mode.&nbsp; I have tried all of the tricks with pressing/holding the button for 5 seconds when the one LED flashes during init, pressing the button repeatedly and fast during init as well but no luck getting into failsafe mode as of yet.</p><p>I also have tried capturing network data with TCPdump/WinDump but unfortunately it only picked up some packets with regard to VMware and VirtualBox adapters.&nbsp; Nothing showed up that was mentioned in the de-bricking / TFTP guides here on the OpenWrt wiki.&nbsp; But I will try again later and see what happens.</p><div class="quotebox"><cite>xxx-wrt wrote:</cite><blockquote><p>@WildByDesign</p><p>Had this with Win10 on a destop PC with two nics, one also a realtek network card , had to reboot and only after that a regular ip from the router was given but surely you already done that several times.</p></blockquote></div><p>Thank you.&nbsp; Yes, unfortunately I have rebooted a number of times and also disabled/enabled network adapter various times as well.&nbsp; I appreciate the suggestion and appreciate your time.</p><br /><div class="quotebox"><cite>PJK wrote:</cite><blockquote><p>Windows assign 169.* ip when there is no DHCP available. Try different network cable first.</p><p><a href="https://wiki.openwrt.org/toh/tp-link/tl-wdr7500#tftp_recovery_de-bricking">https://wiki.openwrt.org/toh/tp-link/tl … e-bricking</a></p><p>If cable doesn&#039;t help you might have bricked your device, try tftp unbrick method.</p></blockquote></div><br /><p>Thank you for your reply.&nbsp; I appreciate that as well because I was previously not aware of why a 169.* IP would be assigned.&nbsp; So this gave me some better understanding as well for the fact that my laptop is not receiving an IP from the router&#039;s DHCP server.</p><p>I have spent a few hours during the past day or so trying to get into Failsafe Mode following all of the tricks that deal with pressing the button during early init, but no success as of yet.&nbsp; I am starting to think that I have a brand new paper weight that I&#039;ve been saving money toward for a while now.&nbsp; I&#039;m always cautious with comparing file hashes and things like that, but this has somehow happened to me after all these years.&nbsp; I will continue doing some more research into this later this evening.&nbsp; I appreciate you taking your time to reply.&nbsp; Cheers!</p><p>Also, that was a good suggestion to try a different ethernet cable, made sense.&nbsp; I ended up trying a few cables and also tried different LAN ports.&nbsp; But I just wanted to mention that I am very thankful and appreciative for all of the various suggestions and ideas to try.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327731">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						9 Jun 2016, 05:19					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve only invoked the failsafe mode on my (early version 2) Archer C7 once and I followed instructions on the wiki page (holding reset with the toothpick while plugging in the power) and it worked right away. Don&#039;t forget to set a static IP on your computer.</p><p>If you&#039;ve just bought it you may want to consider returning it or exchanging it for a new one (either with the seller or tp-link directly).</p>											<p class="post-edited">(Last edited by <strong>stangri</strong> on 9 Jun 2016, 05:28)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327777">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">wrt2000</div>
					<div class="post-datetime">
						9 Jun 2016, 11:22					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>stangri wrote:</cite><blockquote><p>If you&#039;ve just bought it you may want to consider returning it or exchanging it for a new one (either with the seller or tp-link directly).</p></blockquote></div><p>: D I did that once recently, when I bricked my C7. I flashed uboot using serial-usb, and instead of typing reboot in putty, I did a power cycle. Told them it stopped working after I hit the reset button, and it was all good.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327792">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						9 Jun 2016, 15:09					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>wrt2000 wrote:</cite><blockquote><p>: D I did that once recently, when I bricked my C7. I flashed uboot using serial-usb, and instead of typing reboot in putty, I did a power cycle. Told them it stopped working after I hit the reset button, and it was all good.</p></blockquote></div><p>Would you accept this deceitful behaviour from your client?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327795">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						9 Jun 2016, 15:21					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><div class="quotebox"><cite>wrt2000 wrote:</cite><blockquote><p>: D I did that once recently, when I bricked my C7. I flashed uboot using serial-usb, and instead of typing reboot in putty, I did a power cycle. Told them it stopped working after I hit the reset button, and it was all good.</p></blockquote></div><p>Would you accept this deceitful behaviour from your client?</p></blockquote></div><p>Max, this &quot;moral judgement&quot; has nothing to do with openwrt, so take your own medicine and move the discussion to some ethics or morality forum... <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327797">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">Max Hopper</div>
					<div class="post-datetime">
						9 Jun 2016, 15:30					</div>
				</div>
				<div class="post-content content">
					<p>&lt;hijack&gt;<br />The question contains no judgement of the author but the amplification of the author&#039;s deed.<br />&lt;/hijack&gt;</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327824">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						9 Jun 2016, 21:00					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><p>&lt;hijack&gt;<br />The question contains no judgement of the author but the amplification of the author&#039;s deed.<br />&lt;/hijack&gt;</p></blockquote></div><p>Max, could you please explain how that question is relevant in a the &quot;General Discussion&quot; forum with the sub heading &quot;Questions/Discussions regarding OpenWrt.&quot; According to your own logic and advice you give others, please take un-related discussions to other forums <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /><br />&nbsp; &nbsp; &nbsp; &nbsp; Sometimes all the nitpicking in the world does not get oneself out of a (self-dug) hole... So put the shovel aside (as &quot;stop digging&quot; is advisable) and realize there are two extremes in the forum behavior continuum. Friendly, forgiving and helpful on the one side and pedantic, nit-picky, hostile and unhelpful on the other end. Fell free to pick your place, but do not complain if after a while you get treated according to the position you took.<br />&nbsp; &nbsp; &nbsp; &nbsp; Personally I would appreciate if you could get over the urge to tell people off and simply only answer to those posts where you have something substantial to add (IIRC those are plenty, unfortunately eclipsed by the barrage of hostile-sounding one-liners, or better one-worders, you seem to shoot off almost constantly).</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327830">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">xxx-wrt</div>
					<div class="post-datetime">
						9 Jun 2016, 22:08					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>Max Hopper wrote:</cite><blockquote><div class="quotebox"><cite>wrt2000 wrote:</cite><blockquote><p>: D I did that once recently, when I bricked my C7. I flashed uboot using serial-usb, and instead of typing reboot in putty, I did a power cycle. Told them it stopped working after I hit the reset button, and it was all good.</p></blockquote></div><p>Would you accept this deceitful behaviour from your client?</p></blockquote></div><p>Perhaps wrt2000 hasn&#039;t it seen from this perspective so perhaps quite helpful for him.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327836">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">dimoni</div>
					<div class="post-datetime">
						9 Jun 2016, 23:11					</div>
				</div>
				<div class="post-content content">
					<p>Where it came impertinent this.<br />take a tour, meet people, keyboard Detach yourself as you are a bit more humble person. Back to the forum.<br />Although the truth for me not to. Having seen.</p><p>PS: By the way does not do much spam in the forum already tired</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327845">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">WildByDesign</div>
					<div class="post-datetime">
						10 Jun 2016, 00:56					</div>
				</div>
				<div class="post-content content">
					<p>I just wanted to take a moment to thank those of you who took time out of your day by replying to my issue and providing various insightful, helpful information that indeed helped raise my overall knowledge of OpenWrt.&nbsp; I appreciate your help and I am thankful for the OpenWrt community.</p><p>I was lucky in this case and ending up getting into Failsafe Mode and re-flashing with one of <strong>arokh</strong>&#039;s recent builds since his builds are from trunk and are a high enough revision number to cover the latest flash chip in the C7 2.0 that had changed around December 2015 according to the wiki.&nbsp; The experience thus far since has been phenomenal and straight forward.</p><p>This is something that users may need to be careful with when buying a new Archer C7 these days.&nbsp; I suppose my biggest issue here is that I was following the C7 wiki details from (<a href="https://wiki.openwrt.org/toh/tp-link/tl-wdr7500">https://wiki.openwrt.org/toh/tp-link/tl-wdr7500</a>) which was always the first search result in Google.&nbsp; But it appears that page is slightly outdated and suggests that users follow this link (<a href="https://wiki.openwrt.org/toh/tp-link/archer-c5-c7-wdr7500">https://wiki.openwrt.org/toh/tp-link/ar … c7-wdr7500</a>) which contains more up-to-date information and follows the new Table of Hardware capabilities.&nbsp; Therefore it is on that second wiki page which contains the following important details that I had missed regarding revision number:</p><p><em>&quot;In late 2015 the V2 changed to flash chip gd25q128, affected serial numbers start with 215C or higher. The chip is supported in trunk as of r47588 and 15.05.1 as of r49220&quot;</em></p><p>Would it be worthwhile for whomever has access to edit the OpenWrt wiki pages to have that initial older wiki page for the C7 automatically redirect to the current C7 wiki page?</p><p>Anyway, this is a mistake of my own and I take full responsibility.&nbsp; I appreciate all of the suggestions that you have all provided me with.&nbsp; To be quite honest, I am thankful that this difficult situation has occurred because it forced me to do many hours worth of research and testing into OpenWrt and my overall knowledge has grown by leaps and bounds over the past 48 hours.</p><p>Cheers!&nbsp; <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p327855">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">stangri</div>
					<div class="post-datetime">
						10 Jun 2016, 03:01					</div>
				</div>
				<div class="post-content content">
					<p>What doesn&#039;t kill your router makes it stronger. <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>