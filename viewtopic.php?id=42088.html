<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> PS3, Pseudobridge (relayd) and uPnP (dlna)</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 31 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p190791">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						3 Feb 2013, 11:45					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;m at my wits end and have been searching for an answer everywhere. Hopefully someone can help me.</p><p>I have a router running openwrt which is bridged to my main network using relayd. I can see devices from either side of the bridge and everything is working.</p><p>I have a media server on the main network and a ps3 on the openwrt side both connected via ethernet to their respective devices.&nbsp; The ps3 cannot see the media server at all without the help of igmpproxy. Using igmpproxy i can see the media server if it starts after igmpproxy starts or after an amount of time (maybe 20 mins?) when the media server must to a discovery or something.</p><p>If I manually try to search for media servers on the ps3 it says no servers found and all the servers that were shown disappear.</p><p>Using tcpdump i see that the ps3 is sending out 3 or 4 udp packets to 239.255.255.250 on port 1900 but they do not get relayed to the main network.</p><p>i&#039;ve tried every setting in igmpproxy, as well as trying udp-broadcast-relay, miniupnpd, snat and dnat but nothing seems to be working.</p><p>miniupnpd might be what i need but the website is not really helpful in explaing what it actually does. picked up the SSDP packets and gave me a wall of text and some chain errors but it didnt do anything either. I&#039;m getting confused between upnp - the media side and upnp - the port forwarding side. i understand the differences but not how people refer to one another.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191551">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						10 Feb 2013, 13:10					</div>
				</div>
				<div class="post-content content">
					<p>bump</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p191872">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						13 Feb 2013, 14:04					</div>
				</div>
				<div class="post-content content">
					<p>bump....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192143">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">hawkeye1103</div>
					<div class="post-datetime">
						16 Feb 2013, 01:09					</div>
				</div>
				<div class="post-content content">
					<p>kinda same problem here... can&#039;t see the server over the network... tried different server clients like serviio, windows media player, plex etc .... none work. Guess the connection doesn&#039;t work because the client is on wifi and the server is wired.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192386">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						18 Feb 2013, 13:31					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hawkeye1103 wrote:</cite><blockquote><p>kinda same problem here... can&#039;t see the server over the network... tried different server clients like serviio, windows media player, plex etc .... none work. Guess the connection doesn&#039;t work because the client is on wifi and the server is wired.</p></blockquote></div><p>I can get them to come up using igmpproxy but they will show up only if they have been started after igmpproxy has started. If you try to manually search for servers, any server found will dissappear.</p><p>I used this as a guide: <a href="https://forum.openwrt.org/viewtopic.php?id=30185&amp;p=2">https://forum.openwrt.org/viewtopic.php … 85&amp;p=2</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192394">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">hawkeye1103</div>
					<div class="post-datetime">
						18 Feb 2013, 14:37					</div>
				</div>
				<div class="post-content content">
					<p>Is this an error that is due to be fixed in the future versions?</p><p>Because I am considering at the moment switching back to the original firmware as it is.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192594">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						20 Feb 2013, 12:03					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>hawkeye1103 wrote:</cite><blockquote><p>Is this an error that is due to be fixed in the future versions?</p><p>Because I am considering at the moment switching back to the original firmware as it is.</p></blockquote></div><p>I&#039;m not sure. That&#039;s why I wrote on the forum. I&#039;m trying to find a work around. I read that if you set up some virtual interfaces it can help but I can&#039;t get it to work yet.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p192702">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						21 Feb 2013, 15:51					</div>
				</div>
				<div class="post-content content">
					<p>heres the link i found about creating the virtual devices:<br /><a href="http://www.dd-wrt.com/phpBB2/viewtopic.php?t=161963">http://www.dd-wrt.com/phpBB2/viewtopic.php?t=161963</a></p><p>I tried this but i couldnt get it to do anything. there were more console messages&nbsp; from igmpproxy though.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193212">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						26 Feb 2013, 11:25					</div>
				</div>
				<div class="post-content content">
					<p>Bump</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193213">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						26 Feb 2013, 11:42					</div>
				</div>
				<div class="post-content content">
					<p>relayd is working fine for me here using the latest source code, i.e. r35770 from trunk.<br />I can access SMB and uPNP service on both side of the network.<br />Took me a while to learn how to configure it properly though..</p><p>I am using a Openwrt router acting as WIFI client to allow computers to connect to this Openwrt router via ethernet.</p><p>A few lessons I learned these few days trying to setup my network here using relayd<br />1) you must create a new interface specifically for relayd, otherwise, it won&#039;t work.<br />2) LAN must be on its own interface<br />3) WIFI (WWAN) must be on its own interface<br />4) don&#039;t bridge the interfaces together because relayd will be doing that for you</p><p>Hope this works for you...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193298">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						27 Feb 2013, 10:46					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>relayd is working fine for me here using the latest source code, i.e. r35770 from trunk.<br />I can access SMB and uPNP service on both side of the network.<br />Took me a while to learn how to configure it properly though..</p></blockquote></div><p>are you using igmpproxy or any other packages other than relayd? and if so how did you set it up?</p><p>I used the luci relayd package so i was able to set up relayd through the web interface but i couldnt get any upnp working until i set up igmpproxy</p>											<p class="post-edited">(Last edited by <strong>omggo</strong> on 27 Feb 2013, 10:53)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193309">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						27 Feb 2013, 13:17					</div>
				</div>
				<div class="post-content content">
					<p>i just tried using relayd with the snapshot version above and it is exactly the same. relayd does not forward multicast traffic so i still cant see my media server even using windows media player from the wireless side.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193319">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						27 Feb 2013, 14:24					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>omggo wrote:</cite><blockquote><div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>relayd is working fine for me here using the latest source code, i.e. r35770 from trunk.<br />I can access SMB and uPNP service on both side of the network.<br />Took me a while to learn how to configure it properly though..</p></blockquote></div><p>are you using igmpproxy or any other packages other than relayd? and if so how did you set it up?</p><p>I used the luci relayd package so i was able to set up relayd through the web interface but i couldnt get any upnp working until i set up igmpproxy</p></blockquote></div><p>Sorry, I thought uPNP is passing through correctly because SMB manage to get through, I can use Windows remote desktop assistance and I can ping devices across the relayd Openwrt router. I didn&#039;t get around to actually use uPNP yet... I tried it just now and it seems like uPNP broadcast is not getting through..</p><p>No, I am not running igmpproxy...<br />Can you do all the three things I mentioned above with your configurations except uPNP?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193320">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						27 Feb 2013, 14:43					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>relayd is working fine for me here using the latest <br />Can you do all the three things I mentioned above with your configurations except uPNP?</p></blockquote></div><p>yes, I can do everything except find uPNP media servers (either by ps3 or windows media player) because it uses multicast and thats where im having trouble.</p>											<p class="post-edited">(Last edited by <strong>omggo</strong> on 27 Feb 2013, 14:44)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193384">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						28 Feb 2013, 03:25					</div>
				</div>
				<div class="post-content content">
					<p>Actually, what is the problem in using igmpproxy?</p><p>I found a thread on this topic and using igmpproxy seems to be the only solution to pass multicast..<br /><a href="https://forum.openwrt.org/viewtopic.php?id=30185">https://forum.openwrt.org/viewtopic.php?id=30185</a></p><p>Btw, do you know howto install luci-app-igmpproxy?<br />opkg install luci-app-igmpproxy<br />doesn&#039;t work..</p><p>And I can&#039;t find it when I compile the ROM from source either...<br />I am compiling from the latest trunk, r35770</p><p>I can see someone have added the patch to add the luci interface for igmpproxy but how do I install or use it?<br /><a href="http://luci.subsignal.org/trac/attachment/ticket/402/igmpproxy.patch">http://luci.subsignal.org/trac/attachme … roxy.patch</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193405">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						28 Feb 2013, 11:18					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>Actually, what is the problem in using igmpproxy?</p><p>I found a thread on this topic and using igmpproxy seems to be the only solution to pass multicast..<br /><a href="https://forum.openwrt.org/viewtopic.php?id=30185">https://forum.openwrt.org/viewtopic.php?id=30185</a></p></blockquote></div><br /><p>if i use igmpproxy. i cant get igmp queries to work properly. so when a device searches for upnp servers it wont show any but then they randomly appear.</p><p>i dont know how to install igmp in luci. i used ssh to configure igmp through uci.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193448">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						28 Feb 2013, 16:00					</div>
				</div>
				<div class="post-content content">
					<p>I&#039;ve had 100% success using arp-nat with gargoyle firmware. it has a speed drop from 8-9MB/s to 6-7MB/s, but that is good enough for what i need. </p><p>atm I&#039;m trying to compile openwrt with the gargoyle arp-nat patch but so far its not working.</p><p>im using this as a guide:<br /><a href="http://projectgus.com/2010/03/wireless-client-bridging-with-openwrt/">http://projectgus.com/2010/03/wireless- … h-openwrt/</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193515">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						1 Mar 2013, 00:51					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>omggo wrote:</cite><blockquote><div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>Actually, what is the problem in using igmpproxy?</p><p>I found a thread on this topic and using igmpproxy seems to be the only solution to pass multicast..<br /><a href="https://forum.openwrt.org/viewtopic.php?id=30185">https://forum.openwrt.org/viewtopic.php?id=30185</a></p></blockquote></div><p>if i use igmpproxy. i cant get igmp queries to work properly. so when a device searches for upnp servers it wont show any but then they randomly appear.</p></blockquote></div><p>Well, igmpproxy is working well for me here though..<br />Make sure you disable your computer&#039;s firewall when testing uPNP.. I spend a long time yesterday trying to figure out why it is not working correctly and in the end, it was my zonealarm firewall causing it.</p><p>I use this config for igmpproxy (/etc/config/igmpproxy)<br /></p><div class="codebox"><pre><code>config igmpproxy
    option quickleave 1

config phyint
    option network wwan
    option direction upstream
    list altnet 192.168.15.0/24

config phyint
    option network wwan
    option direction downstream
    list altnet 192.168.15.0/24
    
config phyint
    option network lan
    option direction downstream
    list altnet 192.168.15.0/24

config phyint
    option network lan
    option direction upstream
    list altnet 192.168.15.0/24</code></pre></div><div class="quotebox"><cite>omggo wrote:</cite><blockquote><p>i dont know how to install igmp in luci. i used ssh to configure igmp through uci.</p></blockquote></div><p>Same here...<br />Post here if you somehow figured out how to use igmp in luci....</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193516">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">ericwongcm</div>
					<div class="post-datetime">
						1 Mar 2013, 00:53					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>omggo wrote:</cite><blockquote><p>I&#039;ve had 100% success using arp-nat with gargoyle firmware. it has a speed drop from 8-9MB/s to 6-7MB/s, but that is good enough for what i need.</p></blockquote></div><p>Disable BWMON on gargoyle would improve your speed to the same as Openwrt.<br />The bandwidth monitoring takes CPU time and thus, the slow down..<br />Also make sure your QoS is off...<br />I guess you don&#039;t need to run QoS nor bandwidth monitoring, right?</p><p>I use gargoyle firmware myself too for bandwidth monitoring and quota management <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p193547">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						1 Mar 2013, 12:25					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>ericwongcm wrote:</cite><blockquote><p>Actually, what is the problem in using igmpproxy?</p><p>I use this config for igmpproxy (/etc/config/igmpproxy)</p></blockquote></div><br /><p>Thanks for the config. i&#039;ve copied it exactly but i still have the same problems. </p><p>the problem is that the media servers don&#039;t come up when you refresh the library list.</p><p>try this:<br />1-turn off router<br />2-start media server on other side of bridge<br />3-start router<br />4-look in windows media player. do you see the media server in the list? i dont.<br />5-restart media server - media server shows up in windows media player list</p><br /><p>ive tried disabling all firewalls but this problem still remains.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p194548">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">omggo</div>
					<div class="post-datetime">
						11 Mar 2013, 13:33					</div>
				</div>
				<div class="post-content content">
					<p>my issue is solved.. the solution was to use openwrt w/ arpnat patches from gargoyle</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>