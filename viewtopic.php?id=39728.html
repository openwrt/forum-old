<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TL-WR2543ND loose configuration and installed packages after restart</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 3 May 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p179728">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">isemionov</div>
					<div class="post-datetime">
						29 Sep 2012, 12:55					</div>
				</div>
				<div class="post-content content">
					<p>Hello! Please help me with very strange situation. I&#039;ve installed on my TP-LINK TL-WR2543ND following firmware <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/openwrt-ar71xx-generic-tl-wr2543-v1-squashfs-factory.bin">http://downloads.openwrt.org/snapshots/ … actory.bin</a>. Then installed LuCI,miniupnp configured network,wifi etc. Everything is OK except the thing if I&#039;m restarting the system then it loose all configuration I did and installed packages and I can connect only trough telnet with default settings (and no wifi enabled, web gui,upnp etc). If I still do several reboots then at some time it finds all configuration I&#039;ve done initially and works OK.<br />What could be the reason for such strange behavior? Can it be fixed ?</p><p>Thanks.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p179731">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">jow</div>
					<div class="post-datetime">
						29 Sep 2012, 13:21					</div>
				</div>
				<div class="post-content content">
					<p>Attach the full kernel log (dmesg) here.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p179740">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">isemionov</div>
					<div class="post-datetime">
						29 Sep 2012, 14:42					</div>
				</div>
				<div class="post-content content">
					<p>Hi Jow, in the mean time I&#039;ve tried several times to revert to stock firmware and then flashing openwrt. Several times it failed with the same issue and only last time I got a stable system. But I will try to repeat it and if I&#039;ll manage to reproduce it then I&#039;ll collect dmesg.<br />By the way when it failed to start correctly I was able to login with telnet and when tried to change root password again it said that file system is read-only.</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p179744">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">isemionov</div>
					<div class="post-datetime">
						29 Sep 2012, 15:35					</div>
				</div>
				<div class="post-content content">
					<p>Hi Jow, I repeated the process 3 times more (revert to stock and back to openwrt) but unfortunately (or fortunately ) the issue wasn&#039;t reproduced again. In case if I&#039;ll get the issue again then I&#039;ll save firstly dmesg output and I&#039;ll post it to this topic.</p><p>Thanks for your time and have a nice weekend.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p180448">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">isemionov</div>
					<div class="post-datetime">
						13 Oct 2012, 17:26					</div>
				</div>
				<div class="post-content content">
					<p>Hello, today when I restarted the router I&#039;ve got the same issue described above.<br />Here is dmesg output for failed boot:<br /></p><div class="codebox"><pre><code> === IMPORTANT ============================
  Use &#039;passwd&#039; to set your login password
  this will disable telnet and enable SSH
 ------------------------------------------


BusyBox v1.19.4 (2012-09-25 18:39:47 PDT) built-in shell (ash)
Enter &#039;help&#039; for a list of built-in commands.

  _______                     ________        __
 |       |.-----.-----.-----.|  |  |  |.----.|  |_
 |   -   ||  _  |  -__|     ||  |  |  ||   _||   _|
 |_______||   __|_____|__|__||________||__|  |____|
          |__| W I R E L E S S   F R E E D O M
 -----------------------------------------------------
 ATTITUDE ADJUSTMENT (Bleeding Edge, r33556)
 -----------------------------------------------------
  * 1/4 oz Vodka      Pour all ingredients into mixing
  * 1/4 oz Gin        tin with ice, strain into glass.
  * 1/4 oz Amaretto
  * 1/4 oz Triple sec
  * 1/4 oz Peach schnapps
  * 1/4 oz Sour mix
  * 1 splash Cranberry juice
 -----------------------------------------------------
root@(none):/# dmesg
[    0.000000] Linux version 3.3.8 (openwrt@snapon) (gcc version 4.6.3 20120201 (prerelease) (Linaro GCC 4.6-2012.02) ) #1 Wed Sep 26 04:42:21 PDT 2012
[    0.000000] MyLoader: sysp=00000000, boardp=00000000, parts=00000000
[    0.000000] bootconsole [early0] enabled
[    0.000000] CPU revision is: 00019374 (MIPS 24Kc)
[    0.000000] SoC: Atheros AR7242 rev 1
[    0.000000] Clocks: CPU:400.000MHz, DDR:400.000MHz, AHB:200.000MHz, Ref:5.000MHz
[    0.000000] Determined physical RAM map:
[    0.000000]  memory: 04000000 @ 00000000 (usable)
[    0.000000] Initrd not found or empty - disabling initrd
[    0.000000] Zone PFN ranges:
[    0.000000]   Normal   0x00000000 -&gt; 0x00004000
[    0.000000] Movable zone start PFN for each node
[    0.000000] Early memory PFN ranges
[    0.000000]     0: 0x00000000 -&gt; 0x00004000
[    0.000000] On node 0 totalpages: 16384
[    0.000000] free_area_init_node: node 0, pgdat 8031b100, node_mem_map 81000000
[    0.000000]   Normal zone: 128 pages used for memmap
[    0.000000]   Normal zone: 0 pages reserved
[    0.000000]   Normal zone: 16256 pages, LIFO batch:3
[    0.000000] pcpu-alloc: s0 r0 d32768 u32768 alloc=1*32768
[    0.000000] pcpu-alloc: [0] 0
[    0.000000] Built 1 zonelists in Zone order, mobility grouping on.  Total pages: 16256
[    0.000000] Kernel command line:  board=TL-WR2543N console=ttyS0,115200 rootfstype=squashfs,jffs2 noinitrd
[    0.000000] PID hash table entries: 256 (order: -2, 1024 bytes)
[    0.000000] Dentry cache hash table entries: 8192 (order: 3, 32768 bytes)
[    0.000000] Inode-cache hash table entries: 4096 (order: 2, 16384 bytes)
[    0.000000] Primary instruction cache 64kB, VIPT, 4-way, linesize 32 bytes.
[    0.000000] Primary data cache 32kB, 4-way, VIPT, cache aliases, linesize 32 bytes
[    0.000000] Writing ErrCtl register=00000000
[    0.000000] Readback ErrCtl register=00000000
[    0.000000] Memory: 61324k/65536k available (2216k kernel code, 4212k reserved, 581k data, 208k init, 0k highmem)
[    0.000000] SLUB: Genslabs=9, HWalign=32, Order=0-3, MinObjects=0, CPUs=1, Nodes=1
[    0.000000] NR_IRQS:51
[    0.000000] Calibrating delay loop... 265.42 BogoMIPS (lpj=1327104)
[    0.080000] pid_max: default: 32768 minimum: 301
[    0.080000] Mount-cache hash table entries: 512
[    0.090000] NET: Registered protocol family 16
[    0.090000] gpiochip_add: registered GPIOs 0 to 17 on device: ath79
[    0.100000] MIPS: machine is TP-LINK TL-WR2543N/ND
[    0.130000] registering PCI controller with io_map_base unset
[    0.340000] bio: create slab &lt;bio-0&gt; at 0
[    0.350000] PCI host bridge to bus 0000:00
[    0.350000] pci_bus 0000:00: root bus resource [mem 0x10000000-0x13ffffff]
[    0.360000] pci_bus 0000:00: root bus resource [io  0x0000]
[    0.360000] pci 0000:00:00.0: [168c:0030] type 0 class 0x000280
[    0.360000] pci 0000:00:00.0: invalid calibration data
[    0.370000] pci 0000:00:00.0: reg 10: [mem 0x00000000-0x0001ffff 64bit]
[    0.370000] pci 0000:00:00.0: reg 30: [mem 0x00000000-0x0000ffff pref]
[    0.370000] pci 0000:00:00.0: supports D1
[    0.370000] pci 0000:00:00.0: PME# supported from D0 D1 D3hot
[    0.370000] pci 0000:00:00.0: BAR 0: assigned [mem 0x10000000-0x1001ffff 64bit]
[    0.370000] pci 0000:00:00.0: BAR 6: assigned [mem 0x10020000-0x1002ffff pref]
[    0.380000] pci 0000:00:00.0: using irq 40 for pin 1
[    0.380000] Switching to clocksource MIPS
[    0.390000] NET: Registered protocol family 2
[    0.390000] IP route cache hash table entries: 1024 (order: 0, 4096 bytes)
[    0.400000] TCP established hash table entries: 2048 (order: 2, 16384 bytes)
[    0.410000] TCP bind hash table entries: 2048 (order: 1, 8192 bytes)
[    0.410000] TCP: Hash tables configured (established 2048 bind 2048)
[    0.420000] TCP reno registered
[    0.420000] UDP hash table entries: 256 (order: 0, 4096 bytes)
[    0.430000] UDP-Lite hash table entries: 256 (order: 0, 4096 bytes)
[    0.440000] NET: Registered protocol family 1
[    0.440000] PCI: CLS 0 bytes, default 32
[    0.460000] squashfs: version 4.0 (2009/01/31) Phillip Lougher
[    0.460000] JFFS2 version 2.2 (NAND) (SUMMARY) (LZMA) (RTIME) (CMODE_PRIORITY) (c) 2001-2006 Red Hat, Inc.
[    0.480000] msgmni has been set to 119
[    0.480000] Block layer SCSI generic (bsg) driver version 0.4 loaded (major 254)
[    0.490000] io scheduler noop registered
[    0.490000] io scheduler deadline registered (default)
[    0.500000] Serial: 8250/16550 driver, 16 ports, IRQ sharing enabled
[    0.530000] serial8250.0: ttyS0 at MMIO 0x18020000 (irq = 11) is a 16550A
[    0.540000] console [ttyS0] enabled, bootconsole disabled
[    0.550000] m25p80 spi0.0: found s25sl064a, expected m25p80
[    0.560000] m25p80 spi0.0: s25sl064a (8192 Kbytes)
[    0.560000] 5 tp-link partitions found on MTD device spi0.0
[    0.570000] Creating 5 MTD partitions on &quot;spi0.0&quot;:
[    0.570000] 0x000000000000-0x000000020000 : &quot;u-boot&quot;
[    0.580000] 0x000000020000-0x00000011d3a4 : &quot;kernel&quot;
[    0.580000] mtd: partition &quot;kernel&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.600000] 0x00000011d3a4-0x0000007f0000 : &quot;rootfs&quot;
[    0.600000] mtd: partition &quot;rootfs&quot; must either start or end on erase block boundary or be smaller than an erase block -- forcing read-only
[    0.620000] mtd: partition &quot;rootfs&quot; set to be root filesystem
[    0.620000] mtd: partition &quot;rootfs_data&quot; created automatically, ofs=2A0000, len=550000
[    0.630000] 0x0000002a0000-0x0000007f0000 : &quot;rootfs_data&quot;
[    0.640000] 0x0000007f0000-0x000000800000 : &quot;art&quot;
[    0.640000] 0x000000020000-0x0000007f0000 : &quot;firmware&quot;
[    0.660000] rtl8367 rtl8367: using GPIO pins 1 (SDA) and 6 (SCK)
[    0.660000] rtl8367 rtl8367: RTL8367R ver. 0 chip found
[    2.570000] rtl8367: probed
[    2.570000] eth0: Atheros AG71xx at 0xb9000000, irq 4
[    3.130000] TCP cubic registered
[    3.130000] NET: Registered protocol family 17
[    3.130000] Bridge firewalling registered
[    3.140000] 8021q: 802.1Q VLAN Support v1.8
[    3.150000] VFS: Mounted root (squashfs filesystem) readonly on device 31:2.
[    3.160000] Freeing unused kernel memory: 208k freed
[    5.150000] eth0: link up (1000Mbps/Full duplex)
[    5.480000] Registered led device: tp-link:green:usb
[    5.480000] Registered led device: tp-link:green:wps</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p180472">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						13 Oct 2012, 22:02					</div>
				</div>
				<div class="post-content content">
					<p>it&#039;s truncated..</p><p>maybe link a txt file uploaded somewhere <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p180556">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">isemionov</div>
					<div class="post-datetime">
						14 Oct 2012, 17:00					</div>
				</div>
				<div class="post-content content">
					<p>it is not truncated, this is what returned dmesg command.<br />but I&#039;ve uploaded the file also:<br /><a href="http://www.filesharing.md/download.php?id=b0ff153a8d2cf3e8dc83a4e6eb694dc9">http://www.filesharing.md/download.php? … e6eb694dc9</a> <br />press &quot;DESCARCA FISIER&quot; button.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p180574">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">MBS</div>
					<div class="post-datetime">
						14 Oct 2012, 20:05					</div>
				</div>
				<div class="post-content content">
					<p>it very much looks like truncated. where is the command prompt after dmesg has finished? or did dmesg hang when issued?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p180578">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">isemionov</div>
					<div class="post-datetime">
						14 Oct 2012, 21:15					</div>
				</div>
				<div class="post-content content">
					<p>I just copy/paste dmesg output from putty terminal window and didn&#039;t selected prompt input</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>