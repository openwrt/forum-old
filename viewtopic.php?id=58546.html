<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> How To Set DNS-O-MATIC DDNS on OpenWRT</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 30 Mar 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p283969">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">willowen100</div>
					<div class="post-datetime">
						18 Jul 2015, 18:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi</p><p>I want to link my DNS-O-MATIC account to my WRT1900AC router but when I select the DDNS provider from the list nothing works when I try get it to connect. I did some research and apparently you have to fill the updater URL manually.</p><p>I&#039;ve tried everything anyone has said on the internet but I&#039;m not getting any luck. </p><p>Many thanks</p><p>Will</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284072">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						19 Jul 2015, 22:00					</div>
				</div>
				<div class="post-content content">
					<p>Hi Will, <br />what version of OpenWrt are you using ?<br />Please post a copy of your /etc/config/ddns (hide password).<br />If using CC 15.05 or trunk enable use_logfile and try to figure out what are the problems.<br />If on BB 14.07 or AA 12.09 please look at <a href="http://wiki.openwrt.org/doc/howto/ddns.client">http://wiki.openwrt.org/doc/howto/ddns.client</a> how to debug.</p><p>!!! all.dnsomatic.com as hostname as described in /usr/lib/ddns/services or on dns-o-matic web pages does not work !!!<br />Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284124">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">ceb12297</div>
					<div class="post-datetime">
						20 Jul 2015, 09:24					</div>
				</div>
				<div class="post-content content">
					<p>Hello All!<br />I&#039;ve had OpenWrt Chaos Calmer 15.05-rc3 / LuCI Master (git-15.167.71950-8005ecb) installed for a few hours now.&nbsp; So far, I&#039;ve figured out a few things, but I had to find a solution to this problem to get where I am.&nbsp; Will, try installing the Curl package because Wget appears to escape out the&#039;@&#039; symbol in the username.&nbsp; Just use this script: https://[USERNAME]:[PASSWORD]@updates.dnsomatic.com/nic/update?myip=[IP]&amp;wildcard=NOCHG&amp;mx=NOCHG&amp;backmx=NOCHG in the CUSTOM option.&nbsp; I can get the router to update the dnsomatic server, but what I can&#039;t seem to do is get the Public IP address to match the Local IP. This means the system will always want to update.&nbsp; Any suggestions?&nbsp; It appears nslookup is pulling my DNS server (openDNS).</p><p>Chad</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284178">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						20 Jul 2015, 18:42					</div>
				</div>
				<div class="post-content content">
					<p>Hi Chad, <br />using wget or curl does not make any difference because USERNAME and PASSWORD are url-encoded otherwise the url&#039;s are not function because 2 @ inside url do not function.<br />If I understand you right you are using custom url settings why not the given service ?<br />Please enable log file because there is written a lot of details for every command that fails<br />or start debugging as described here: <a href="http://wiki.openwrt.org/doc/howto/ddns.client">http://wiki.openwrt.org/doc/howto/ddns.client</a><br />!!! Inside Hostname/Domain must be your FQDN that can be found via nslookup on every DNS server. <br />Christian</p><p>EDIT: I looked on dns-o-matic api description here <a href="http://dnsomatic.com/wiki/api">http://dnsomatic.com/wiki/api</a> and found &quot;Users need to enter a DNS-O-Matic username and password. DNS-O-Matic usernames are 3-25 characters. DNS-O-Matic passwords are 6-20 characters. All ASCII letters and numbers accepted. Dots, dashes, and underscores allowed, but not at the beginning or end of the string.&quot;</p>											<p class="post-edited">(Last edited by <strong>chris5560</strong> on 20 Jul 2015, 19:39)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284411">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">willowen100</div>
					<div class="post-datetime">
						21 Jul 2015, 23:26					</div>
				</div>
				<div class="post-content content">
					<p>Sorry for the late reply lads.</p><p>My version of OpenWRT is:-</p><p>Powered by LuCI Master (git-15.146.54948-a497fba) / OpenWrt Chaos Calmer 15.05-rc2 </p><p>I take it I&#039;ll need to SSH into the router. I&#039;ve only gone to this login screen as I&#039;m new to command based OS/firmwares. I may need some guidance how to gain access to the config file and then extract the information out.</p><p>Many thanks</p><p>Will</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284467">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">ceb12297</div>
					<div class="post-datetime">
						22 Jul 2015, 07:47					</div>
				</div>
				<div class="post-content content">
					<p>Hi Chris,<br />I use a custom string to ignore the domain input.&nbsp; The DNSomatic API said it wasnt necessary.&nbsp; And it was the setting I was working with when it actually started working, as in updating the DNSomatic.&nbsp; As for the wget vs curl...the username (email address) was altered using wget but not curl.&nbsp; For example, myemail@mydomain.com was encoded as myemail%4mydomain.com with wget and correctly with curl and the IGNORE option.&nbsp; Will does your email appear correctly in the log file viewer in DDNS?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284483">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						22 Jul 2015, 11:12					</div>
				</div>
				<div class="post-content content">
					<p>Inside ddns-scripts USERNAME is url encoded before the url is used by wget or curl. so there is no difference.</p><p>The IGNORE for &quot;option cacert&quot; only disable validating server certificates.<br />I checked all OpenWrt version before rewriting wiki <a href="http://wiki.openwrt.org/doc/howto/ddns.client">http://wiki.openwrt.org/doc/howto/ddns.client</a> installation and configuration instructions for SSL support. So IGNORE has nothing to do with USERNAME</p><p>Once again see above, that only &quot;ASCII letters and numbers accepted. Dots, dashes, and underscores allowed, but not at the beginning or end of the string.&quot; by DNS-O-MATIC api. &quot;@&quot; is not a letter or number.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284780">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">ceb12297</div>
					<div class="post-datetime">
						24 Jul 2015, 05:17					</div>
				</div>
				<div class="post-content content">
					<p>OK...I see where the encoding of the url is the same.&nbsp; I still can&#039;t make it work with wget.&nbsp; When I remove curl, it goes back to failing.&nbsp; I only added curl because of the issue I was having from before with not being able to get the DDNS to pull my actual WAN IP.&nbsp; I setup DuckDNS as a seperate DDNS service and tied the dnsomatic updates to DuckDNS which has my actual WAN IP (send by ddns to DuckDNS).</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p284807">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						24 Jul 2015, 11:30					</div>
				</div>
				<div class="post-content content">
					<p>Please offer config and log files so I can look at.<br />If you don&#039;t want to use the forum send them to me as direct mail.<br />I will look at.<br />Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p285267">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">danirod</div>
					<div class="post-datetime">
						28 Jul 2015, 12:57					</div>
				</div>
				<div class="post-content content">
					<p>Hi, I´m also having problems with dnsomatic since updating to CC. The problem seems to be the all.dnsomatic.com domain for updating all domains at once. Is there any workaround?</p><p>Here is my config and log file entries.</p><p>OpenWrt build info:<br /></p><div class="codebox"><pre><code>Chaos Calmer 15.05 r46365  / LuCI devel Branch (git-15.188.37412-218e8f6)</code></pre></div><p>Log for dnsomatic config:<br /></p><div class="codebox"><pre><code>cat /var/log/ddns/myddns_ipv4.log
112247  WARN : Get registered/public IP for &#039;all.dnsomatic.com&#039; failed - retry 1412/0 in 60 seconds
112347       : #&gt; /usr/bin/host -t A all.dnsomatic.com  &gt;/var/run/ddns/myddns_ipv4.dat 2&gt;/var/run/ddns/myddns_ipv4.err
112347 ERROR : BIND host error: &#039;1&#039;</code></pre></div><p>Attempt to get more details:<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /var/run/ddns/myddns_ipv4.err
root@OpenWrt:~# cat /var/run/ddns/myddns_ipv4.dat
Host all.dnsomatic.com not found: 3(NXDOMAIN)</code></pre></div><p>Configuration for dnsomatic<br /></p><div class="codebox"><pre><code>root@OpenWrt:~# cat /etc/config/ddns
config ddns &#039;global&#039;
        option date_format &#039;%F %R&#039;
        option log_lines &#039;250&#039;
        option allow_local_ip &#039;0&#039;

config service &#039;myddns_ipv4&#039;
        option interface &#039;wan&#039;
        option ip_source &#039;network&#039;
        option ip_network &#039;wan&#039;
        option service_name &#039;dnsomatic.com&#039;
        option username &#039;xxxx&#039;
        option use_logfile &#039;1&#039;
        option enabled &#039;1&#039;
        option domain &#039;all.dnsomatic.com&#039;
        option password &#039;xxxx&#039;
        option use_syslog &#039;1&#039;</code></pre></div>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p285277">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						28 Jul 2015, 14:49					</div>
				</div>
				<div class="post-content content">
					<p>&quot;option domain&quot; must be your registered FQDN you want to update. ddns-scripts using this entry to verify updates using nslookup or BIND host command. &quot;all.dnsomatic.com&quot; is not a registered FQDN (NXDOMAIN)<br />ddns-scripts only support ONE host to update in one section or you build your own &quot;option update_url&quot; or since CC your own &quot;option update_script&quot;.<br />Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p297194">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">willowen100</div>
					<div class="post-datetime">
						23 Oct 2015, 21:39					</div>
				</div>
				<div class="post-content content">
					<p>Has anyone managed to get anything working as I&#039;m still having problems?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p297339">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						25 Oct 2015, 08:38					</div>
				</div>
				<div class="post-content content">
					<p>Have you checked <a href="http://wiki.openwrt.org/doc/howto/ddns.client#dnsomaticcom">http://wiki.openwrt.org/doc/howto/ddns. … somaticcom</a><br />Which version are you using? Please provide logs</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301188">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">willowen100</div>
					<div class="post-datetime">
						25 Nov 2015, 16:19					</div>
				</div>
				<div class="post-content content">
					<p>Okay I&#039;ve got the update script working on dnsomatic but only one of my services on the dnsomatic website is working which is No-IP. How do I get my OpenWRT DDNS to update my OpenDNS account too?</p><p>Will</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301190">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						25 Nov 2015, 16:31					</div>
				</div>
				<div class="post-content content">
					<p>Hi Will,<br />from my knowledge you must configure inside DNS-O-MATIC which hosts to update. Or there is still somthing wrong woth your (custom) update-url.<br />Why are you using dns-o-matic to update no-ip ? That can be done directly via ddns-scripts. OK, you need a separate configuration for that.<br />I&#039;m personaly running ddns-scripts with 3 configs. 2 provider and one of them with IPv4 and IPv6.<br />Could you please post your now in parts working configuration.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301201">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">willowen100</div>
					<div class="post-datetime">
						25 Nov 2015, 18:17					</div>
				</div>
				<div class="post-content content">
					<p>okay what&#039;s weird is changing the Hostname/Domain box from my No-IP domain name to &#039;all.dnsomatic.com&#039; seemed to have updated the OpenDNS account on DNS-O-Matic. Here&#039;s my current config working off a single DDNS on OpenWRT working No-IP and OpenDNS off DNS-O-Matic</p><br /><p>config ddns &#039;global&#039;<br />&nbsp; &nbsp; option date_format &#039;%F %R&#039;<br />&nbsp; &nbsp; option log_lines &#039;250&#039;<br />&nbsp; &nbsp; option allow_local_ip &#039;0&#039;</p><p>config service &#039;dnsomatic&#039;<br />&nbsp; &nbsp; option ip_source &#039;network&#039;<br />&nbsp; &nbsp; option interface &#039;wan&#039;<br />&nbsp; &nbsp; option ip_network &#039;wan&#039;<br />&nbsp; &nbsp; option use_syslog &#039;2&#039;<br />&nbsp; &nbsp; option use_logfile &#039;1&#039;<br />&nbsp; &nbsp; option enabled &#039;1&#039;<br />&nbsp; &nbsp; option username &#039;****&#039;<br />&nbsp; &nbsp; option password &#039;****&#039;<br />&nbsp; &nbsp; option update_url &#039;http://[USERNAME]:[PASSWORD]@updates.dnsomatic.com/nic/update?hostname=[DOMAIN]&amp;myip=[IP]&amp;wildcard=NOCHG&amp;mx=NOCHG&amp;backmx=NOCHG&#039;<br />&nbsp; &nbsp; option domain &#039;all.dnsomatic.com&#039;</p><p>UPDATE:<br />There is one bug and that&#039;s the wrong IP address is shown on the overview page, but everything is working as expected.</p>											<p class="post-edited">(Last edited by <strong>willowen100</strong> on 25 Nov 2015, 18:27)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p301410">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						27 Nov 2015, 11:55					</div>
				</div>
				<div class="post-content content">
					<p>Hi Will,</p><p>have you read <a href="http://wiki.openwrt.org/doc/howto/ddns.client#dnsomaticcom">http://wiki.openwrt.org/doc/howto/ddns. … somaticcom</a> ?<br />You use the wrong &quot;update_url&quot; and as &quot;domain&quot; you are still using &quot;all.dnsomatic.com&quot;.<br />Once again, this does not work !!!</p><p>Here the correct settings:<br /></p><div class="codebox"><pre><code>option update_url    &quot;http://[USERNAME]:[PASSWORD]@updates.dnsomatic.com/nic/update?hostname=all.dnsomatic.com&amp;myip=[IP]&amp;wildcard=NOCHG&amp;mx=NOCHG&amp;backmx=NOCHG&quot;
option domain &quot;myhost.example.com&quot;</code></pre></div><p>For &quot;myhost.example.com&quot; set i.e. your hostname defined at no-ip.</p><p>Christian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334126">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">ashfaak</div>
					<div class="post-datetime">
						12 Aug 2016, 00:36					</div>
				</div>
				<div class="post-content content">
					<p>Sorry for bringing and old thread from the dead, but this is what I found when I googled this problem and I found this solution:<br /></p><div class="codebox"><pre><code>option update_url    http://[USERNAME]:[PASSWORD]@updates.dnsomatic.com/nic/update?hostname=&amp;myip=[IP]&amp;wildcard=NOCHG&amp;mx=NOCHG&amp;backmx=NOCHG
option domain &quot;google.com&quot;</code></pre></div><p>And set Check interval to 1 hour.</p><p>Notice that hostname is sent blank. This is equivalent to &#039;all.dnsomatic.com&#039; in that it will update all services registered at DNSomatic but you don&#039;t have to have a FQDN associated with Dnsomatic (if you do then replace &#039;google.com&#039; with your FQDN).</p><p>The problem with domain = all.dnsomatic.com is that the script will kill itself because it can&#039;t resolve the hostname.</p><p>I don&#039;t know if this was resolved in later versions of openwrt. (I&#039;m running 12.09)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p334368">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">chris5560</div>
					<div class="post-datetime">
						13 Aug 2016, 21:17					</div>
				</div>
				<div class="post-content content">
					<p>The problem with your offered update-url:<br />Not documented at dns-o-matic service, so you don&#039;t know if it function tomorrow.<br />Why not using the suggested settings. you are using an custom update url anyway ?</p><p>Since version 2.5.0 available on DD (trunk) ddns-scripts using new &quot;option lookup_host&quot; for nameserver lookup function, so &quot;option domain&quot; is only used as parameter inside &quot;option update_url&quot;.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>