<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> QOS Config: Correct or Suggestions?</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 18 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p252988">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">BzowK</div>
					<div class="post-datetime">
						3 Nov 2014, 20:22					</div>
				</div>
				<div class="post-content content">
					<p>Hey Guys - </p><p>For the past couple of months, I ran Gargoyle simply due to it&#039;s QOS ability which comes installed on the default firmware.&nbsp; After having a few issues with my forwarded ports disappearing, I recently switched back to OpenWrt Barrier Breaker 14.07 which I&#039;m running on a Buffalo WZR-HP-AG300H/WZR-600DHP.</p><p>I do a lot of FTP downloading and I obviously want the files to arrive as soon as possible - but - would like to minimize the effect on other services such as Web Browsing and the occasional HTTP download.&nbsp; My wife uses the web (standard browsing) too and isn&#039;t happy with me when it&#039;s slow.&nbsp; I added &quot;luci-app-qos&quot; and configured it per my connection - a Comcast Cable Modem with ~20mbps down and ~3mbps up with which I can usually download @ 2,300kbps at full speed.&nbsp; &nbsp;</p><br /><p><span class="bbu">Basically, I wanted to post to see if I configured it correctly or if anyone had suggestions.</span>&nbsp; Below is the criteria followed by the rules I set.&nbsp; Please tell me if I got anything wrong or you suggest any changes - including a different package / app / solution for QOS.</p><p><strong>Criteria</strong><br />- General Web Browsing has highest priority<br />- FTP downloads have lowest priority<br />- Web downloads are normal - definitely faster than a concurrent FTP</p><p><em>Note:&nbsp; I only download via FTP from one system with a static IP.&nbsp; It hosts many other things so simply can&#039;t make all of it&#039;s ports low priority.</em></p><p><strong>Current QOS Configuration</strong><br />- Classification Group: default<br />- Calculate Overhead: Enabled<br />- Half-Duplex: Disabled<br />- Download Speed: 20480<br />- Upload Speed: 2048</p><p><strong>Current QOS Rules (In Order)</strong><br /><em>Settings not listed in rules below are set to &quot;All&quot; (Source Host, Destination Host, Service, etc)</em><br />- &quot;Priority&quot;<br />&nbsp; &nbsp;- Ports 22, 53 <br />&nbsp; &nbsp;- Ports 20,25,80,110,443,993,995 / Number of Bytes: 1024<br />- &quot;Express&quot;<br />&nbsp; &nbsp;- Ports 20,25,80,110,443,993,995<br />- &quot;Normal&quot;<br />&nbsp; &nbsp;- Port 21 / Number of bytes: 1024 (For browsing directories in FTP Sites)<br />- &quot;Low&quot;<br />&nbsp; &nbsp;- Port 21 / Destination Host: 192.168.0.200 (Server which downloads via FTP)</p><p>Again, if I configured anything incorrectly or you suggest any changes - even if you know a better solution than this for QOS, please let me know…</p><p>Thanks!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p252999">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						3 Nov 2014, 21:56					</div>
				</div>
				<div class="post-content content">
					<p>Try the new sqm-scripts package from CeroWrt, you can install with opkg. Disable qos-scripts and set your upload/download to 95% in /etc/config/sqm. No classifying should be necessary as fq_codel takes care of prioritizing ACK and small packets by default.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253021">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">BzowK</div>
					<div class="post-datetime">
						4 Nov 2014, 01:01					</div>
				</div>
				<div class="post-content content">
					<p>Thanks for the reply / suggestion...</p><p>So are you suggesting I make the change to CeroWRT and install the package or to just get the package from there as it&#039;s built off (and I assume compatible with) OpenWRT?</p><p>I can honestly say that I haven&#039;t even heard of CeroWrt before, but tried their &quot;bufferbloat test&quot; and failed miserably.&nbsp; I found and&nbsp; grabbed the package sqm-scripts_6-1_all.ipk, but wanted to be clear of your suggestion before proceeding.</p><p>Thanks!</p><p>UPDATE</p><p>Wait a sec... after looking more, perhaps I was wrong thinking it&#039;s a firmware of it&#039;s own.&nbsp; Anyways, I followed your directions and installed sqm-scripts by pasting link to it in LUCI and installing.&nbsp; I take it there&#039;s no LUCI interface for it.&nbsp; I&#039;ll connect SSH and edit the file.&nbsp; </p><p>So - how can I test to make sure it&#039;s working once configured?</p><p>Thanks again!</p>											<p class="post-edited">(Last edited by <strong>BzowK</strong> on 4 Nov 2014, 01:06)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253022">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						4 Nov 2014, 01:06					</div>
				</div>
				<div class="post-content content">
					<p>No just do opkg install sqm-scripts.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253023">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">BzowK</div>
					<div class="post-datetime">
						4 Nov 2014, 01:07					</div>
				</div>
				<div class="post-content content">
					<p>Thanks - Just got through editing last reply.&nbsp; You were too fast.&nbsp; Here&#039;s what I added:</p><p>UPDATE<br />Wait a sec... after looking more, perhaps I was wrong thinking it&#039;s a firmware of it&#039;s own.&nbsp; Anyways, I followed your directions and installed sqm-scripts by pasting link to it in LUCI and installing.&nbsp; I take it there&#039;s no LUCI interface for it.&nbsp; I&#039;ll connect SSH and edit the file. <br />So - how can I test to make sure it&#039;s working once configured?<br />Thanks again!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253024">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">arokh</div>
					<div class="post-datetime">
						4 Nov 2014, 01:09					</div>
				</div>
				<div class="post-content content">
					<p>There is, luci-app-sqm <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253026">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">BzowK</div>
					<div class="post-datetime">
						4 Nov 2014, 01:28					</div>
				</div>
				<div class="post-content content">
					<p>Ha!&nbsp; Makes since.&nbsp; Already have it opened in VI, though.</p><p>Just to make sure, I have just a couple more questions - Thanks for your patience <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>At the end of this reply is the default &quot;sqm&quot; file...</p><p>#1 - Configuring Speed<br />I&#039;m not sure what connection speed is being used.&nbsp; Given my connection I assume I&#039;d change 20000 to 1851 (speedtest.net resulted in 18.43Mbps download for me) and change the upload from 4000 to 347 (speedtest.net upload result was 3.65Mbps)&nbsp; Is that correct?</p><p>#2 - Interface<br />The &quot;interface&quot; listed in the default config file is &quot;ge00.&quot;&nbsp; Mine are &quot;br-lan&quot; (LAN), &quot;eth1&quot; (WAN), and &quot;@wan&quot; (Wireless.)&nbsp; Am I correct to change &quot;ge00&quot; to &quot;eth1&quot; or is &quot;ge00&quot; a virtual adapter it / OpenWRT uses?</p><p>#3 - QOS<br />So this is more of a traffic shaper - not a QOS as there&#039;s nothing more (rules?) to configure?&nbsp; If so, I do not / shouldn&#039;t use any other QOS with it, right?</p><p>#4 - Enable<br />I guess i need to set enabled to &quot;1&quot;, yes?</p><p>#4 - Other<br />Is there anything else in it which I may need to change based off of the changes I already made and/or what traffic control I&#039;m looking for?</p><p><strong>Default &quot;sqm&quot;</strong><br />config queue &#039;ge00&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;ge00&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option download &#039;20000&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option upload &#039;4000&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option qdisc &#039;fq_codel&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option script &#039;simple.qos&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option qdisc_advanced &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ingress_ecn &#039;ECN&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option egress_ecn &#039;NOECN&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option qdisc_really_really_advanced &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option itarget &#039;auto&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option etarget &#039;auto&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option linklayer &#039;none&#039;</p><p>Thanks again!!</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253027">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">BzowK</div>
					<div class="post-datetime">
						4 Nov 2014, 01:32					</div>
				</div>
				<div class="post-content content">
					<p>DUH - Just installed luci-app-sqm_3-1_all.ipk and answered some of my questions.&nbsp; Sorry <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" />&nbsp; More settings than were in config file, though.&nbsp; I set it for eth1 and the rest of the things I mentioned.&nbsp; Still don&#039;t know how to test it well, though...</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253038">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">fgimenez</div>
					<div class="post-datetime">
						4 Nov 2014, 03:33					</div>
				</div>
				<div class="post-content content">
					<p>Can you tell me exactly which packages did you download to make it work on Barrier Breaker 14.07?<br />I tried last week with the packages from Trunk and they failed miserably.<br />I&#039;m cool with qos-scripts but wanted to give sqm-scripts a shot.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253044">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						4 Nov 2014, 05:00					</div>
				</div>
				<div class="post-content content">
					<p>qos-scripts will also use fq_codel and is almost as good as sqm-scripts, but much easier to configure. i think your set up sounds right. Easiest way to test is to start pinging a reliable server close by, then start an ftp download and see if the ping goes way up. After that, try some web browsing with an ftp download going full speed. And finally, try some web downloads with the ftp download running full speed. This will give you an idea of how it will perform in your scenario.</p><p>The only thing I&#039;m not sure about is whether you will get 50/50 bandwidth distribution between your web download and ftp download or if the web download will be prioritized based on the port parameter you entered. Generally, qos-scripts and sqm-scripts aim for keeping latency low and dividing up bandwidth fairly.</p><p>One thing that occasionally trips people up is that they forget to enable and start qos-scripts (or sqm-scripts). This is done in Luci under system-&gt;startup. Set your upload and download to 95% of what your sustained bandwidth is.</p>											<p class="post-edited">(Last edited by <strong>drawz</strong> on 4 Nov 2014, 05:01)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253078">
				<div class="post-metadata">
					<div class="post-num">Post #11</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						4 Nov 2014, 12:22					</div>
				</div>
				<div class="post-content content">
					<p>Hi BzowK,</p><div class="quotebox"><cite>BzowK wrote:</cite><blockquote><p>Hey Guys - </p><p>For the past couple of months, I ran Gargoyle simply due to it&#039;s QOS ability which comes installed on the default firmware.&nbsp; After having a few issues with my forwarded ports disappearing, I recently switched back to OpenWrt Barrier Breaker 14.07 which I&#039;m running on a Buffalo WZR-HP-AG300H/WZR-600DHP.</p><p>I do a lot of FTP downloading and I obviously want the files to arrive as soon as possible - but - would like to minimize the effect on other services such as Web Browsing and the occasional HTTP download.&nbsp; My wife uses the web (standard browsing) too and isn&#039;t happy with me when it&#039;s slow.&nbsp; I added &quot;luci-app-qos&quot; and configured it per my connection - a Comcast Cable Modem with ~20mbps down and ~3mbps up with which I can usually download @ 2,300kbps at full speed.&nbsp; &nbsp;</p><br /><p><span class="bbu">Basically, I wanted to post to see if I configured it correctly or if anyone had suggestions.</span>&nbsp; Below is the criteria followed by the rules I set.&nbsp; Please tell me if I got anything wrong or you suggest any changes - including a different package / app / solution for QOS.</p><p><strong>Criteria</strong><br />- General Web Browsing has highest priority<br />- FTP downloads have lowest priority<br />- Web downloads are normal - definitely faster than a concurrent FTP</p><p><em>Note:&nbsp; I only download via FTP from one system with a static IP.&nbsp; It hosts many other things so simply can&#039;t make all of it&#039;s ports low priority.</em></p><p><strong>Current QOS Configuration</strong><br />- Classification Group: default<br />- Calculate Overhead: Enabled</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; As far as I can tell the overhead calculation in qos-scripts is aimed at ADSL-links (actually ATM, but I digress), it statically tries to adjust for the cost of ATM framing which does not happen on your cable link, so effectively it results in shaping to speeds below what you set... (in other words for internet via cable I would disable the overhead calculation)</p><div class="quotebox"><blockquote><p>- Half-Duplex: Disabled<br />- Download Speed: 20480<br />- Upload Speed: 2048</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Okay, typically it takes a bit to figure out the best shaping speeds, I would recommend to start at 90% of the speed as reported on your invoice (or reported by the cable modem) and then follow the instruction on <a href="http://www.bufferbloat.net/projects/cerowrt/wiki/Quick_Test_for_Bufferbloat">http://www.bufferbloat.net/projects/cer … ufferbloat</a> to see whether you are happy with the resulting latency under load. The best would be to use netperf-wrapper to test the effect of concurrent saturation of up- and downlink on the latency, but in case setting up netperf-wrapper is not an option, netperfrunner.sh should be good enough. It is best ti run these tests for several minutes (say 300seconds or so: netperfrunner.sh -t 300 ) and then look at the 90% and max latency...<br />Then you can slowly either ratted down or up the speeds until you reached the latency under load increase you are willing to live with. I would typically try to use the betterseedstest.sh to estimate the initial speeds by taking 90% of the reported values...</p><div class="quotebox"><blockquote><p><strong>Current QOS Rules (In Order)</strong><br /><em>Settings not listed in rules below are set to &quot;All&quot; (Source Host, Destination Host, Service, etc)</em><br />- &quot;Priority&quot;<br />&nbsp; &nbsp;- Ports 22, 53 <br />&nbsp; &nbsp;- Ports 20,25,80,110,443,993,995 / Number of Bytes: 1024<br />- &quot;Express&quot;<br />&nbsp; &nbsp;- Ports 20,25,80,110,443,993,995<br />- &quot;Normal&quot;<br />&nbsp; &nbsp;- Port 21 / Number of bytes: 1024 (For browsing directories in FTP Sites)<br />- &quot;Low&quot;<br />&nbsp; &nbsp;- Port 21 / Destination Host: 192.168.0.200 (Server which downloads via FTP)</p><p>Again, if I configured anything incorrectly or you suggest any changes - even if you know a better solution than this for QOS, please let me know…</p><p>Thanks!</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I have no experience with qos-scripts subtler setting so can offer no useful opinion/advice...</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253079">
				<div class="post-metadata">
					<div class="post-num">Post #12</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						4 Nov 2014, 12:26					</div>
				</div>
				<div class="post-content content">
					<p>Hi Arokh,<br /></p><div class="quotebox"><cite>arokh wrote:</cite><blockquote><p>Try the new sqm-scripts package from CeroWrt, you can install with opkg. Disable qos-scripts and set your upload/download to 95% in /etc/config/sqm. No classifying should be necessary as fq_codel takes care of prioritizing ACK and small packets by default.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Note that &quot;prioritizing ACKs&quot; while often recommended might not be the best thing to do (rather one should put the ACKs into the same priority band as the data packets of the same tcp connection, delaying ACKs is one way of how ingress shaping works... inside that proper band one again can expedite processing of the ACKs...)<br />&nbsp; &nbsp; &nbsp; fq_codel (in qos-scripts and to sqm-scripts) tends to do the right thing with small packets, including ACKs (even though these might not need the special attention)</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253082">
				<div class="post-metadata">
					<div class="post-num">Post #13</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						4 Nov 2014, 12:32					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>BzowK wrote:</cite><blockquote><p>At the end of this reply is the default &quot;sqm&quot; file...<br />...<br />The &quot;interface&quot; listed in the default config file is &quot;ge00.&quot;&nbsp; Mine are &quot;br-lan&quot; (LAN), &quot;eth1&quot; (WAN), and &quot;@wan&quot; (Wireless.)&nbsp; Am I correct to change &quot;ge00&quot; to &quot;eth1&quot; or is &quot;ge00&quot; a virtual adapter it / OpenWRT uses?</p></blockquote></div><p>That is the default file from Cerowrt, not from the Openwrt repo.<br />When creating the pull request to import sqm into Openwrt, I changed the defaults to be more like the usual Openwrt interface names, so in the Openwrt package the default interface is eth1. (I also hid some of the advanced options so that they are not visible by default.)</p><p>Openwrt defaults are here:<br /><a href="https://github.com/openwrt/packages/blob/master/net/sqm-scripts/files/etc/config/sqm">https://github.com/openwrt/packages/blo … config/sqm</a></p><p>In general, both for sqm and qos, setting just the speeds and interface correctly is the only needed config for the average user.</p><p>It should be ok to use the binary package from Openwrt trunk snapshot downloads in BB14.07. The code is just shell scripts, and both trunk and BB14.07 use 3.10+ kernels, so installing trunk package in BB should be quite possible. (I am compiling and using sqm in my BB14.07 build, so I know sqm works also with BB14.07.)</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253088">
				<div class="post-metadata">
					<div class="post-num">Post #14</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						4 Nov 2014, 12:52					</div>
				</div>
				<div class="post-content content">
					<p>Hi BzowK,<br /></p><div class="quotebox"><cite>BzowK wrote:</cite><blockquote><p>Ha!&nbsp; Makes since.&nbsp; Already have it opened in VI, though.</p><p>Just to make sure, I have just a couple more questions - Thanks for your patience <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p><p>At the end of this reply is the default &quot;sqm&quot; file...</p><p>#1 - Configuring Speed<br />I&#039;m not sure what connection speed is being used.&nbsp; Given my connection I assume I&#039;d change 20000 to 1851 (speedtest.net resulted in 18.43Mbps download for me) and change the upload from 4000 to 347 (speedtest.net upload result was 3.65Mbps)&nbsp; Is that correct?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Please specify the speeds in Kbps (kilo bits per second). Note setting the sped in one direction to 0 will deactivate shaping in that direction, and not set the shaped speed to 0 (as that will not end up in a useable system...)</p><div class="quotebox"><cite>BzowK wrote:</cite><blockquote><p>#2 - Interface<br />The &quot;interface&quot; listed in the default config file is &quot;ge00.&quot;&nbsp; Mine are &quot;br-lan&quot; (LAN), &quot;eth1&quot; (WAN), and &quot;@wan&quot; (Wireless.)&nbsp; Am I correct to change &quot;ge00&quot; to &quot;eth1&quot; or is &quot;ge00&quot; a virtual adapter it / OpenWRT uses?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Typically you want to shape on the wan interface, but SQM allows to shape on any interface (even concurrently) if you so wish...</p><div class="quotebox"><cite>BzowK wrote:</cite><blockquote><p>#3 - QOS<br />So this is more of a traffic shaper - not a QOS as there&#039;s nothing more (rules?) to configure?&nbsp; If so, I do not / shouldn&#039;t use any other QOS with it, right?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; So SQM basically interprets the diffserv/TOS bits in your send packets to steer packets in to 3 bands/tiers, the idea is instead of having the router second guess which priority band to use, you just make sure your applications use the proper markings to begin with, currently we only use a handful of the diffserv code points though (which home needs 6 bits worth of priority classes <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> )</p><div class="quotebox"><cite>BzowK wrote:</cite><blockquote><p>#4 - Enable<br />I guess i need to set enabled to &quot;1&quot;, yes?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Correct.</p><div class="quotebox"><cite>BzowK wrote:</cite><blockquote><p>#4 - Other<br />Is there anything else in it which I may need to change based off of the changes I already made and/or what traffic control I&#039;m looking for?</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I think that should be all...</p><div class="quotebox"><cite>BzowK wrote:</cite><blockquote><p><strong>Default &quot;sqm&quot;</strong><br />config queue &#039;ge00&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option enabled &#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option interface &#039;ge00&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option download &#039;20000&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option upload &#039;4000&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option qdisc &#039;fq_codel&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option script &#039;simple.qos&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option qdisc_advanced &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option ingress_ecn &#039;ECN&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option egress_ecn &#039;NOECN&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option qdisc_really_really_advanced &#039;1&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option itarget &#039;auto&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option etarget &#039;auto&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; option linklayer &#039;none&#039;</p><p>Thanks again!!</p></blockquote></div><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253091">
				<div class="post-metadata">
					<div class="post-num">Post #15</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						4 Nov 2014, 13:04					</div>
				</div>
				<div class="post-content content">
					<p>Hi draws,</p><div class="quotebox"><cite>drawz wrote:</cite><blockquote><p>qos-scripts will also use fq_codel and is almost as good as sqm-scripts, but much easier to configure.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; So currently SQM adjusts fq_codels target parameter for speeds below ~3Mbps which leads to better interactivity, it works better with ipv6 traffic (as in at all <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> ), and it allows to take care of ATM framing and per packet overhead properly. But the QOS guy is much more elaborate and allows much easier tweaking.</p><div class="quotebox"><cite>drawz wrote:</cite><blockquote><p>i think your set up sounds right. Easiest way to test is to start pinging a reliable server close by, then start an ftp download and see if the ping goes way up. After that, try some web browsing with an ftp download going full speed. And finally, try some web downloads with the ftp download running full speed. This will give you an idea of how it will perform in your scenario.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; I would have a look at: <a href="http://www.bufferbloat.net/projects/cerowrt/wiki/Quick_Test_for_Bufferbloat">http://www.bufferbloat.net/projects/cer … ufferbloat</a> the betterspeedtest.sh and the netperfrunner.sh scripts are decent testing tools that should be ruinable on the router&nbsp; itself (if you have no macosx or linux computer in your internal network). They do need a recent netperf packet (and I am not sure whether BB&#039;s netperf is recent enough or not).</p><div class="quotebox"><cite>drawz wrote:</cite><blockquote><p>The only thing I&#039;m not sure about is whether you will get 50/50 bandwidth distribution between your web download and ftp download or if the web download will be prioritized based on the port parameter you entered. Generally, qos-scripts and sqm-scripts aim for keeping latency low and dividing up bandwidth fairly.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; True, fairly here means that each flow will get an equal portion of the bandwidth available to the priority band the glow is in. Due to fq_codel new or sparse flows (often associated with interactive traffic like in web-browsing) will get a slight advantage over &quot;bulk&quot; flows in the same band and hence your wife&#039;s interactive traffic should not suffer (too much) from your FTP traffic.</p><div class="quotebox"><cite>drawz wrote:</cite><blockquote><p>One thing that occasionally trips people up is that they forget to enable and start qos-scripts (or sqm-scripts). This is done in Luci under system-&gt;startup. Set your upload and download to 95% of what your sustained bandwidth is.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Note that occasionally SQM scripts do not start correctly after a reboot (there seems to be a race condition somewhere) then manually ssh&#039;ing into the router and running the following command should fix that:<br />&quot;/etc/init.d/sqm stop ; /etc/init.d.sqm start&quot;<br />You can use &quot;tc -d qdisc&quot; to see how the shaper is set up.</p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p253123">
				<div class="post-metadata">
					<div class="post-num">Post #16</div>
					<div class="post-author">drawz</div>
					<div class="post-datetime">
						4 Nov 2014, 21:59					</div>
				</div>
				<div class="post-content content">
					<p>Thanks Moeller0 - good info. At some point somebody should probably create an openwrt wiki page for sqm-scripts, with instructions on getting it working and configured on openwrt, as well as the pros/cons you mentioned (I think dtaht had a couple others a few months ago). This would go a long way to getting more people to use it. I&#039;ve been pretty happy with qos-scripts, so I haven&#039;t been motivated enough to play with sqm, but it sounds promising and will probably be more and more important as ipv6 traffic becomes more significant.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255114">
				<div class="post-metadata">
					<div class="post-num">Post #17</div>
					<div class="post-author">thdyck</div>
					<div class="post-datetime">
						21 Nov 2014, 16:36					</div>
				</div>
				<div class="post-content content">
					<p>Hi all,</p><p>I&#039;m testing out sqm-scripts on OpenWrt 14.07 and wanted to post what I have found so far. I am using a TP-LINK ar71xx device. I have a PPPoE WAN connection (5.14 Mbps down, 0.62 Mbps up) on interface pppoe-wan with the physical Ethernet interface on eth0.2, as is typical on this device.</p><p>First, thanks to moeller0 and hnyman for their work on these scripts!</p><p>Here are some good links:</p><p>*&nbsp; sqm-scripts for OpenWrt GitHub: <a href="https://github.com/openwrt/packages/tree/master/net/sqm-scripts">https://github.com/openwrt/packages/tre … qm-scripts</a><br />* Cerowrt wiki: &quot;Quick Test for Bufferbloat&quot;, <a href="http://www.bufferbloat.net/projects/cerowrt/wiki/Quick_Test_for_Bufferbloat">http://www.bufferbloat.net/projects/cer … ufferbloat</a><br />* Cerowrt wiki: &quot;Setting up SQM for CeroWrt 3.10&quot;, <a href="http://www.bufferbloat.net/projects/cerowrt/wiki/Setting_up_SQM_for_CeroWrt_310">http://www.bufferbloat.net/projects/cer … eroWrt_310</a><br />* openwrt-devel thread: &quot;Re: [OpenWrt-Devel] [Cerowrt-devel] [RFC PATCH] packages: Smart Queue Management for AQM Packet Scheduling and Qos from CeroWrt&quot;, <a href="https://www.mail-archive.com/openwrt-devel@lists.openwrt.org/msg26806.html">https://www.mail-archive.com/openwrt-de … 26806.html</a><br />* OpenWrt forum thread: &quot;a little patch I made for qos-scripts based on CeroWRT&quot;, <a href="https://forum.openwrt.org/viewtopic.php?id=53450">https://forum.openwrt.org/viewtopic.php?id=53450</a><br />* this thread! OpenWrt forum thread: &quot;QOS Config: Correct or Suggestions?&quot;, <a href="https://forum.openwrt.org/viewtopic.php?id=53785">https://forum.openwrt.org/viewtopic.php?id=53785</a></p><p>* this was helpful too: another similar project: Custom QOS Script for OpenWRT AA built for low latency under load., <a href="https://github.com/zcecc22/qos-nxt">https://github.com/zcecc22/qos-nxt</a></p><p>1. Install from the packages available on trunk:</p><p>cd /tmp<br />wget <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/packages/sqm-scripts_7-3_all.ipk">http://downloads.openwrt.org/snapshots/ … -3_all.ipk</a><br />wget <a href="http://downloads.openwrt.org/snapshots/trunk/ar71xx/packages/packages/luci-app-sqm_3-1_all.ipk">http://downloads.openwrt.org/snapshots/ … -1_all.ipk</a></p><p>opkg install sqm-scripts_7-3_all.ipk</p><p>Installing sqm-scripts (7-3) to root...<br />Installing tc (3.15.0-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/base/tc_3.15.0-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Installing kmod-sched-core (3.10.49-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/base/kmod-sched-core_3.10.49-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Installing kmod-sched (3.10.49-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/base/kmod-sched_3.10.49-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Installing kmod-ifb (3.10.49-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/base/kmod-ifb_3.10.49-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Installing iptables-mod-filter (1.4.21-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/base/iptables-mod-filter_1.4.21-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Installing kmod-ipt-filter (3.10.49-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/base/kmod-ipt-filter_3.10.49-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Installing kmod-lib-textsearch (3.10.49-1) to root...<br />Downloading <a href="http://downloads.openwrt.org/barrier_breaker/14.07/ar71xx/generic/packages/base/kmod-lib-textsearch_3.10.49-1_ar71xx.ipk.">http://downloads.openwrt.org/barrier_br … r71xx.ipk.</a><br />Configuring kmod-lib-textsearch.<br />Configuring kmod-ipt-filter.<br />Configuring kmod-sched-core.<br />Configuring tc.<br />Configuring kmod-sched.<br />Configuring iptables-mod-filter.<br />Configuring kmod-ifb.<br />Configuring sqm-scripts.<br />//usr/lib/opkg/info/sqm-scripts.postinst: line 4: default_postinst: not found<br />Collected errors:<br /> * pkg_run_script: package &quot;sqm-scripts&quot; postinst script returned status 127.<br /> * opkg_configure: sqm-scripts.postinst returned 127.</p><p>TODO: need newer /lib/functions.sh, newer than 14.07. Could sqm-scripts be configured to not call default_postinst on the 14.07 platform? I&#039;m not sure about overall compatibility with 14.07.</p><p>I worked around this by creating sub functions in /lib/functions.sh. A hack but it got me past the install.</p><p>default_prerm() {<br />return 0<br />}</p><p>default_postinst() {<br />return 0<br />}</p><p>opkg install luci-app-sqm_3-1_all.ipk</p><p>this installed OK</p><p>2. Enable and configure</p><p>/etc/init.d/sqm enable</p><p>then follow <a href="http://www.bufferbloat.net/projects/cerowrt/wiki/Setting_up_SQM_for_CeroWrt_310">http://www.bufferbloat.net/projects/cer … eroWrt_310</a></p><p>now in LuCI</p><p>Queues &gt; Basic Settings<br /> Enable: turn this on<br /> Interface name: choose the interface name of the WAN port<br /> Download speed: use 90% x the measured maximum value, 4700 for me<br /> Upload speed: use 90% x the measured maximum value, 550 for me<br />Queues &gt; Queue Discipline<br /> discipline: fq_codel<br /> setup script: simple_pppoe.qos<br />Queues &gt; Link Layer Adaptation<br /> Link layer: ATM<br /> Per Packet Overhead: 44</p><p>I wasn&#039;t sure what interface to use as the WAN interface. I tried eth0.2 initially but didn&#039;t see the queues expected in tc -d qdisc. <br />Changing to use pppoe-wan worked better. The queues were there and the bufferbloat ping test passed.</p><p>I wasn&#039;t sure if the ATM selection and 44 bytes of overhead was still needed when using the pppoe specific setup script.</p><p>When starting, the script has a warning about sch_fq_codel not being found but it is part of the package kmod-sched / kmod-sched-core, so it appears this warning is not significant.</p><p>I had problems with sqm not initializing on bootup; probably a race condition with pppoe-wan coming up. Maybe the script could start using a hotplug event on pppoe-wan going up? I just restarted in manually after each reboot for now.</p><p>3. Check operation</p><p>Ping test to Google passed in that ping times did not substantially increase while running a test from speedtest.net</p><p>status:</p><p># get details<br />tc -d qdisc</p><p># get statistics<br />tc -s qdisc</p><p># see the chain QOS_MARK_... -- packet counts will go up based on matches to specific rules<br />iptables -t mangle --list -v</p><p>4. Selection of traffic to QoS</p><p>I&#039;m primary Interested in QoS my VoIP traffic.</p><p>I see that DiffServ 0x2e is already prioritized by the script.</p><p>DSCP dec 46 or hex 0x2e is class Expedited Forwarding (dedicated to low delay, low loss and low jitter traffic) -- used by Asterisk for IAX2 and SIP voice audio data; this iptable rule shows packets going up when I make a call.</p><p>1654&nbsp; 309K MARK&nbsp; &nbsp; &nbsp; &nbsp;all&nbsp; --&nbsp; any&nbsp; &nbsp; any&nbsp; &nbsp; &nbsp;anywhere&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;anywhere&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DSCP match 0x2e MARK xset 0x1/0xff</p><p>And this queue seems to be where the traffic goes:</p><p>qdisc fq_codel 110: dev pppoe-wan parent 1:11 limit 1001p </p><p>There doesn&#039;t seem to be a way like with qos-scripts to QoS by port number or IP address. But it seems one could write an iptables rule to add DiffServ tags to this traffic, as long as this happened before sqm-scripts saw the traffic.</p><p>For information, does sqm-scripts send outgoing data to the internet out a different virtual interface (e.g. ifb4pppoe-wan) than incoming traffic comes in on? Some scripts do this.</p><p>I can create a wiki page as well.</p><p>Regards,<br />Tim</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255115">
				<div class="post-metadata">
					<div class="post-num">Post #18</div>
					<div class="post-author">hnyman</div>
					<div class="post-datetime">
						21 Nov 2014, 16:48					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>thdyck wrote:</cite><blockquote><p>//usr/lib/opkg/info/sqm-scripts.postinst: line 4: default_postinst: not found<br />Collected errors:<br /> * pkg_run_script: package &quot;sqm-scripts&quot; postinst script returned status 127.<br /> * opkg_configure: sqm-scripts.postinst returned 127.</p><p>TODO: need newer /lib/functions.sh, newer than 14.07. Could sqm-scripts be configured to not call default_postinst on the 14.07 platform? I&#039;m not sure about overall compatibility with 14.07.</p></blockquote></div><p>To me it sounds that the reason for your error is installing a binary package from trunk into a BB system. Apparently the call to the new default_postinst is somehow embedded in that package.</p><p>I include sqm-scripts in my BB14.07 build without problems. But I am compiling it directly into the firmware. (Check the BB builds of my community build, if you want to see how I have added it in to the BB packages feed. <a href="https://forum.openwrt.org/viewtopic.php?id=28392)">https://forum.openwrt.org/viewtopic.php?id=28392)</a></p><p>EDIT: I added a directory with BB14.07 sqm binaries available for download. These are for ar71xx: <a href="https://www.dropbox.com/sh/9p3pcg82drzwjen/AADriRgdp9hyQXVxzXT1qUzba?dl=0">https://www.dropbox.com/sh/9p3pcg82drzw … qUzba?dl=0</a></p>											<p class="post-edited">(Last edited by <strong>hnyman</strong> on 21 Nov 2014, 17:02)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p255207">
				<div class="post-metadata">
					<div class="post-num">Post #19</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						22 Nov 2014, 16:51					</div>
				</div>
				<div class="post-content content">
					<p>Hi Tim,</p><div class="quotebox"><cite>thdyck wrote:</cite><blockquote><p> ...<br />I wasn&#039;t sure what interface to use as the WAN interface. I tried eth0.2 initially but didn&#039;t see the queues expected in tc -d qdisc. <br />Changing to use pppoe-wan worked better. The queues were there and the bufferbloat ping test passed.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; SQM can be configured on multiple interfaces concurrently; yet it does not make too much sense enabling it on multiple (virtual) interfaces and the underlaying physical interface. If eth0.2 is the wan interface than SQM can easily shape while running on that. But if you run PPPoE fro your router than the inbuilt classification will not do the right thing as it does not look through the PPP encapsulation...</p><div class="quotebox"><cite>thdyck wrote:</cite><blockquote><p>I wasn&#039;t sure if the ATM selection and 44 bytes of overhead was still needed when using the pppoe specific setup script.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; If your link runs on an ATM link (as most/all ADSL types do) you really need to select link layer ATM independent of whether you shape the pppoe interface or the physical interface. What this option really does is calculate the correct ATM-wire size of all data packets so they are accounted correctly against the link speed available... The actual overhead depends on the additional encapsulation your ISP forces on to you, 44 seems to be the maximum you will most likely encounter. (Actually if the DSL-modem terminates a clan from your ISP the worts case increases to 48 bytes, but that will be highly unlikely n the real world...)</p><div class="quotebox"><cite>thdyck wrote:</cite><blockquote><p>When starting, the script has a warning about sch_fq_codel not being found but it is part of the package kmod-sched / kmod-sched-core, so it appears this warning is not significant.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; So this is unfortunate but I do not see a way around this; if fq_codel is not built into the kernel but available as a module we need to load that module, otherwise SQM will not work. I might try to defuse this by hiding this benign error message in the future.</p><div class="quotebox"><cite>thdyck wrote:</cite><blockquote><p>I had problems with sqm not initializing on bootup; probably a race condition with pppoe-wan coming up. Maybe the script could start using a hotplug event on pppoe-wan going up? I just restarted in manually after each reboot for now.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; I noticed that as well, not sure about the root cause and hence no real idea of how to fix this. FYI I still run cerowrt which synced last before BB 14.07 fully froze so I can not really test current openwrt behavior...</p><div class="quotebox"><cite>thdyck wrote:</cite><blockquote><p>...<br />There doesn&#039;t seem to be a way like with qos-scripts to QoS by port number or IP address. But it seems one could write an iptables rule to add DiffServ tags to this traffic, as long as this happened before sqm-scripts saw the traffic.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; So SQM basically calls scripts in /usr/lib/sqm that you could just edit to your liking: just copy say /usr/lib/sqm/simple.qos to /usr/lib/sqm/my_simple.qos edit it and it should show up in the script selection box in the GUI (that just displays all files in /usr/lib/sqm ending in .qos). The general idea is the SQM works well enough that for many users no additional tweaking is necessary. (Well besides trying to configure application to properly marl their packets <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" />), the biggest issue still seems to be torrents that somehow end up in the best effort queue instead of the background queue...</p><div class="quotebox"><cite>thdyck wrote:</cite><blockquote><p>For information, does sqm-scripts send outgoing data to the internet out a different virtual interface (e.g. ifb4pppoe-wan) than incoming traffic comes in on? Some scripts do this.</p></blockquote></div><p>&nbsp; &nbsp; &nbsp; &nbsp; Almost <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /> the incoming date is piped through, in your case, ifb4pppoe-wan as linux does only allow qdiscs on egress, ingress needs to be directed through an intermediate functional block device so linux believes this is an egress queue or so...</p><div class="quotebox"><cite>thdyck wrote:</cite><blockquote><p>I can create a wiki page as well.</p><p>Regards,<br />Tim</p></blockquote></div><br /><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; Sebastian</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266287">
				<div class="post-metadata">
					<div class="post-num">Post #20</div>
					<div class="post-author">por</div>
					<div class="post-datetime">
						20 Feb 2015, 17:11					</div>
				</div>
				<div class="post-content content">
					<p>The router has two wan interfaces:<br />IPv4 = eth0.2 (122000/12200 kbps)<br />IPv6 = 6in4-wan (actually sixxs heartbeat proto-41 which is much like 6in4)<br />The IPv6 tunnel runs over the IPv4 wan connection.<br />SQM is wished for IPv4 and IPv6.</p><p>My questions:<br />Must the wan interface for IPv6 be separately configured? <br />If so, what ingress/egress speeds and link layer adaption should be set?</p><p>Regards,<br />Paul</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266322">
				<div class="post-metadata">
					<div class="post-num">Post #21</div>
					<div class="post-author">moeller0</div>
					<div class="post-datetime">
						20 Feb 2015, 21:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>por wrote:</cite><blockquote><p>The router has two wan interfaces:<br />IPv4 = eth0.2 (122000/12200 kbps)<br />IPv6 = 6in4-wan (actually sixxs heartbeat proto-41 which is much like 6in4)<br />The IPv6 tunnel runs over the IPv4 wan connection.<br />SQM is wished for IPv4 and IPv6.</p><p>My questions:<br />Must the wan interface for IPv6 be separately configured? <br />If so, what ingress/egress speeds and link layer adaption should be set?</p><p>Regards,<br />Paul</p></blockquote></div><p>Hi Paul,</p><p>as far as I can tell you need to shape on the underlaying IP4 interface alone (SQM allows shaping on multiple interfaces, but in your case there is one limit affecting both wan and wan6). I think shaping on wan should be sufficient, but better try it out. Worst case is that shaping on eth0 should work...<br />&nbsp; &nbsp; &nbsp; &nbsp; Also note that you might get more responses by opening a new thread instead of attaching to the end of a rather &quot;stale by now&quot; thread <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p266326">
				<div class="post-metadata">
					<div class="post-num">Post #22</div>
					<div class="post-author">por</div>
					<div class="post-datetime">
						20 Feb 2015, 22:56					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>moeller0 wrote:</cite><blockquote><div class="quotebox"><cite>por wrote:</cite><blockquote><p>... SQM for tunnelled IPv6 ...</p></blockquote></div><p>Hi Paul,</p><p>as far as I can tell you need to shape on the underlaying IP4 interface alone (SQM allows shaping on multiple interfaces, but in your case there is one limit affecting both wan and wan6). I think shaping on wan should be sufficient, but better try it out. Worst case is that shaping on eth0 should work...<br />&nbsp; &nbsp; &nbsp; &nbsp; Also note that you might get more responses by opening a new thread instead of attaching to the end of a rather &quot;stale by now&quot; thread <img src="https://forum.openwrt.org/img/smilies/wink.png" width="15" height="15" alt="wink" /></p><p>Best Regards<br />&nbsp; &nbsp; &nbsp; &nbsp; M.</p></blockquote></div><p>Thanks. After some more searching I&#039;ve the impression that the tunnel &quot;inherits&quot; the SQM disciplines, though not for sure.</p><p>p.s.<br />Dear M, judging from the speed with which you reacted, I gather that this thread is not so stale (anymore), so I shall not open a new one for now.</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>