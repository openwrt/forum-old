<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> TP-LINK TL-WR1043ND does not get IP via DHCP</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 23 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p188694">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">novoid</div>
					<div class="post-datetime">
						12 Jan 2013, 19:27					</div>
				</div>
				<div class="post-content content">
					<p>Hi!</p><p>I do have TP-LINK TL-WR1043ND with openwrt-ar71xx-tl-wr1043nd-v1-squashfs-factory.bin and following setup:</p><p>cable modem (DHCPd) &lt;&gt; TP-LINK &lt;&gt; my computers</p><p>The original firmware did work - I checked basic functionality of LAN/WiFi before flashing (in order to check its HW).</p><p>The modem is not picky about MAC - anybody gets an IP.</p><p>I set up the firmware from above and could not get WAN up. I could not even ping my modem (192.168.1.1) :-(<br />I changed the TP-LINK LAn to 192.168.2.* to avoid any collision.<br />udhcpc -i eth0.2 does not get an IP either.</p><p>I also flashed openwrt-ar71xx-generic-tl-wr1043nd-v1-squashfs-factory.bin with no change of the issue. luci is not working/present in that firmware though.</p><p>Manually setting up the WAN interface (with static IP) did not work or resove the issue:<br />&nbsp; : root@rudy:/etc/config# ifconfig eth0.2 192.168.1.88 hw ether 64:70:02:39:20:9D up<br />&nbsp; : root@rudy:/etc/config# ifconfig <br />&nbsp; : br-lan&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 64:70:02:39:20:9C&nbsp; <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;inet addr:192.168.2.1&nbsp; Bcast:192.168.2.255&nbsp; Mask:255.255.255.0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX packets:6275 errors:0 dropped:16 overruns:0 frame:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TX packets:2963 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collisions:0 txqueuelen:0 <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX bytes:458337 (447.5 KiB)&nbsp; TX bytes:355494 (347.1 KiB)<br />&nbsp; : <br />&nbsp; : eth0&nbsp; &nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 64:70:02:39:20:9C&nbsp; <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX packets:6699 errors:0 dropped:3 overruns:59274 frame:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TX packets:2969 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collisions:0 txqueuelen:1000 <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX bytes:684045 (668.0 KiB)&nbsp; TX bytes:370443 (361.7 KiB)<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Interrupt:4 <br />&nbsp; : <br />&nbsp; : eth0.1&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 64:70:02:39:20:9C&nbsp; <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX packets:6275 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TX packets:2963 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collisions:0 txqueuelen:0 <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX bytes:458337 (447.5 KiB)&nbsp; TX bytes:355494 (347.1 KiB)<br />&nbsp; : <br />&nbsp; : eth0.2&nbsp; &nbsp; Link encap:Ethernet&nbsp; HWaddr 64:70:02:39:20:9C&nbsp; <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UP BROADCAST RUNNING MULTICAST&nbsp; MTU:1500&nbsp; Metric:1<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX packets:1 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TX packets:0 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collisions:0 txqueuelen:0 <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX bytes:46 (46.0 B)&nbsp; TX bytes:0 (0.0 B)<br />&nbsp; : <br />&nbsp; : lo&nbsp; &nbsp; &nbsp; &nbsp; Link encap:Local Loopback&nbsp; <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;inet addr:127.0.0.1&nbsp; Mask:255.0.0.0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;UP LOOPBACK RUNNING&nbsp; MTU:16436&nbsp; Metric:1<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX packets:8952 errors:0 dropped:0 overruns:0 frame:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TX packets:8952 errors:0 dropped:0 overruns:0 carrier:0<br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;collisions:0 txqueuelen:0 <br />&nbsp; :&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RX bytes:608400 (594.1 KiB)&nbsp; TX bytes:608400 (594.1 KiB)<br />&nbsp; : <br />&nbsp; : root@rudy:/etc/config#</p><p>I tried the &quot;hw ether ...&quot; trick above because I do think that the WAN interface ought to have tis MAC instead.</p><p>I also tried to connect WAN cable to all LAN ports - no change.</p><p>What can I do?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188696">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						12 Jan 2013, 19:38					</div>
				</div>
				<div class="post-content content">
					<p>what revision are you using??? at least post download link! file name it&#039;s the same for every revision -.-</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188718">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">sockeye</div>
					<div class="post-datetime">
						12 Jan 2013, 23:40					</div>
				</div>
				<div class="post-content content">
					<p>Did you reboot your modem?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188777">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">novoid</div>
					<div class="post-datetime">
						13 Jan 2013, 15:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>what revision are you using??? at least post download link! file name it&#039;s the same for every revision -.-</p></blockquote></div><p>r35089</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188778">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">novoid</div>
					<div class="post-datetime">
						13 Jan 2013, 15:58					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>sockeye wrote:</cite><blockquote><p>Did you reboot your modem?</p></blockquote></div><p>Yes. No change.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188779">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						13 Jan 2013, 16:06					</div>
				</div>
				<div class="post-content content">
					<p>Have you already tried AA rc1?</p><p><a href="http://downloads.openwrt.org/attitude_adjustment/12.09-rc1/ar71xx/generic/openwrt-ar71xx-generic-tl-wr1043nd-v1-squashfs-sysupgrade.bin">http://downloads.openwrt.org/attitude_a … pgrade.bin</a></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188780">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">novoid</div>
					<div class="post-datetime">
						13 Jan 2013, 16:07					</div>
				</div>
				<div class="post-content content">
					<p>Today I spent another four hours trying to get OpenWRT to work.</p><p>When I tried static IP with r35089, I could manage to ping my modem. With manually adding my modem to /etc/resolv.conf I could manage to get DNS to work.</p><p>I manually installed luci.</p><p>I did:<br />opkg update<br />opkg install kmod-ath9k wpad-mini libiwinfo-lua</p><p>Then I could enable WiFi and set up SSID/WPA2PSK and stuff. My Mac and two Android devices were able to connect to WiFi and access the internet without issues. So everything seemed to work.</p><p>While I was assigning fixed IPs to my devices using luci web interface, my WiFi devices lost connection and could not get their IP back. Clients in LAN also lost connection - even my open ssh session died. LEDs on router did not show any unusual pattern. I just was not able to re-connect to my OpenWRT any more. Reboot did not change anything.</p><p>So what now?</p><p>I am this close to learn how to re-flash a TP-LINK with DD-WRT or something else. I never should have replaced the original firmware :-(</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188781">
				<div class="post-metadata">
					<div class="post-num">Post #8</div>
					<div class="post-author">nebbia88</div>
					<div class="post-datetime">
						13 Jan 2013, 16:25					</div>
				</div>
				<div class="post-content content">
					<p>wiki: failsafe mode</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188783">
				<div class="post-metadata">
					<div class="post-num">Post #9</div>
					<div class="post-author">novoid</div>
					<div class="post-datetime">
						13 Jan 2013, 16:34					</div>
				</div>
				<div class="post-content content">
					<div class="quotebox"><cite>nebbia88 wrote:</cite><blockquote><p>wiki: failsafe mode</p></blockquote></div><p>Sorry that I did not mention: I know how to access OpenWRT using failsafe mode and telnet.</p><p>But since I did not break anything, I don&#039;t know what I should do now. Last state before it all went crazy was that everything seemed to work fine. Assigning fixed IPs to know MACs is nothing that I would categorize as a possible fuckup.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p188790">
				<div class="post-metadata">
					<div class="post-num">Post #10</div>
					<div class="post-author">novoid</div>
					<div class="post-datetime">
						13 Jan 2013, 18:01					</div>
				</div>
				<div class="post-content content">
					<p>OK, I found the root of my problem and a fix.</p><p>I did not read about the disabled WAN port on:<br /><a href="http://wiki.openwrt.org/toh/tp-link/tl-wr1043nd#warnings.gotchas">http://wiki.openwrt.org/toh/tp-link/tl- … gs.gotchas</a><br />... and therefore started with the installation chapter without installing the firmware version that fixes the WAN port first.</p><p>OpenWRT does fine so far after I replaced the german WAN port fixing firmware with r35089.</p><p>Thanks for your support here and sorry for the troubles!</p>									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>