<!DOCTYPE html>
<html lang="en-US">
<head>

	<title>OpenWrt Forum Archive</title>

	<meta charset="UTF-8">

	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="assets/css/common.css">

</head>
<body>

<div class="container">

<header class="main-header">
	<h1 class="logo"><a href="index.html"><img src="assets/img/logo.png" width="376" height="88" alt="OpenWrt Forum Archive"></a></h1>
</header>

<aside>
	<p>This is a read-only archive of the old OpenWrt forum. The current OpenWrt forum resides at <a href="https://forum.openwrt.org/">https://forum.openwrt.org/</a>.</p>
	<p class="minor">In May 2018, the OpenWrt forum suffered a total data loss. This archive is an effort to restore and make available as much content as possible. Content may be missing or not representing the latest edited version.</p>
</aside>

<main>
	<header>
		<h1><span class="minor">Topic:</span> OpenWRT on RaspberryPi [Solved]</h1>
	</header>
	<div class="notice minor">
		<p>
			The content of this topic has been archived
							on 22 Apr 2018.
										There are no obvious gaps in this topic, but there may still be some posts missing at the end.
					</p>
	</div>

	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
			
		
		
			<article class="post" id="p206105">
				<div class="post-metadata">
					<div class="post-num">Post #1</div>
					<div class="post-author">keyboardgnome</div>
					<div class="post-datetime">
						1 Jul 2013, 02:27					</div>
				</div>
				<div class="post-content content">
					<p>Howdy all-</p><p>I found a version of the firmware that boots on my pi, which is here: <a href="https://sites.google.com/site/openwrtraspi/">https://sites.google.com/site/openwrtraspi/</a></p><p>Pretty much everything works out of the box, including the packages from the official tree. Everything, of course, but bridging.</p><p>Whenever I execute brctl addbr br0, I get &quot;add bridge failed: Package not installed&quot;. brctl show displays no bridges.</p><p>When I try to use Luci to add a bridge, the mac is always 00-00-00-00-00-00 and the interface never becomes enabled.</p><p>Any thoughts as to what the fix would be?</p><p>Thanks.</p>											<p class="post-edited">(Last edited by <strong>keyboardgnome</strong> on 14 Jul 2013, 19:14)</p>
									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206120">
				<div class="post-metadata">
					<div class="post-num">Post #2</div>
					<div class="post-author">maurer</div>
					<div class="post-datetime">
						1 Jul 2013, 10:19					</div>
				</div>
				<div class="post-content content">
					<p>then manually edit the mac address to something like aa:bb:cc:dd:ee:ff</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206140">
				<div class="post-metadata">
					<div class="post-num">Post #3</div>
					<div class="post-author">keyboardgnome</div>
					<div class="post-datetime">
						1 Jul 2013, 15:09					</div>
				</div>
				<div class="post-content content">
					<p>that doesnt work. sorry, i forgot to mention static assignments dont work. i think that there is something broken with the brutils.</p><p>what packages go into enabling bridging support? i want to make sure theyre all installed. do any packages conflict with bridging support?</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p206544">
				<div class="post-metadata">
					<div class="post-num">Post #4</div>
					<div class="post-author">keyboardgnome</div>
					<div class="post-datetime">
						6 Jul 2013, 06:02					</div>
				</div>
				<div class="post-content content">
					<p>Checked and rechecked.... bridging doesnt work in the rasp pi. If someone knows otherwise, I&#039;m all ears <img src="https://forum.openwrt.org/img/smilies/smile.png" width="15" height="15" alt="smile" /></p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p207084">
				<div class="post-metadata">
					<div class="post-num">Post #5</div>
					<div class="post-author">keyboardgnome</div>
					<div class="post-datetime">
						14 Jul 2013, 05:16					</div>
				</div>
				<div class="post-content content">
					<p>As an update....<br />I&#039;m still stuck here. OpenWRT doesnt want to create any bridges.</p><p>root@OpenWrt:~# brctl show<br />bridge name&nbsp; &nbsp; bridge id&nbsp; &nbsp; &nbsp; &nbsp; STP enabled&nbsp; &nbsp; interfaces<br />root@OpenWrt:~# brctl addbr br0<br />add bridge failed: Package not installed</p><br /><br /><br /><p>Here is the list of the installed packages<br />base-files<br />bridge<br />busybox<br />cfdisk<br />dnsmasq<br />dropbear<br />ebtables<br />fdisk<br />firewall<br />hotplug2<br />i2c-tools<br />iptables<br />iptables-mod-extra<br />iw<br />jshn<br />kernel<br />kmod-bridge<br />kmod-cfg80211<br />kmod-crypto-aes<br />kmod-crypto-arc4<br />kmod-crypto-core<br />kmod-ebtables<br />kmod-eeprom-93cx6<br />kmod-hid<br />kmod-i2c-algo-bit<br />kmod-i2c-core<br />kmod-i2c-gpio<br />kmod-input-core<br />kmod-input-evdev<br />kmod-ipt-conntrack<br />kmod-ipt-core<br />kmod-ipt-extra<br />kmod-ipt-nat<br />kmod-ipt-nathelper<br />kmod-lib-crc-ccitt<br />kmod-lib-crc-itu-t<br />kmod-llc<br />kmod-mac80211<br />kmod-nls-base<br />kmod-ppp<br />kmod-pppoe<br />kmod-pppox<br />kmod-rt2500-usb<br />kmod-rt2800-lib<br />kmod-rt2800-usb<br />kmod-rt2x00-lib<br />kmod-rt2x00-usb<br />kmod-rtl8187<br />kmod-sound-arm-bcm2835<br />kmod-sound-core<br />kmod-spi-bitbang<br />kmod-spi-dev<br />kmod-spi-gpio<br />kmod-stp<br />kmod-tun<br />kmod-usb-core<br />kmod-usb-hid<br />libblkid<br />libblobmsg-json<br />libc<br />libgcc<br />libip4tc<br />libiwinfo<br />libiwinfo-lua<br />libjson<br />liblua<br />liblzo<br />libncurses<br />libnl-tiny<br />libopenssl<br />libubox<br />libubus<br />libubus-lua<br />libuci<br />libuci-lua<br />libuuid<br />libxtables<br />lua<br />luci<br />luci-app-firewall<br />luci-i18n-english<br />luci-lib-core<br />luci-lib-ipkg<br />luci-lib-lmo<br />luci-lib-nixio<br />luci-lib-sys<br />luci-lib-web<br />luci-mod-admin-core<br />luci-mod-admin-full<br />luci-proto-core<br />luci-proto-ppp<br />luci-sgi-cgi<br />luci-theme-base<br />luci-theme-openwrt<br />mtd<br />nano<br />netifd<br />openssl-util<br />openvpn-easy-rsa<br />opkg<br />Package<br />ppp<br />ppp-mod-pppoe<br />terminfo<br />ubus<br />ubusd<br />uci<br />uhttpd<br />Version<br />wireless-tools<br />wpad<br />zlib</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p207124">
				<div class="post-metadata">
					<div class="post-num">Post #6</div>
					<div class="post-author">keyboardgnome</div>
					<div class="post-datetime">
						14 Jul 2013, 18:50					</div>
				</div>
				<div class="post-content content">
					<p>I hooked up the serial cable.... I should have checked dmesg.</p><p>When I try to load the bridge.ko module, I get:</p><p>root@OpenWrt:/lib/modules/3.2.27+/kernel/net/bridge# insmod bridge.ko <br />[&nbsp; 882.427838] bridge: Unknown symbol llc_mac_hdr_init (err 0)<br />[&nbsp; 882.437201] bridge: Unknown symbol stp_proto_register (err 0)<br />[&nbsp; 882.446867] bridge: Unknown symbol stp_proto_unregister (err 0)<br />insmod: can&#039;t insert &#039;bridge.ko&#039;: unknown symbol in module, or unknown parameter<br />root@OpenWrt:/lib/modules/3.2.27+/kernel/net/bridge# </p><br /><p>So, I then also try to force the stp module:</p><p>root@OpenWrt:/lib/modules/3.2.27+/kernel/net/802# insmod stp.ko <br />[&nbsp; 919.108079] stp: Unknown symbol llc_sap_close (err 0)<br />[&nbsp; 919.116731] stp: Unknown symbol llc_sap_open (err 0)<br />insmod: can&#039;t insert &#039;stp.ko&#039;: unknown symbol in module, or unknown parameter</p><br /><p>Previously, IPv6 was a missing dependency, so I installed that. There are obviously other modules missing; I just dont know what they are.</p>									</div>
			</article>

			
		
			
		
		
			<article class="post" id="p207125">
				<div class="post-metadata">
					<div class="post-num">Post #7</div>
					<div class="post-author">keyboardgnome</div>
					<div class="post-datetime">
						14 Jul 2013, 19:13					</div>
				</div>
				<div class="post-content content">
					<p>Solved-</p><p>I found this post: <a href="https://www.os3.nl/2010-2011/students/eleonora_petridou/inr_stp">https://www.os3.nl/2010-2011/students/e … ou/inr_stp</a></p><p>In short, three modules were not installed as dependencies:<br />stp and llc</p><p>insmod /lib/modules/3.2.27+/kernel/net/llc/llc.ko<br />insmod /lib/modules/3.2.27+/kernel/net/802/stp.ko<br />insmod /lib/modules/3.2.27+/kernel/net/bridge/bridge.ko</p><br /><p>[Cut and pasteded the important bits from the website]</p><p>I will run for now the proper brctl using its hard link /sbin/brctl. The first attempt to add a bridge gives back an error.</p><p>add bridge failed: Package not installed</p><p>Cosmin indicated that i need to mount some of the modules from the folder /usr/lib/uml/modules/.</p><p>insmode is not supported by busybox so i need to copy it to the sbin folder of my uml filesystem.</p><p>/ # insmod /usr/lib/uml/modules/2.6.35.1/kernel/net/bridge/bridge.ko<br />bridge: Unknown symbol llc_mac_hdr_init (err 0)<br />bridge: Unknown symbol stp_proto_register (err 0)<br />bridge: Unknown symbol stp_proto_unregister (err 0)<br />insmod: error inserting &#039;/usr/lib/uml/modules/2.6.35.1/kernel/net/bridge/bridge.ko&#039;: -1 Unknown symbol in module</p><p>Now i need to find the missing modules that cause the error.</p><p>epetridou@UbuntuUml:~$ locate stp.ko<br />/lib/modules/2.6.35-22-server/kernel/net/802/stp.ko<br />/lib/modules/2.6.35-22-server/kernel/net/bridge/netfilter/ebt_stp.ko<br />/lib/modules/2.6.35-25-server/kernel/net/802/stp.ko<br />/lib/modules/2.6.35-25-server/kernel/net/bridge/netfilter/ebt_stp.ko<br />/lib/modules/2.6.35-27-server/kernel/net/802/stp.ko<br />/lib/modules/2.6.35-27-server/kernel/net/bridge/netfilter/ebt_stp.ko<br />/usr/lib/uml/modules/2.6.35.1/kernel/net/802/stp.ko<br />/usr/lib/uml/modules/2.6.35.1/kernel/net/bridge/netfilter/ebt_stp.ko</p><p>epetridou@UbuntuUml:~$ locate llc.ko<br />/usr/lib/uml/modules/2.6.35.1/kernel/net/llc/llc.ko</p><p>Since i know their location i need to copy them to my uml filesystem.</p><p>epetridou@UbuntuUml:~$ sudo cp /usr/lib/uml/modules/2.6.35.1/kernel/net/llc/llc.ko /home/epetridou/uml_filesystem/usr/lib/uml/modules/2.6.35.1/kernel/net/llc/<br />epetridou@UbuntuUml:~$ sudo cp /usr/lib/uml/modules/2.6.35.1/kernel/net/802/stp.ko /home/epetridou/uml_filesystem/usr/lib/uml/modules/2.6.35.1/kernel/net/802/<br />epetridou@UbuntuUml:~$ sudo cp /usr/lib/uml/modules/2.6.35.1/kernel/net/bridge/netfilter/ebt_stp.ko /home/epetridou/uml_filesystem/usr/lib/uml/modules/2.6.35.1/kernel/net/bridge/netfilter/</p><p>I try to load the modules one more time.</p><p>/ # insmod /usr/lib/uml/modules/2.6.35.1/kernel/net/802/stp.ko<br />stp: Unknown symbol llc_sap_close (err 0)<br />stp: Unknown symbol llc_sap_open (err 0)</p><p>I guess I need to load the llc module first.</p><p>insmod: error inserting &#039;/usr/lib/uml/modules/2.6.35.1/kernel/net/802/stp.ko&#039;: -1 Unknown symbol in module<br />/ # insmod /usr/lib/uml/modules/2.6.35.1/kernel/net/llc/llc.ko<br />/ # insmod /usr/lib/uml/modules/2.6.35.1/kernel/net/802/stp.ko<br />/ # insmod /usr/lib/uml/modules/2.6.35.1/kernel/net/bridge/bridge.ko<br />Bridge firewalling registered</p><p>Testing if it works…</p><p>/ # /sbin/brctl addbr tmp_br<br />/ # /sbin/brctl show<br />bridge name&nbsp; &nbsp; &nbsp;bridge id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STP enabled&nbsp; &nbsp; &nbsp;interfaces<br />tmp_br&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 8000.000000000000&nbsp; &nbsp; &nbsp; &nbsp;no</p>											<p class="post-edited">(Last edited by <strong>keyboardgnome</strong> on 14 Jul 2013, 19:17)</p>
									</div>
			</article>

			
		
	
			<div class="notice minor">
			<p>The discussion might have continued from here.</p>
		</div>
	
	<div class="pagination"><div class="pagination-number">Page 1 of 1</div><nav><ul><li class="pagination-current"><span>1</span></li></ul></nav></div>
</main>

</div>


<!-- Created in a hurry and not indicative of usual code quality. Here's a number: 0 -->

</body>
</html>